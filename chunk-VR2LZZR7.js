import{d as X,h as Y,i as k,k as d,n as E,q as Z,z as tt}from"./chunk-OIFSN6AI.js";import{Ba as y,Ca as C,Fa as K,G as J,_ as Q,aa as W,fa as G}from"./chunk-NKUATUXO.js";import{A as j,Cc as H,Ia as m,Ic as P,Lb as D,Lc as M,Ma as l,Mb as F,Pa as b,Qa as g,T as L,Ua as B,V as c,bb as S,ca as $,cb as a,da as h,db as n,e as f,ia as w,ib as z,ic as R,ja as N,lb as I,mb as T,o as s,pc as U,q as p,qc as q,wa as V,xb as u,zb as O}from"./chunk-ZL7LBTKX.js";import"./chunk-2HP4JIPC.js";function at(i,t){if(i&1){let x=z();a(0,"button",2),I("click",function(){w(x);let o=T();return N(o.login())}),u(1,"Sign In with Azure"),n()}}function ut(i,t){if(i&1){let x=z();a(0,"button",3),I("click",function(){w(x);let o=T();return N(o.logout())}),u(1,"Sign Out"),n()}}var et=(()=>{let t=class t{constructor(e){this.authService=e,this.destroy$=new f,this.authService.onTokenChange().pipe(c(this.destroy$)).subscribe(o=>{this.token=null,o&&o.isValid()&&(this.token=o)})}login(){this.authService.authenticate("azure").pipe(c(this.destroy$)).subscribe(e=>{})}logout(){this.authService.logout("azure").pipe(c(this.destroy$)).subscribe(e=>{})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};t.\u0275fac=function(o){return new(o||t)(l(k))},t.\u0275cmp=b({type:t,selectors:[["nb-playground-azure"]],standalone:!1,decls:11,vars:6,consts:[["nbButton","","status","success",3,"click",4,"ngIf"],["nbButton","","status","warning",3,"click",4,"ngIf"],["nbButton","","status","success",3,"click"],["nbButton","","status","warning",3,"click"]],template:function(o,r){o&1&&(a(0,"nb-layout")(1,"nb-layout-column")(2,"nb-card")(3,"nb-card-body")(4,"p"),u(5),n(),a(6,"p"),u(7),D(8,"json"),n(),B(9,at,2,0,"button",0)(10,ut,2,0,"button",1),n()()()()),o&2&&(m(5),O("Current User Authenticated: ",!!r.token),m(2),O("Current User Token: ",F(8,4,r.token)),m(2),S("ngIf",!r.token),m(),S("ngIf",r.token))},dependencies:[R,W,Q,y,C,U],encapsulation:2});let i=t;return i})();var it=(()=>{let t=class t{constructor(e,o){this.authService=e,this.router=o,this.destroy$=new f,this.authService.authenticate("azure").pipe(c(this.destroy$)).subscribe(r=>{r.isSuccess()&&r.getRedirect()&&this.router.navigateByUrl(r.getRedirect())})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};t.\u0275fac=function(o){return new(o||t)(l(k),l(P))},t.\u0275cmp=b({type:t,selectors:[["nb-playground-azure-callback"]],standalone:!1,decls:3,vars:0,template:function(o,r){o&1&&(a(0,"nb-layout")(1,"nb-layout-column"),u(2,"Authenticating..."),n()())},dependencies:[y,C],encapsulation:2});let i=t;return i})();var ot=(()=>{let t=class t extends Y{getValue(){return this.token.id_token}};t.NAME="nb:auth:azure:token";let i=t;return i})(),_=(()=>{let t=class t extends Z{constructor(){super(...arguments),this.redirectResultHandlers={[E.CODE]:()=>s(this.route.snapshot.queryParams).pipe(L(e=>e.code?this.requestToken(e.code):s(new d(!1,e,this.getOption("redirect.failure"),this.getOption("defaultErrors"),[])))),id_token:()=>{let o=this.getOption("authorize.requireValidToken");return s(this.route.snapshot.fragment).pipe(p(r=>this.parseHashAsQueryParams(r)),p(r=>r.error?new d(!1,r,this.getOption("redirect.failure"),this.getOption("defaultErrors"),[]):new d(!0,r,this.getOption("redirect.success"),[],this.getOption("defaultMessages"),this.createToken(r,o))),j(r=>{let A=[];return r instanceof X?A.push(r.message):A.push("Something went wrong."),s(new d(!1,r,this.getOption("redirect.failure"),A))}))}},this.redirectResults={[E.CODE]:()=>s(null),id_token:()=>s(this.route.snapshot.fragment).pipe(p(e=>this.parseHashAsQueryParams(e)),p(e=>!!(e&&(e.id_token||e.error))))}}static setup(e){return[t,e]}};t.\u0275fac=(()=>{let e;return function(r){return(e||(e=V(t)))(r||t)}})(),t.\u0275prov=$({token:t,factory:t.\u0275fac});let i=t;return i})();var ct=[{path:"",component:et},{path:"callback",component:it}],rt=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=g({type:t}),t.\u0275inj=h({imports:[M.forChild(ct),M]});let i=t;return i})();var Bt=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=g({type:t}),t.\u0275inj=h({providers:[_],imports:[q,J,H,tt.forRoot({strategies:[_.setup({name:"azure",clientId:"bde728e2-2809-4ff1-bc9c-7fcb23800ebe",clientSecret:"",authorize:{endpoint:"https://login.microsoftonline.com/01513fd2-16a0-453b-9fa0-c9089bfa023e/oauth2/authorize",responseType:"id_token",scope:"openid",redirectUri:"https://akveo.github.io/nebular/example/azure/callback",params:{p:"b2c_1_nebular"}},token:{class:ot},redirect:{success:"/example/azure"}})]}),G,K,rt]});let i=t;return i})();export{Bt as AzurePlaygroundModule};
