"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6472],{73176:(x,E,n)=>{n.d(E,{o:()=>N});var i=n(54438),T=n(21413),b=n(84412),S=n(57786),D=n(43236),y=n(41584);function u(f=0,U=D.E){return f<0&&(f=0),(0,y.O)(f,f,U)}var d=n(7673),c=n(27468),t=n(5964),m=n(25558),p=n(56977),O=n(39974),A=n(54360),F=n(58750);function L(f,U){return(0,O.N)((l,a)=>{const{leading:C=!0,trailing:R=!1}=U??{};let P=!1,B=null,g=null,$=!1;const M=()=>{g?.unsubscribe(),g=null,R&&(X(),$&&a.complete())},j=()=>{g=null,$&&a.complete()},Q=I=>g=(0,F.Tg)(f(I)).subscribe((0,A._)(a,M,j)),X=()=>{if(P){P=!1;const I=B;B=null,a.next(I),!$&&Q(I)}};l.subscribe((0,A._)(a,I=>{P=!0,B=I,(!g||g.closed)&&(C?X():Q(I))},()=>{$=!0,(!(R&&P&&g)||g.closed)&&a.complete()}))})}var G=n(96697),K=n(96354),H=n(53033),V=n(69600),W=n(79202),k=n(84461);let N=(()=>{class f{get elementScroll(){return!this.windowScroll}set throttleTime(l){this.throttleTime$.next(l)}get throttleTime(){return this.throttleTime$.value}set listenWindowScroll(l){this.windowScroll=(0,H.U)(l)}onElementScroll(){this.elementScroll&&this.elementScroll$.next()}constructor(l,a,C){this.elementRef=l,this.scrollService=a,this.dimensionsService=C,this.destroy$=new T.B,this.windowScroll=!1,this.elementScroll$=new T.B,this.windowScroll$=this.scrollService.onScroll().pipe((0,t.p)(()=>this.windowScroll)),this.bottomThreshold$=new T.B,this.topThreshold$=new T.B,this.throttleTime$=new b.t(0),this.bottomThreshold=new i.bkB(!0),this.topThreshold=new i.bkB(!0)}ngAfterViewInit(){(0,S.h)(this.windowScroll$,this.elementScroll$).pipe((0,m.n)(()=>this.getContainerDimensions()),(0,p.Q)(this.destroy$)).subscribe(l=>this.checkPosition(l)),this.throttleTime$.pipe((0,m.n)(()=>this.topThreshold$.pipe(L(()=>u(this.throttleTime)))),(0,p.Q)(this.destroy$)).subscribe(()=>{this.topThreshold.emit()}),this.throttleTime$.pipe((0,m.n)(()=>this.bottomThreshold$.pipe(L(()=>u(this.throttleTime)))),(0,p.Q)(this.destroy$)).subscribe(()=>{this.bottomThreshold.emit()}),this.listItems.changes.pipe((0,m.n)(()=>u(50).pipe((0,t.p)(()=>this.inSyncWithDom()),(0,G.s)(1),(0,p.Q)((0,y.O)(1e3)))),(0,m.n)(()=>this.getContainerDimensions()),(0,p.Q)(this.destroy$)).subscribe(l=>this.checkPosition(l)),this.getContainerDimensions().subscribe(l=>this.checkPosition(l))}ngOnDestroy(){this.topThreshold$.complete(),this.bottomThreshold$.complete(),this.elementScroll$.complete(),this.destroy$.next(),this.destroy$.complete()}checkPosition({scrollHeight:l,scrollTop:a,clientHeight:C}){const R=null==this.lastScrollPosition,B=a<this.lastScrollPosition;(R||this.lastScrollPosition===a||a>this.lastScrollPosition)&&l-a-C<=this.threshold&&this.bottomThreshold$.next(),(R||B)&&a<=this.threshold&&this.topThreshold$.next(),this.lastScrollPosition=a}getContainerDimensions(){if(this.elementScroll){const{scrollTop:l,scrollHeight:a,clientHeight:C}=this.elementRef.nativeElement;return(0,d.of)({scrollTop:l,scrollHeight:a,clientHeight:C})}return(0,c.p)([this.scrollService.getPosition(),this.dimensionsService.getDimensions()]).pipe((0,K.T)(([l,a])=>({scrollTop:l.y,scrollHeight:a.scrollHeight,clientHeight:a.clientHeight})))}inSyncWithDom(){return this.elementRef.nativeElement.children.length===this.listItems.length}static{this.\u0275fac=function(a){return new(a||f)(i.rXU(i.aKT),i.rXU(W.f),i.rXU(k._))}}static{this.\u0275dir=i.FsC({type:f,selectors:[["","nbInfiniteList",""]],contentQueries:function(a,C,R){if(1&a&&i.wni(R,V.T,4),2&a){let P;i.mGM(P=i.lsd())&&(C.listItems=P)}},hostBindings:function(a,C){1&a&&i.bIt("scroll",function(){return C.onElementScroll()})},inputs:{threshold:"threshold",throttleTime:"throttleTime",listenWindowScroll:"listenWindowScroll"},outputs:{bottomThreshold:"bottomThreshold",topThreshold:"topThreshold"},standalone:!1})}}return f})()},35535:(x,E,n)=>{n.d(E,{b:()=>D});var i=n(54438),T=n(56977),b=n(21413),S=n(69600);let D=(()=>{class y{constructor(){this.destroy$=new b.B,this.startPage=1,this.pageChange=new i.bkB,this.observer=new IntersectionObserver(d=>this.checkForPageChange(d),{threshold:.5})}ngAfterViewInit(){this.listItems&&this.listItems.length&&this.observeItems(),this.listItems.changes.pipe((0,T.Q)(this.destroy$)).subscribe(()=>this.observeItems())}ngOnDestroy(){this.observer.disconnect&&this.observer.disconnect()}observeItems(){this.listItems.forEach(d=>this.observer.observe(d.nativeElement))}checkForPageChange(d){const c=this.findMostVisiblePage(d);c&&this.currentPage!==c&&(this.currentPage=c,this.pageChange.emit(this.currentPage))}findMostVisiblePage(d){const c=new Map;for(const p of d){if(p.intersectionRatio<.5)continue;const O=this.elementIndex(p.target);if(-1===O)continue;const A=this.startPage+Math.floor(O/this.pageSize);let F=p.intersectionRatio;c.has(A)&&(F+=c.get(A)),c.set(A,F)}let m,t=0;return c.forEach((p,O)=>{p>t&&(t=p,m=O)}),m}elementIndex(d){return d.parentElement&&d.parentElement.children?Array.from(d.parentElement.children).indexOf(d):-1}static{this.\u0275fac=function(c){return new(c||y)}}static{this.\u0275dir=i.FsC({type:y,selectors:[["","nbListPageTracker",""]],contentQueries:function(c,t,m){if(1&c&&i.wni(m,S.T,4,i.aKT),2&c){let p;i.mGM(p=i.lsd())&&(t.listItems=p)}},inputs:{pageSize:"pageSize",startPage:"startPage"},outputs:{pageChange:"pageChange"},standalone:!1})}}return y})()},69600:(x,E,n)=>{n.d(E,{T:()=>y,k:()=>D});var i=n(54438);const T=[[["nb-list-item"]]],b=["nb-list-item"],S=["*"];let D=(()=>{class u{constructor(){this.role="list"}static{this.\u0275fac=function(t){return new(t||u)}}static{this.\u0275cmp=i.VBU({type:u,selectors:[["nb-list"]],hostVars:1,hostBindings:function(t,m){2&t&&i.BMQ("role",m.role)},inputs:{role:"role"},standalone:!1,ngContentSelectors:b,decls:1,vars:0,template:function(t,m){1&t&&(i.NAR(T),i.SdG(0))},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;flex:1 1 auto;overflow:auto}"]})}}return u})(),y=(()=>{class u{constructor(){this.role="listitem"}static{this.\u0275fac=function(t){return new(t||u)}}static{this.\u0275cmp=i.VBU({type:u,selectors:[["nb-list-item"]],hostVars:1,hostBindings:function(t,m){2&t&&i.BMQ("role",m.role)},inputs:{role:"role"},standalone:!1,ngContentSelectors:S,decls:1,vars:0,template:function(t,m){1&t&&(i.NAR(),i.SdG(0))},styles:["[_nghost-%COMP%]{display:flex;align-items:center;flex-shrink:0}"]})}}return u})()},4367:(x,E,n)=>{n.d(E,{P:()=>y}),n(69600),n(35535),n(73176);var S=n(54438);let y=(()=>{class u{static{this.\u0275fac=function(t){return new(t||u)}}static{this.\u0275mod=S.$C({type:u})}static{this.\u0275inj=S.G2t({})}}return u})()},46472:(x,E,n)=>{n.r(E),n.d(E,{AuthPlaygroundModule:()=>pt,filterInterceptorRequest:()=>q});var i=n(60177),T=n(89417),b=n(21626),S=n(37159),D=n(17229),y=n(4367),u=n(25558),d=n(22170),c=n(40696),t=n(54438);let m=(()=>{class s{constructor(e,o){this.injector=e,this.filter=o}intercept(e,o){return this.filter(e)?o.handle(e):this.authService.isAuthenticatedOrRefresh().pipe((0,u.n)(r=>r?this.authService.getToken().pipe((0,u.n)(h=>{const v=`Bearer ${h.getValue()}`;return e=e.clone({setHeaders:{Authorization:v}}),o.handle(e)})):o.handle(e)))}get authService(){return this.injector.get(d.U)}static{this.\u0275fac=function(o){return new(o||s)(t.KVO(t.zZn),t.KVO(c.Tp))}}static{this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac})}}return s})();var p=n(73688),O=n(18731),A=n(45254),F=n(61106),L=n(19653),G=n(89169);class K{}const H=new t.nKC("Nebular Security Options"),V=s=>Object.assign({},s),W=s=>Object.assign([],s),k=s=>{const w=s.parent;return delete s.parent,w};let Y=(()=>{class s{static{this.ANY_RESOURCE="*"}constructor(e={}){this.settings=e,this.state={},e.accessControl&&this.setAccessControl(e.accessControl)}setAccessControl(e){for(const[o,r]of Object.entries(e)){const h=V(r),v=k(h);this.register(o,v,h)}}register(e,o=null,r={}){this.validateRole(e),this.state[e]={parent:o};for(const[h,v]of Object.entries(r))this.allow(e,h,W("string"==typeof v?[v]:v))}allow(e,o,r){this.validateRole(e),this.getRole(e)||this.register(e,null,{}),r="string"==typeof r?[r]:r;let h=W(this.getRoleResources(e,o));h=h.concat(r),this.state[e][o]=h.filter((v,J)=>h.indexOf(v)===J)}can(e,o,r){return this.validateResource(r),this.getRoleParent(e)&&this.can(this.getRoleParent(e),o,r)||this.exactCan(e,o,r)}getRole(e){return this.state[e]}validateRole(e){if(!e)throw new Error("NbAclService: role name cannot be empty")}validateResource(e){if(!e||[s.ANY_RESOURCE].includes(e))throw new Error("NbAclService: cannot use empty or bulk '*' resource placeholder with 'can' method")}exactCan(e,o,r){const h=this.getRoleResources(e,o);return h.includes(r)||h.includes(s.ANY_RESOURCE)}getRoleResources(e,o){return this.getRoleAbilities(e)[o]||[]}getRoleAbilities(e){const o=V(this.state[e]||{});return k(V(this.state[e]||{})),o}getRoleParent(e){return this.state[e]?this.state[e].parent:null}static{this.\u0275fac=function(o){return new(o||s)(t.KVO(H,8))}}static{this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac})}}return s})();var N=n(96354);let f=(()=>{class s{constructor(e,o){this.roleProvider=e,this.acl=o}isGranted(e,o){return this.roleProvider.getRole().pipe((0,N.T)(r=>Array.isArray(r)?r:[r]),(0,N.T)(r=>r.some(h=>this.acl.can(h,e,o))))}static{this.\u0275fac=function(o){return new(o||s)(t.KVO(K),t.KVO(Y))}}static{this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac})}}return s})(),U=(()=>{class s{static forRoot(e){return{ngModule:s,providers:[{provide:H,useValue:e},Y,f]}}static{this.\u0275fac=function(o){return new(o||s)}}static{this.\u0275mod=t.$C({type:s})}static{this.\u0275inj=t.G2t({imports:[i.MD]})}}return s})();var l=n(54614);let a=(()=>{class s{static{this.\u0275fac=function(o){return new(o||s)}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["nb-playground-auth"]],standalone:!1,decls:1,vars:0,template:function(o,r){1&o&&t.nrm(0,"router-outlet")},dependencies:[l.n3],encapsulation:2})}}return s})();var C=n(37438),R=n(33555),P=n(99019),B=n(42653),g=n(36167),$=n(69967),M=n(84072),j=n(16248),Q=n(56977),X=n(21413);let I=(()=>{class s{constructor(e,o,r){this.templateRef=e,this.viewContainer=o,this.accessChecker=r,this.destroy$=new X.B,this.hasView=!1}set nbIsGranted([e,o]){this.accessChecker.isGranted(e,o).pipe((0,Q.Q)(this.destroy$)).subscribe(r=>{r&&!this.hasView?(this.viewContainer.createEmbeddedView(this.templateRef),this.hasView=!0):!r&&this.hasView&&(this.viewContainer.clear(),this.hasView=!1)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(o){return new(o||s)(t.rXU(t.C4Q),t.rXU(t.c1b),t.rXU(f))}}static{this.\u0275dir=t.FsC({type:s,selectors:[["","nbIsGranted",""]],inputs:{nbIsGranted:"nbIsGranted"},standalone:!1})}}return s})();const _=()=>["create","comments"];function tt(s,w){1&s&&(t.j41(0,"button"),t.EFF(1,"Post Comment"),t.k0s())}function et(s,w){1&s&&(t.j41(0,"button"),t.EFF(1,"Post Comment"),t.k0s())}let st=(()=>{class s{constructor(e){this.accessChecker=e}static{this.\u0275fac=function(o){return new(o||s)(t.rXU(f))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["nb-actions-test"]],standalone:!1,decls:13,vars:5,consts:[[4,"ngIf"],[4,"nbIsGranted"]],template:function(o,r){1&o&&(t.j41(0,"nb-layout")(1,"nb-layout-column")(2,"nb-card")(3,"nb-card-header"),t.EFF(4,"Service usage"),t.k0s(),t.j41(5,"nb-card-body"),t.DNE(6,tt,2,0,"button",0),t.nI1(7,"async"),t.k0s()(),t.j41(8,"nb-card")(9,"nb-card-header"),t.EFF(10,"Directive usage"),t.k0s(),t.j41(11,"nb-card-body"),t.DNE(12,et,2,0,"button",1),t.k0s()()()()),2&o&&(t.R7$(6),t.Y8G("ngIf",t.bMT(7,2,r.accessChecker.isGranted("create","comments"))),t.R7$(6),t.Y8G("nbIsGranted",t.lJ4(4,_)))},dependencies:[i.bT,M.Sr,M.KH,M.zJ,j.EA,j.U9,I,i.Jj],encapsulation:2})}}return s})();var nt=n(88141);let z=(()=>{class s{constructor(e,o){this.authService=e,this.router=o}canActivate(){return this.authService.isAuthenticated().pipe((0,nt.M)(e=>{e||this.router.navigate(["auth/login"])}))}static{this.\u0275fac=function(o){return new(o||s)(t.KVO(d.U),t.KVO(l.Ix))}}static{this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac})}}return s})();var ot=n(7673),it=n(41655),rt=n(99437),at=n(60061),Z=n(69600);function lt(s,w){if(1&s&&(t.j41(0,"nb-list-item"),t.EFF(1),t.k0s()),2&s){const e=w.$implicit;t.R7$(),t.E5c(" ",e.region,", ",e.name," (",e.year,") ")}}function ct(s,w){if(1&s&&(t.j41(0,"nb-card")(1,"nb-card-header"),t.EFF(2," Alain'wines "),t.k0s(),t.j41(3,"nb-list"),t.DNE(4,lt,2,3,"nb-list-item",2),t.nI1(5,"async"),t.k0s()()),2&s){const e=t.XpG();t.R7$(4),t.Y8G("ngForOf",t.bMT(5,1,e.wines$))}}const ut=[{path:"",component:a,children:[{path:"",component:C.s,children:[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:R.f},{path:"register",component:P.J},{path:"logout",component:B.k},{path:"request-password",component:g.g},{path:"reset-password",component:$.A}]}]},{path:"acl/acl-test.component",component:st},{path:"auth-guard.service",canActivate:[z],component:a},{path:"api-calls.component",canActivate:[z],component:(()=>{class s{constructor(e,o,r,h={}){this.authService=e,this.http=o,this.router=r,this.options=h,this.redirectDelay=0,this.strategy="",this.redirectDelay=this.getConfigValue("forms.logout.redirectDelay"),this.strategy=this.getConfigValue("forms.logout.strategy"),this.authService.onTokenChange().subscribe(v=>{this.token=null,v&&v.isValid()&&(this.token=v)})}logout(){this.authService.logout(this.strategy).pipe((0,it.c)(this.redirectDelay)).subscribe(e=>this.router.navigate(["/auth/login"]))}loadWines(){this.wines$=this.http.get("http://localhost:4400/api/wines").pipe((0,rt.W)(e=>(e instanceof b.yz&&401===e.status&&this.router.navigate(["/auth/login"]),(0,ot.of)([]))))}getConfigValue(e){return(0,at.mf)(this.options,e,null)}static{this.\u0275fac=function(o){return new(o||s)(t.rXU(d.U),t.rXU(b.Qq),t.rXU(l.Ix),t.rXU(c.$$))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["nb-playground-api-calls"]],standalone:!1,decls:15,vars:3,consts:[["nbButton","","status","primary",3,"click"],[4,"ngIf"],[4,"ngFor","ngForOf"]],template:function(o,r){if(1&o&&(t.nrm(0,"router-outlet"),t.j41(1,"nb-layout")(2,"nb-layout-column")(3,"nb-card")(4,"nb-card-body")(5,"h2"),t.EFF(6,"You are authenticated"),t.k0s(),t.j41(7,"p"),t.EFF(8,"You can call the secured API"),t.k0s(),t.j41(9,"button",0),t.bIt("click",function(){return r.loadWines()}),t.EFF(10,"Call API"),t.k0s(),t.j41(11,"button",0),t.bIt("click",function(){return r.logout()}),t.EFF(12,"Sign out"),t.k0s()()(),t.DNE(13,ct,6,3,"nb-card",1),t.nI1(14,"async"),t.k0s()()),2&o){let h;t.R7$(13),t.Y8G("ngIf",null==(h=t.bMT(14,1,r.wines$))?null:h.length)}},dependencies:[i.Sq,i.bT,l.n3,M.Sr,M.KH,M.zJ,j.EA,j.U9,Z.k,Z.T,i.Jj],encapsulation:2})}}return s})()}];let dt=(()=>{class s{static{this.\u0275fac=function(o){return new(o||s)}}static{this.\u0275mod=t.$C({type:s})}static{this.\u0275inj=t.G2t({imports:[l.iI.forChild(ut),l.iI]})}}return s})(),mt=(()=>{class s{constructor(e){this.authService=e}getRole(){return this.authService.onTokenChange().pipe((0,N.T)(e=>e instanceof F.ts&&e.isValid()?e.getPayload().role:"guest"))}static{this.\u0275fac=function(o){return new(o||s)(t.KVO(d.U))}}static{this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac})}}return s})();function q(s){return["http://localhost:4400/api/auth/","http://other.url/with/no/token/injected/"].some(w=>s.url.includes(w))}let pt=(()=>{class s{static{this.\u0275fac=function(o){return new(o||s)}}static{this.\u0275mod=t.$C({type:s})}static{this.\u0275inj=t.G2t({providers:[z,{provide:b.a7,useClass:m,multi:!0},{provide:c.Tp,useValue:q},{provide:K,useClass:mt}],imports:[i.MD,T.YN,b.q1,dt,S.l,D.l,y.P,p.bI.forRoot({forms:{login:{strategy:"password",redirectDelay:1e3,socialLinks:[{url:"https://github.com/akveo",target:"_blank",title:"GitHub"},{url:"https://www.facebook.com/akveo",target:"_blank",icon:"home-outline"},{url:"https://www.facebook.com/akveo",target:"_blank",title:"Twitter"}]}},strategies:[O.W.setup({name:"dummy",alwaysFail:!0,delay:1e3}),A.Z.setup({name:"email",token:{class:F.ts},baseEndpoint:"http://localhost:4400/api/auth/",logout:{redirect:{success:"/auth/login",failure:"/auth/login"}},requestPass:{redirect:{success:"/auth/reset-password"}},resetPass:{redirect:{success:"/auth/login"}},errors:{key:"data.errors"}}),L.x.setup({name:"password",clientId:"test",clientSecret:"secret",baseEndpoint:"http://localhost:4400/api/auth/",token:{endpoint:"token",grantType:G.cN.PASSWORD,class:F.HL},refresh:{endpoint:"refresh-token",grantType:G.cN.REFRESH_TOKEN}})]}),U.forRoot({accessControl:{guest:{view:["news","comments"]},user:{parent:"guest",create:"comments"},moderator:{parent:"user",create:"news",remove:"*"}}})]})}}return s})()}}]);