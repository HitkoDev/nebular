import{a as de,c as me,e as ue,f as ce,h as pe,i as ge,o as _e,p as fe,q as he,s as be,z as Ce}from"./chunk-OIFSN6AI.js";import{B as Y,Ba as ne,C as z,Ca as ie,D as K,E as Q,Fa as re,G as X,_ as $,aa as ee,fa as te,jb as oe,kb as ae,lb as se,n as D,p as R,q as U,qb as le,r as H,t as J,u as G}from"./chunk-NKUATUXO.js";import{Ab as k,Cb as E,Cc as W,Db as O,Eb as T,Ia as l,Ic as Z,Lb as x,Lc as N,Ma as h,Mb as w,Pa as L,Qa as b,Ua as c,_a as y,bb as m,cb as s,da as f,db as r,eb as P,fb as v,gb as S,hc as B,ia as g,ib as A,ic as j,ja as _,lb as I,mb as u,pc as q,qc as F,tb as p,vb as V,xb as d,yb as M,zb as C}from"./chunk-ZL7LBTKX.js";import"./chunk-2HP4JIPC.js";function ve(e,t){if(e&1){let n=A();s(0,"button",6),I("click",function(){g(n);let i=u(2);return _(i.logout())}),d(1,"Sign Out"),r()}}function Se(e,t){e&1&&(s(0,"nb-card-body")(1,"p"),d(2,"No User Authenticated"),r()())}function Ae(e,t){if(e&1&&(s(0,"nb-card")(1,"nb-card-body")(2,"h1",4),d(3,"You are currently authenticated"),r(),P(4,"p"),s(5,"p"),d(6),x(7,"json"),r(),s(8,"p"),d(9),x(10,"json"),r(),s(11,"p"),d(12),x(13,"json"),r(),c(14,ve,2,0,"button",5),r(),c(15,Se,3,0,"nb-card-body",3),r()),e&2){let n=u();l(6),C("Current User Access Token: ",w(7,5,n.token.getValue())),l(3),C("Current User Access Token Payload : ",w(10,7,n.getClaims(n.token.getValue()))),l(3),C("Current User Refresh Token: ",w(13,9,n.token.getRefreshToken())),l(2),m("ngIf",n.token),l(),m("ngIf",!n.token)}}function Ie(e,t){if(e&1&&(s(0,"li",23),d(1),r()),e&2){let n=t.$implicit;l(),M(n)}}function Me(e,t){if(e&1&&(s(0,"nb-alert",19)(1,"p",20)(2,"b"),d(3,"Oh snap!"),r()(),s(4,"ul",21),c(5,Ie,2,1,"li",22),r()()),e&2){let n=u(2);l(5),m("ngForOf",n.errors)}}function Ee(e,t){if(e&1&&(s(0,"li",23),d(1),r()),e&2){let n=t.$implicit;l(),M(n)}}function Oe(e,t){if(e&1&&(s(0,"nb-alert",24)(1,"p",20)(2,"b"),d(3,"Hooray!"),r()(),s(4,"ul",21),c(5,Ee,2,1,"li",22),r()()),e&2){let n=u(2);l(5),m("ngForOf",n.messages)}}function Te(e,t){e&1&&(s(0,"p",26),d(1," Email is required! "),r())}function Ne(e,t){e&1&&(s(0,"p",26),d(1," Email should be the real one! "),r())}function Le(e,t){if(e&1&&(v(0),c(1,Te,2,0,"p",25)(2,Ne,2,0,"p",25),S()),e&2){u();let n=p(15);l(),m("ngIf",n.errors==null?null:n.errors.required),l(),m("ngIf",n.errors==null?null:n.errors.pattern)}}function Pe(e,t){e&1&&(s(0,"p",26),d(1," Password is required! "),r())}function Ve(e,t){if(e&1&&(s(0,"p",26),d(1),r()),e&2){let n=u(3);l(),k(" Password should contains from ",n.getConfigValue("forms.validation.password.minLength")," to ",n.getConfigValue("forms.validation.password.maxLength")," characters ")}}function ke(e,t){if(e&1&&(v(0),c(1,Pe,2,0,"p",25)(2,Ve,2,2,"p",25),S()),e&2){u();let n=p(21);l(),m("ngIf",n.errors==null?null:n.errors.required),l(),m("ngIf",(n.errors==null?null:n.errors.minlength)||(n.errors==null?null:n.errors.maxlength))}}function Be(e,t){if(e&1){let n=A();s(0,"nb-card")(1,"nb-card-body")(2,"nb-auth-block",7)(3,"h1",8),d(4,"OAuth2 Sign In with email/password"),r(),s(5,"p",9),d(6,"Hello! Sign in with your username or email"),r(),c(7,Me,6,1,"nb-alert",10)(8,Oe,6,1,"nb-alert",11),s(9,"form",12,0),I("ngSubmit",function(){g(n);let i=u();return _(i.login())}),s(11,"div",13)(12,"label",14),d(13,"Email address:"),r(),s(14,"input",15,1),T("ngModelChange",function(i){g(n);let a=u();return O(a.user.email,i)||(a.user.email=i),_(i)}),r(),c(16,Le,3,2,"ng-container",3),r(),s(17,"div",13)(18,"label",16),d(19,"Password:"),r(),s(20,"input",17,2),T("ngModelChange",function(i){g(n);let a=u();return O(a.user.password,i)||(a.user.password=i),_(i)}),r(),c(22,ke,3,2,"ng-container",3),r(),s(23,"button",18),d(24," Sign In "),r()()()()()}if(e&2){let n=p(10),o=p(15),i=p(21),a=u();l(7),m("ngIf",a.showMessages.error&&(a.errors==null?null:a.errors.length)>0&&!a.submitted),l(),m("ngIf",a.showMessages.success&&(a.messages==null?null:a.messages.length)>0&&!a.submitted),l(6),E("ngModel",a.user.email),m("status",o.dirty?o.invalid?"danger":"success":"basic")("required",a.getConfigValue("forms.validation.email.required")),y("aria-invalid",o.invalid&&o.touched?!0:null),l(2),m("ngIf",o.invalid&&o.touched),l(4),E("ngModel",a.user.password),m("status",i.dirty?i.invalid?"danger":"success":"basic")("required",a.getConfigValue("forms.validation.password.required"))("minlength",a.getConfigValue("forms.validation.password.minLength"))("maxlength",a.getConfigValue("forms.validation.password.maxLength")),y("aria-invalid",i.invalid&&i.touched?!0:null),l(2),m("ngIf",i.invalid&&i.touched),l(),V("btn-pulse",a.submitted),m("disabled",a.submitted||!n.valid)}}var we=(()=>{let t=class t{constructor(o,i={},a){this.authService=o,this.options=i,this.router=a,this.redirectDelay=0,this.showMessages={},this.strategy="",this.errors=[],this.messages=[],this.user={},this.submitted=!1,this.redirectDelay=this.getConfigValue("forms.login.redirectDelay"),this.showMessages=this.getConfigValue("forms.login.showMessages"),this.strategy=this.getConfigValue("forms.login.strategy")}login(){this.errors=this.messages=[],this.submitted=!0,this.authService.authenticate(this.strategy,this.user).subscribe(o=>{this.submitted=!1,this.token=o.getToken(),o.isSuccess()?this.messages=o.getMessages():this.errors=o.getErrors();let i=o.getRedirect();i&&setTimeout(()=>this.router.navigateByUrl(i),this.redirectDelay)})}logout(){this.authService.logout("password").subscribe(o=>{this.token=null})}getConfigValue(o){return me(this.options,o,null)}getClaims(o){return o?ue(ce,o,this.strategy).getPayload():null}};t.\u0275fac=function(i){return new(i||t)(h(ge),h(de),h(Z))},t.\u0275cmp=L({type:t,selectors:[["nb-playground-auth"]],standalone:!1,decls:4,vars:2,consts:[["form","ngForm"],["email","ngModel"],["password","ngModel"],[4,"ngIf"],[1,"title"],["nbButton","","status","warning",3,"click",4,"ngIf"],["nbButton","","status","warning",3,"click"],["aria-labelledby","title"],["id","title",1,"title"],[1,"sub-title"],["outline","danger","role","alert",4,"ngIf"],["outline","success","role","alert",4,"ngIf"],["aria-labelledby","title",3,"ngSubmit"],[1,"form-control-group"],["for","input-email",1,"label"],["nbInput","","fullWidth","","name","email","id","input-email","pattern",".+@.+..+","placeholder","Email address","autofocus","",3,"ngModelChange","ngModel","status","required"],["for","input-password",1,"label"],["nbInput","","fullWidth","","name","password","type","password","id","input-password","placeholder","Password",3,"ngModelChange","ngModel","status","required","minlength","maxlength"],["nbButton","","fullWidth","","status","success",3,"disabled"],["outline","danger","role","alert"],[1,"alert-title"],[1,"alert-message-list"],["class","alert-message",4,"ngFor","ngForOf"],[1,"alert-message"],["outline","success","role","alert"],["class","caption status-danger",4,"ngIf"],[1,"caption","status-danger"]],template:function(i,a){i&1&&(s(0,"nb-layout")(1,"nb-layout-column"),c(2,Ae,16,11,"nb-card",3)(3,Be,25,17,"nb-card",3),r()()),i&2&&(l(2),m("ngIf",a.token),l(),m("ngIf",!a.token))},dependencies:[B,j,G,D,R,U,Y,z,K,Q,J,H,be,ee,$,ne,ie,oe,se,q],styles:["[_nghost-%COMP%]   nb-auth-block[_ngcontent-%COMP%]{margin:0 auto}"]});let e=t;return e})();var je=[{path:"",component:we}],ye=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=b({type:t}),t.\u0275inj=f({imports:[N.forChild(je),N]});let e=t;return e})();var st=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=b({type:t}),t.\u0275inj=f({imports:[F,X,W,Ce.forRoot({forms:{login:{redirectDelay:3e3,showMessages:{error:!0,success:!1},strategy:"password"}},strategies:[he.setup({name:"password",clientId:"Aladdin",clientSecret:"open sesame",clientAuthMethod:fe.BASIC,baseEndpoint:"http://localhost:4400/api/auth/",token:{endpoint:"token",grantType:_e.PASSWORD,class:pe,requireValidToken:!0},redirect:{success:"/oauth2-password"}})]}),te,re,ae,le,ye]});let e=t;return e})();export{st as OAuth2PasswordPlaygroundModule};
