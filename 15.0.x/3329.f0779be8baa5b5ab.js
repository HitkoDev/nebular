"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3329],{21076:(Si,pt,H)=>{H.d(pt,{$L:()=>We,$g:()=>gt,A4:()=>U,Am:()=>Pn,As:()=>fn,Bd:()=>O,Cv:()=>Mt,FA:()=>hn,Fy:()=>un,HN:()=>ur,Hk:()=>$,I9:()=>Ct,Im:()=>mt,K3:()=>$e,KA:()=>wt,Ku:()=>jr,Ll:()=>Ne,OE:()=>be,T9:()=>Fe,Uj:()=>Ce,XA:()=>me,ZQ:()=>z,bD:()=>Ft,c1:()=>Ke,cY:()=>Ae,dI:()=>Ut,eX:()=>Wr,g:()=>he,gR:()=>cr,gz:()=>ct,hp:()=>Nn,jZ:()=>Ue,kH:()=>kn,kj:()=>Ni,lT:()=>sr,lV:()=>Jt,mS:()=>_e,oD:()=>yt,od:()=>On,p7:()=>xe,qc:()=>Hr,sr:()=>_t,tD:()=>vt,u:()=>L,vA:()=>_,yw:()=>lr,zW:()=>or,zw:()=>K});const m={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},_=function(E,I){if(!E)throw $(I)},$=function(E){return new Error("Firebase Database ("+m.SDK_VERSION+") INTERNAL ASSERT FAILED: "+E)},N=function(E){const I=[];let T=0;for(let D=0;D<E.length;D++){let C=E.charCodeAt(D);C<128?I[T++]=C:C<2048?(I[T++]=C>>6|192,I[T++]=63&C|128):55296==(64512&C)&&D+1<E.length&&56320==(64512&E.charCodeAt(D+1))?(C=65536+((1023&C)<<10)+(1023&E.charCodeAt(++D)),I[T++]=C>>18|240,I[T++]=C>>12&63|128,I[T++]=C>>6&63|128,I[T++]=63&C|128):(I[T++]=C>>12|224,I[T++]=C>>6&63|128,I[T++]=63&C|128)}return I},$e={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(E,I){if(!Array.isArray(E))throw Error("encodeByteArray takes an array as a parameter");this.init_();const T=I?this.byteToCharMapWebSafe_:this.byteToCharMap_,D=[];for(let C=0;C<E.length;C+=3){const B=E[C],Z=C+1<E.length,re=Z?E[C+1]:0,ze=C+2<E.length,Se=ze?E[C+2]:0;let je=(15&re)<<2|Se>>6,ut=63&Se;ze||(ut=64,Z||(je=64)),D.push(T[B>>2],T[(3&B)<<4|re>>4],T[je],T[ut])}return D.join("")},encodeString(E,I){return this.HAS_NATIVE_SUPPORT&&!I?btoa(E):this.encodeByteArray(N(E),I)},decodeString(E,I){return this.HAS_NATIVE_SUPPORT&&!I?atob(E):function(E){const I=[];let T=0,D=0;for(;T<E.length;){const C=E[T++];if(C<128)I[D++]=String.fromCharCode(C);else if(C>191&&C<224){const B=E[T++];I[D++]=String.fromCharCode((31&C)<<6|63&B)}else if(C>239&&C<365){const ze=((7&C)<<18|(63&E[T++])<<12|(63&E[T++])<<6|63&E[T++])-65536;I[D++]=String.fromCharCode(55296+(ze>>10)),I[D++]=String.fromCharCode(56320+(1023&ze))}else{const B=E[T++],Z=E[T++];I[D++]=String.fromCharCode((15&C)<<12|(63&B)<<6|63&Z)}}return I.join("")}(this.decodeStringToByteArray(E,I))},decodeStringToByteArray(E,I){this.init_();const T=I?this.charToByteMapWebSafe_:this.charToByteMap_,D=[];for(let C=0;C<E.length;){const B=T[E.charAt(C++)],re=C<E.length?T[E.charAt(C)]:0;++C;const Se=C<E.length?T[E.charAt(C)]:64;++C;const te=C<E.length?T[E.charAt(C)]:64;if(++C,null==B||null==re||null==Se||null==te)throw new Je;D.push(B<<2|re>>4),64!==Se&&(D.push(re<<4&240|Se>>2),64!==te&&D.push(Se<<6&192|te))}return D},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let E=0;E<this.ENCODED_VALS.length;E++)this.byteToCharMap_[E]=this.ENCODED_VALS.charAt(E),this.charToByteMap_[this.byteToCharMap_[E]]=E,this.byteToCharMapWebSafe_[E]=this.ENCODED_VALS_WEBSAFE.charAt(E),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[E]]=E,E>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(E)]=E,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(E)]=E)}}};class Je extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wt=function(E){const I=N(E);return $e.encodeByteArray(I,!0)},Ce=function(E){return wt(E).replace(/\./g,"")},L=function(E){try{return $e.decodeString(E,!0)}catch(I){console.error("base64Decode failed: ",I)}return null};function U(E){return K(void 0,E)}function K(E,I){if(!(I instanceof Object))return I;switch(I.constructor){case Date:return new Date(I.getTime());case Object:void 0===E&&(E={});break;case Array:E=[];break;default:return I}for(const T in I)!I.hasOwnProperty(T)||!oe(T)||(E[T]=K(E[T],I[T]));return E}function oe(E){return"__proto__"!==E}function _e(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const ae=()=>{try{return _e().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const E=process.env.__FIREBASE_DEFAULTS__;return E?JSON.parse(E):void 0})()||(()=>{if(typeof document>"u")return;let E;try{E=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const I=E&&L(E[1]);return I&&JSON.parse(I)})()}catch(E){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${E}`)}},Fe=()=>{var E;return null===(E=ae())||void 0===E?void 0:E.config},me=E=>{var I;return null===(I=ae())||void 0===I?void 0:I[`_${E}`]};class Ae{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((I,T)=>{this.resolve=I,this.reject=T})}wrapCallback(I){return(T,D)=>{T?this.reject(T):this.resolve(D),"function"==typeof I&&(this.promise.catch(()=>{}),1===I.length?I(T):I(T,D))}}}function un(E,I){if(E.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const D=I||"demo-project",C=E.iat||0,B=E.sub||E.user_id;if(!B)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const Z=Object.assign({iss:`https://securetoken.google.com/${D}`,aud:D,iat:C,exp:C+3600,auth_time:C,sub:B,user_id:B,firebase:{sign_in_provider:"custom",identities:{}}},E);return[Ce(JSON.stringify({alg:"none",type:"JWT"})),Ce(JSON.stringify(Z)),""].join(".")}function z(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Ue(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(z())}function Ne(){var E;const I=null===(E=ae())||void 0===E?void 0:E.forceEnvironment;if("node"===I)return!0;if("browser"===I)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function O(){return typeof window<"u"||xe()}function xe(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ke(){return typeof navigator<"u"&&"Cloudflare-Workers"===navigator.userAgent}function _t(){const E="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof E&&void 0!==E.id}function Jt(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function sr(){const E=z();return E.indexOf("MSIE ")>=0||E.indexOf("Trident/")>=0}function gt(){return!0===m.NODE_CLIENT||!0===m.NODE_ADMIN}function or(){try{return"object"==typeof indexedDB}catch{return!1}}function Wr(){return new Promise((E,I)=>{try{let T=!0;const D="validate-browser-context-for-indexeddb-analytics-module",C=self.indexedDB.open(D);C.onsuccess=()=>{C.result.close(),T||self.indexedDB.deleteDatabase(D),E(!0)},C.onupgradeneeded=()=>{T=!1},C.onerror=()=>{var B;I((null===(B=C.error)||void 0===B?void 0:B.message)||"")}}catch(T){I(T)}})}class he extends Error{constructor(I,T,D){super(T),this.code=I,this.customData=D,this.name="FirebaseError",Object.setPrototypeOf(this,he.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,hn.prototype.create)}}class hn{constructor(I,T,D){this.service=I,this.serviceName=T,this.errors=D}create(I,...T){const D=T[0]||{},C=`${this.service}/${I}`,B=this.errors[I],Z=B?function Rn(E,I){return E.replace(ar,(T,D)=>{const C=I[D];return null!=C?String(C):`<${D}?>`})}(B,D):"Error";return new he(C,`${this.serviceName}: ${Z} (${C}).`,D)}}const ar=/\{\$([^}]+)}/g;function We(E){return JSON.parse(E)}function fn(E){return JSON.stringify(E)}const Xt=function(E){let I={},T={},D={},C="";try{const B=E.split(".");I=We(L(B[0])||""),T=We(L(B[1])||""),C=B[2],D=T.d||{},delete T.d}catch{}return{header:I,claims:T,data:D,signature:C}},Mt=function(E){const T=Xt(E).claims;return!!T&&"object"==typeof T&&T.hasOwnProperty("iat")},Hr=function(E){const I=Xt(E).claims;return"object"==typeof I&&!0===I.admin};function cr(E,I){return Object.prototype.hasOwnProperty.call(E,I)}function lr(E,I){if(Object.prototype.hasOwnProperty.call(E,I))return E[I]}function mt(E){for(const I in E)if(Object.prototype.hasOwnProperty.call(E,I))return!1;return!0}function kn(E,I,T){const D={};for(const C in E)Object.prototype.hasOwnProperty.call(E,C)&&(D[C]=I.call(T,E[C],C,E));return D}function Ft(E,I){if(E===I)return!0;const T=Object.keys(E),D=Object.keys(I);for(const C of T){if(!D.includes(C))return!1;const B=E[C],Z=I[C];if(pn(B)&&pn(Z)){if(!Ft(B,Z))return!1}else if(B!==Z)return!1}for(const C of D)if(!T.includes(C))return!1;return!0}function pn(E){return null!==E&&"object"==typeof E}function Pn(E){const I=[];for(const[T,D]of Object.entries(E))Array.isArray(D)?D.forEach(C=>{I.push(encodeURIComponent(T)+"="+encodeURIComponent(C))}):I.push(encodeURIComponent(T)+"="+encodeURIComponent(D));return I.length?"&"+I.join("&"):""}function Ct(E){const I={};return E.replace(/^\?/,"").split("&").forEach(D=>{if(D){const[C,B]=D.split("=");I[decodeURIComponent(C)]=decodeURIComponent(B)}}),I}function Nn(E){const I=E.indexOf("?");if(!I)return"";const T=E.indexOf("#",I);return E.substring(I,T>0?T:void 0)}class ct{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let I=1;I<this.blockSize;++I)this.pad_[I]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(I,T){T||(T=0);const D=this.W_;if("string"==typeof I)for(let te=0;te<16;te++)D[te]=I.charCodeAt(T)<<24|I.charCodeAt(T+1)<<16|I.charCodeAt(T+2)<<8|I.charCodeAt(T+3),T+=4;else for(let te=0;te<16;te++)D[te]=I[T]<<24|I[T+1]<<16|I[T+2]<<8|I[T+3],T+=4;for(let te=16;te<80;te++){const je=D[te-3]^D[te-8]^D[te-14]^D[te-16];D[te]=4294967295&(je<<1|je>>>31)}let Se,ue,C=this.chain_[0],B=this.chain_[1],Z=this.chain_[2],re=this.chain_[3],ze=this.chain_[4];for(let te=0;te<80;te++){te<40?te<20?(Se=re^B&(Z^re),ue=1518500249):(Se=B^Z^re,ue=1859775393):te<60?(Se=B&Z|re&(B|Z),ue=2400959708):(Se=B^Z^re,ue=3395469782);const je=(C<<5|C>>>27)+Se+ze+ue+D[te]&4294967295;ze=re,re=Z,Z=4294967295&(B<<30|B>>>2),B=C,C=je}this.chain_[0]=this.chain_[0]+C&4294967295,this.chain_[1]=this.chain_[1]+B&4294967295,this.chain_[2]=this.chain_[2]+Z&4294967295,this.chain_[3]=this.chain_[3]+re&4294967295,this.chain_[4]=this.chain_[4]+ze&4294967295}update(I,T){if(null==I)return;void 0===T&&(T=I.length);const D=T-this.blockSize;let C=0;const B=this.buf_;let Z=this.inbuf_;for(;C<T;){if(0===Z)for(;C<=D;)this.compress_(I,C),C+=this.blockSize;if("string"==typeof I){for(;C<T;)if(B[Z]=I.charCodeAt(C),++Z,++C,Z===this.blockSize){this.compress_(B),Z=0;break}}else for(;C<T;)if(B[Z]=I[C],++Z,++C,Z===this.blockSize){this.compress_(B),Z=0;break}}this.inbuf_=Z,this.total_+=T}digest(){const I=[];let T=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let C=this.blockSize-1;C>=56;C--)this.buf_[C]=255&T,T/=256;this.compress_(this.buf_);let D=0;for(let C=0;C<5;C++)for(let B=24;B>=0;B-=8)I[D]=this.chain_[C]>>B&255,++D;return I}}function vt(E,I){const T=new lt(E,I);return T.subscribe.bind(T)}class lt{constructor(I,T){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=T,this.task.then(()=>{I(this)}).catch(D=>{this.error(D)})}next(I){this.forEachObserver(T=>{T.next(I)})}error(I){this.forEachObserver(T=>{T.error(I)}),this.close(I)}complete(){this.forEachObserver(I=>{I.complete()}),this.close()}subscribe(I,T,D){let C;if(void 0===I&&void 0===T&&void 0===D)throw new Error("Missing Observer.");C=function Pi(E,I){if("object"!=typeof E||null===E)return!1;for(const T of I)if(T in E&&"function"==typeof E[T])return!0;return!1}(I,["next","error","complete"])?I:{next:I,error:T,complete:D},void 0===C.next&&(C.next=bt),void 0===C.error&&(C.error=bt),void 0===C.complete&&(C.complete=bt);const B=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?C.error(this.finalError):C.complete()}catch{}}),this.observers.push(C),B}unsubscribeOne(I){void 0===this.observers||void 0===this.observers[I]||(delete this.observers[I],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(I){if(!this.finalized)for(let T=0;T<this.observers.length;T++)this.sendOne(T,I)}sendOne(I,T){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[I])try{T(this.observers[I])}catch(D){typeof console<"u"&&console.error&&console.error(D)}})}close(I){this.finalized||(this.finalized=!0,void 0!==I&&(this.finalError=I),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function bt(){}const On=function(E,I,T,D){let C;if(D<I?C="at least "+I:D>T&&(C=0===T?"none":"no more than "+T),C)throw new Error(E+" failed: Was called with "+D+(1===D?" argument.":" arguments.")+" Expects "+C+".")};function Ut(E,I){return`${E} failed: ${I} argument `}function yt(E,I,T,D){if((!D||T)&&"function"!=typeof T)throw new Error(Ut(E,I)+"must be a valid function.")}function ur(E,I,T,D){if((!D||T)&&("object"!=typeof T||null===T))throw new Error(Ut(E,I)+"must be a valid context object.")}const Ni=function(E){const I=[];let T=0;for(let D=0;D<E.length;D++){let C=E.charCodeAt(D);if(C>=55296&&C<=56319){const B=C-55296;D++,_(D<E.length,"Surrogate pair missing trail surrogate."),C=65536+(B<<10)+(E.charCodeAt(D)-56320)}C<128?I[T++]=C:C<2048?(I[T++]=C>>6|192,I[T++]=63&C|128):C<65536?(I[T++]=C>>12|224,I[T++]=C>>6&63|128,I[T++]=63&C|128):(I[T++]=C>>18|240,I[T++]=C>>12&63|128,I[T++]=C>>6&63|128,I[T++]=63&C|128)}return I},be=function(E){let I=0;for(let T=0;T<E.length;T++){const D=E.charCodeAt(T);D<128?I++:D<2048?I+=2:D>=55296&&D<=56319?(I+=4,T++):I+=3}return I};function jr(E){return E&&E._delegate?E._delegate:E}},63329:(Si,pt,H)=>{H.r(pt),H.d(pt,{FirebasePlaygroundModule:()=>Ep});var m=H(60177),_=H(54438),$=H(17852);(0,$.registerVersion)("firebase","11.3.1","app");var $e=H(96780),wt=H(39687);const L=new class Ce extends wt.q{}(class Je extends $e.R{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,i=0){return null!=i&&i>0||null==i&&this.delay>0?super.requestAsyncId(t,e,i):(t.flush(this),0)}});var K=H(43236);const oe=new _.RxE("ANGULARFIRE2_VERSION");class rt{zone;delegate;constructor(t,e=L){this.zone=t,this.delegate=e}now(){return this.delegate.now()}schedule(t,e,i){const o=this.zone;return this.delegate.schedule(function(u){o?o.runGuarded(()=>{t.apply(this,[u])}):t.apply(this,[u])},e,i)}}let Fe=(()=>{class n{outsideAngular;insideAngular;constructor(){const e=(0,_.WQX)(_.SKi);this.outsideAngular=e.runOutsideAngular(()=>new rt(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=e.run(()=>new rt(typeof Zone>"u"?void 0:Zone.current,K.E))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=_.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var O=H(63345);O.A.registerVersion("firebase","11.3.1","app-compat");const _t=["ngOnDestroy"];class sr{constructor(t){return t}}const Sn=new _.nKC("angularfire2.app.options"),gt=new _.nKC("angularfire2.app.name");function dn(n,t,e){const o="object"==typeof e&&e||{};o.name=o.name||"string"==typeof e&&e||"[DEFAULT]";const u=O.A.apps.filter(h=>h&&h.name===o.name)[0]||t.runOutsideAngular(()=>O.A.initializeApp(n,o));try{if(JSON.stringify(n)!==JSON.stringify(u.options)){const h=!!module.hot;or("error",`${u.name} Firebase App already initialized with different options${h?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new sr(u)}const or=(n,...t)=>{(0,_.naY)()&&typeof console<"u"&&console[n](...t)},Wr={provide:sr,useFactory:dn,deps:[Sn,_.SKi,[new _.Xx1,gt]]};let Ri=(()=>{class n{static initializeApp(e,i){return{ngModule:n,providers:[{provide:Sn,useValue:e},{provide:gt,useValue:i}]}}constructor(e){O.A.registerVersion("angularfire",oe.full,"core"),O.A.registerVersion("angularfire",oe.full,"app-compat"),O.A.registerVersion("angular",_.xvI.full,e.toString())}static \u0275fac=function(i){return new(i||n)(_.KVO(_.Agw))};static \u0275mod=_.$C({type:n});static \u0275inj=_.G2t({providers:[Wr]})}return n})();function fe(n,t,e,i,o){const[,l,u]=globalThis.\u0275AngularfireInstanceCache.find(h=>h[0]===n)||[];if(l)return function he(n,t){try{return n.toString()===t.toString()}catch{return n===t}}(o,u)||(Rn("error",`${t} was already initialized on the ${e} Firebase App with different settings.${hn?" You may need to reload as Firebase is not HMR aware.":""}`),Rn("warn",{is:o,was:u})),l;{const h=i();return globalThis.\u0275AngularfireInstanceCache.push([n,h,o]),h}}const hn=typeof module<"u"&&!!module.hot,Rn=(n,...t)=>{(0,_.naY)()&&typeof console<"u"&&console[n](...t)};globalThis.\u0275AngularfireInstanceCache||=[],H(66240);var We=H(71985);function mt(n){void 0===n&&((0,_.Af3)(mt),n=(0,_.WQX)(_.zZn));const t=n.get(_.u5s);return e=>new We.c(i=>{const o=t.add();let l=!1;function u(){l||(o(),l=!0)}const h=e.subscribe({next:p=>{i.next(p),u()},complete:()=>{i.complete(),u()},error:p=>{i.error(p),u()}});return h.add(()=>{i.unsubscribe(),u()}),h})}var be=H(10467),Ge=H(51362),g=H(21076),Vt=H(8041);const Dn=new Map,_n={activated:!1,tokenObservers:[]},Oi={initialized:!1,enabled:!1};function ve(n){return Dn.get(n)||Object.assign({},_n)}function E(){return Oi}class re{constructor(t,e,i,o,l){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=i,this.lowerBound=o,this.upperBound=l,this.pending=null,this.nextErrorWaitInterval=o,o>l)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(t){var e=this;return(0,be.A)(function*(){e.stop();try{e.pending=new g.cY,e.pending.promise.catch(i=>{}),yield function ze(n){return new Promise(t=>{setTimeout(t,n)})}(e.getNextRun(t)),e.pending.resolve(),yield e.pending.promise,e.pending=new g.cY,e.pending.promise.catch(i=>{}),yield e.operation(),e.pending.resolve(),yield e.pending.promise,e.process(!0).catch(()=>{})}catch(i){e.retryPolicy(i)?e.process(!1).catch(()=>{}):e.stop()}})()}getNextRun(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e}}}const ue=new g.FA("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function je(n){if(!ve(n).activated)throw ue.create("use-before-activation",{appName:n.name})}function xn(n,t){return dr.apply(this,arguments)}function dr(){return(dr=(0,be.A)(function*({url:n,body:t},e){const i={"Content-Type":"application/json"},o=e.getImmediate({optional:!0});if(o){const S=yield o.getHeartbeatsHeader();S&&(i["X-Firebase-Client"]=S)}const l={method:"POST",body:JSON.stringify(t),headers:i};let u,h;try{u=yield fetch(n,l)}catch(S){throw ue.create("fetch-network-error",{originalErrorMessage:S?.message})}if(200!==u.status)throw ue.create("fetch-status-error",{httpStatus:u.status});try{h=yield u.json()}catch(S){throw ue.create("fetch-parse-error",{originalErrorMessage:S?.message})}const p=h.ttl.match(/^([\d.]+)(s)$/);if(!p||!p[2]||isNaN(Number(p[1])))throw ue.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${h.ttl}`});const v=1e3*Number(p[1]),R=Date.now();return{token:h.token,expireTimeMillis:R+v,issuedAtTimeMillis:R}})).apply(this,arguments)}function Kr(n,t){const{projectId:e,appId:i,apiKey:o}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${e}/apps/${i}:exchangeDebugToken?key=${o}`,body:{debug_token:t}}}const Fn="firebase-app-check-store";let b=null;function Te(){return(Te=(0,be.A)(function*(n,t){const i=(yield function w(){return b||(b=new Promise((n,t)=>{try{const e=indexedDB.open("firebase-app-check-database",1);e.onsuccess=i=>{n(i.target.result)},e.onerror=i=>{var o;t(ue.create("storage-open",{originalErrorMessage:null===(o=i.target.error)||void 0===o?void 0:o.message}))},e.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(Fn,{keyPath:"compositeKey"})}}catch(e){t(ue.create("storage-open",{originalErrorMessage:e?.message}))}}),b)}()).transaction(Fn,"readwrite"),l=i.objectStore(Fn).put({compositeKey:n,value:t});return new Promise((u,h)=>{l.onsuccess=p=>{u()},i.onerror=p=>{var v;h(ue.create("storage-set",{originalErrorMessage:null===(v=p.target.error)||void 0===v?void 0:v.message}))}})})).apply(this,arguments)}const Un=new Vt.Vy("@firebase/app-check");function zs(n,t){return(0,g.zW)()?function V(n,t){return function ne(n,t){return Te.apply(this,arguments)}(function It(n){return`${n.options.appId}-${n.name}`}(n),t)}(n,t).catch(e=>{Un.warn(`Failed to write token to IndexedDB. Error: ${e}`)}):Promise.resolve()}function qs(){return E().enabled}function Ys(){return hr.apply(this,arguments)}function hr(){return(hr=(0,be.A)(function*(){const n=E();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const cl={error:"UNKNOWN_ERROR"};function ll(n){return g.K3.encodeString(JSON.stringify(n),!1)}function Mi(n){return Qs.apply(this,arguments)}function Qs(){return(Qs=(0,be.A)(function*(n,t=!1){const e=n.app;je(e);const i=ve(e);let l,o=i.token;if(o&&!Hn(o)&&(i.token=void 0,o=void 0),!o){const p=yield i.cachedTokenPromise;p&&(Hn(p)?o=p:yield zs(e,void 0))}if(!t&&o&&Hn(o))return{token:o.token};let h,u=!1;if(qs()){i.exchangeTokenPromise||(i.exchangeTokenPromise=xn(Kr(e,yield Ys()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),u=!0);const p=yield i.exchangeTokenPromise;return yield zs(e,p),i.token=p,{token:p.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),u=!0),o=yield ve(e).exchangeTokenPromise}catch(p){"appCheck/throttled"===p.code?Un.warn(p.message):Un.error(p),l=p}return o?l?h=Hn(o)?{token:o.token,internalError:l}:Wi(l):(h={token:o.token},i.token=o,yield zs(e,o)):h=Wi(l),u&&function Vi(n,t){const e=ve(n).tokenObservers;for(const i of e)try{"EXTERNAL"===i.type&&null!=t.error?i.error(t.error):i.next(t)}catch{}}(e,h),h})).apply(this,arguments)}function Vn(){return(Vn=(0,be.A)(function*(n){const t=n.app;je(t);const{provider:e}=ve(t);if(qs()){const i=yield Ys(),{token:o}=yield xn(Kr(t,i),n.heartbeatServiceProvider);return{token:o}}{const{token:i}=yield e.getToken();return{token:i}}})).apply(this,arguments)}function Wn(n,t){const e=ve(n),i=e.tokenObservers.filter(o=>o.next!==t);0===i.length&&e.tokenRefresher&&e.tokenRefresher.isRunning()&&e.tokenRefresher.stop(),e.tokenObservers=i}function Ui(n){const{app:t}=n,e=ve(t);let i=e.tokenRefresher;i||(i=function gn(n){const{app:t}=n;return new re((0,be.A)(function*(){let i;if(i=ve(t).token?yield Mi(n,!0):yield Mi(n),i.error)throw i.error;if(i.internalError)throw i.internalError}),()=>!0,()=>{const e=ve(t);if(e.token){let i=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return i=Math.min(i,e.token.expireTimeMillis-3e5),Math.max(0,i-Date.now())}return 0},3e4,96e4)}(n),e.tokenRefresher=i),!i.isRunning()&&e.isTokenAutoRefreshEnabled&&i.start()}function Hn(n){return n.expireTimeMillis-Date.now()>0}function Wi(n){return{token:ll(cl),error:n}}class ul{constructor(t,e){this.app=t,this.heartbeatServiceProvider=e}_delete(){const{tokenObservers:t}=ve(this.app);for(const e of t)Wn(this.app,e.next);return Promise.resolve()}}const $i="app-check-internal";!function ml(){(0,$._registerComponent)(new Ge.uA("app-check",n=>function dl(n,t){return new ul(n,t)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,t,e)=>{n.getProvider($i).initialize()})),(0,$._registerComponent)(new Ge.uA($i,n=>function Na(n){return{getToken:t=>Mi(n,t),getLimitedUseToken:()=>function Pa(n){return Vn.apply(this,arguments)}(n),addTokenListener:t=>function Fi(n,t,e,i){const{app:o}=n,l=ve(o);if(l.tokenObservers=[...l.tokenObservers,{next:e,error:i,type:t}],l.token&&Hn(l.token)){const h=l.token;Promise.resolve().then(()=>{e({token:h.token}),Ui(n)}).catch(()=>{})}l.cachedTokenPromise.then(()=>Ui(n))}(n,"INTERNAL",t),removeTokenListener:t=>Wn(n.app,t)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,$.registerVersion)("@firebase/app-check","0.8.11")}();class St{constructor(){return(n=>{const e=(0,$.getApps)(),i=[];return e.forEach(o=>{o.container.getProvider(n).instances.forEach(u=>{i.includes(u)||i.push(u)})}),i})("app-check")}}typeof window<"u"&&window;var qr=H(21413),mn=H(7673),it=H(48455),Rt=H(57786),Zt=H(40941),Le=H(25558),qe=H(96354),ro=H(44668),$a=H(61594),El=H(98071);function jn(n,t){return(0,El.T)(t)?(0,Le.n)(()=>n,t):(0,Le.n)(()=>n)}var io=H(56745),Gi=H(5964);const so=new _.nKC("angularfire2.auth.use-emulator"),zi=new _.nKC("angularfire2.auth.settings"),dt=new _.nKC("angularfire2.auth.tenant-id"),oo=new _.nKC("angularfire2.auth.langugage-code"),Ga=new _.nKC("angularfire2.auth.use-device-language"),qi=new _.nKC("angularfire.auth.persistence"),Yr=(n,t,e,i,o,l,u,h)=>fe(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const p=t.runOutsideAngular(()=>n.auth());if(e&&p.useEmulator(...e),i&&(p.tenantId=i),p.languageCode=o,l&&p.useDeviceLanguage(),u)for(const[v,R]of Object.entries(u))p.settings[v]=R;return h&&p.setPersistence(h),p},[e,i,o,l,u,h]);let Qr=(()=>{class n{injector=(0,_.WQX)(_.uvJ);authState;idToken;user;idTokenResult;credential;constructor(e,i,o,l,u,h,p,v,R,S,x,j){const G=new qr.B,le=(0,mn.of)(void 0).pipe((0,Zt.Q)(u.outsideAngular),(0,Le.n)(()=>l.runOutsideAngular(()=>Promise.resolve().then(H.bind(H,66240)))),(0,qe.T)(()=>dn(e,l,i)),(0,qe.T)(we=>Yr(we,l,h,v,R,S,p,x)),(0,ro.t)({bufferSize:1,refCount:!1}));if((0,m.Vy)(o))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,mn.of)(null);else{le.pipe((0,$a.$)()).subscribe();const we=le.pipe((0,Le.n)(Pe=>Pe.getRedirectResult().then(ln=>ln,()=>null)),mt(this.injector),(0,ro.t)({bufferSize:1,refCount:!1})),xt=le.pipe((0,Le.n)(Pe=>new We.c(ln=>({unsubscribe:l.runOutsideAngular(()=>Pe.onAuthStateChanged(bi=>ln.next(bi),bi=>ln.error(bi),()=>ln.complete()))})))),Lt=le.pipe((0,Le.n)(Pe=>new We.c(ln=>({unsubscribe:l.runOutsideAngular(()=>Pe.onIdTokenChanged(bi=>ln.next(bi),bi=>ln.error(bi),()=>ln.complete()))}))));this.authState=we.pipe(jn(xt),(0,io._)(u.outsideAngular),(0,Zt.Q)(u.insideAngular)),this.user=we.pipe(jn(Lt),(0,io._)(u.outsideAngular),(0,Zt.Q)(u.insideAngular)),this.idToken=this.user.pipe((0,Le.n)(Pe=>Pe?(0,it.H)(Pe.getIdToken()):(0,mn.of)(null))),this.idTokenResult=this.user.pipe((0,Le.n)(Pe=>Pe?(0,it.H)(Pe.getIdTokenResult()):(0,mn.of)(null))),this.credential=(0,Rt.h)(we,G,this.authState.pipe((0,Gi.p)(Pe=>!Pe))).pipe((0,qe.T)(Pe=>Pe?.user?Pe:null),(0,io._)(u.outsideAngular),(0,Zt.Q)(u.insideAngular))}return((n,t,e,i={})=>new Proxy(n,{get:(o,l)=>e.runOutsideAngular(()=>{if(n[l])return i?.spy?.get&&i.spy.get(l,n[l]),n[l];if(_t.indexOf(l)>-1)return()=>{};const u=t.toPromise().then(h=>{const p=h?.[l];return"function"==typeof p?p.bind(h):p?.then?p.then(v=>e.run(()=>v)):e.run(()=>p)});return new Proxy(()=>{},{get:(h,p)=>u[p],apply:(h,p,v)=>u.then(R=>{const S=R?.(...v);return i?.spy?.apply&&i.spy.apply(l,v,S),S})})})}))(this,le,l,{spy:{apply:(we,xt,Lt)=>{(we.startsWith("signIn")||we.startsWith("createUser"))&&Lt.then(Pe=>G.next(Pe))}}})}static \u0275fac=function(i){return new(i||n)(_.KVO(Sn),_.KVO(gt,8),_.KVO(_.Agw),_.KVO(_.SKi),_.KVO(Fe),_.KVO(so,8),_.KVO(zi,8),_.KVO(dt,8),_.KVO(oo,8),_.KVO(Ga,8),_.KVO(qi,8),_.KVO(St,8))};static \u0275prov=_.jDH({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),za=(()=>{class n{constructor(){O.A.registerVersion("angularfire",oe.full,"auth-compat")}static \u0275fac=function(i){return new(i||n)};static \u0275mod=_.$C({type:n});static \u0275inj=_.G2t({providers:[Qr]})}return n})();var ao=H(97647),Yi=H(31943),co=H(53993),lo=H(39974),Qi=H(54360),qa=H(23294);const Ji="@firebase/database";let Jr="";function gr(n){Jr=n}class fo{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),(0,g.As)(e))}get(t){const e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:(0,g.$L)(e)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}class Ya{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e}get(t){return(0,g.gR)(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}const Xi=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const t=window[n];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new fo(t)}}catch{}return new Ya},vn=Xi("localStorage"),Xr=Xi("sessionStorage"),mr=new Vt.Vy("@firebase/database"),Zi=function(){let n=1;return function(){return n++}}(),Qa=function(n){const t=(0,g.kj)(n),e=new g.gz;e.update(t);const i=e.digest();return g.K3.encodeByteArray(i)},$n=function(...n){let t="";for(let e=0;e<n.length;e++){const i=n[e];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?t+=$n.apply(null,i):t+="object"==typeof i?(0,g.As)(i):i,t+=" "}return t};let kt=null,es=!0;const ts=function(n,t){(0,g.vA)(!t||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(mr.logLevel=Vt.$b.VERBOSE,kt=mr.log.bind(mr),t&&Xr.set("logging_enabled",!0)):"function"==typeof n?kt=n:(kt=null,Xr.remove("logging_enabled"))},Oe=function(...n){if(!0===es&&(es=!1,null===kt&&!0===Xr.get("logging_enabled")&&ts(!0)),kt){const t=$n.apply(null,n);kt(t)}},Kn=function(n){return function(...t){Oe(n,...t)}},Zr=function(...n){const t="FIREBASE INTERNAL ERROR: "+$n(...n);mr.error(t)},Bt=function(...n){const t=`FIREBASE FATAL ERROR: ${$n(...n)}`;throw mr.error(t),new Error(t)},He=function(...n){const t="FIREBASE WARNING: "+$n(...n);mr.warn(t)},vr=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},jt="[MIN_NAME]",$t="[MAX_NAME]",en=function(n,t){if(n===t)return 0;if(n===jt||t===$t)return-1;if(t===jt||n===$t)return 1;{const e=Xa(n),i=Xa(t);return null!==e?null!==i?e-i==0?n.length-t.length:e-i:-1:null!==i?1:n<t?-1:1}},wl=function(n,t){return n===t?0:n<t?-1:1},Gn=function(n,t){if(t&&n in t)return t[n];throw new Error("Missing required key ("+n+") in object: "+(0,g.As)(t))},po=function(n){if("object"!=typeof n||null===n)return(0,g.As)(n);const t=[];for(const i in n)t.push(i);t.sort();let e="{";for(let i=0;i<t.length;i++)0!==i&&(e+=","),e+=(0,g.As)(t[i]),e+=":",e+=po(n[t[i]]);return e+="}",e},ns=function(n,t){const e=n.length;if(e<=t)return[n];const i=[];for(let o=0;o<e;o+=t)i.push(n.substring(o,o+t>e?e:o+t));return i};function Be(n,t){for(const e in n)n.hasOwnProperty(e)&&t(e,n[e])}const Ja=function(n){(0,g.vA)(!vr(n),"Invalid JSON number");const i=1023;let o,l,u,h,p;0===n?(l=0,u=0,o=1/n==-1/0?1:0):(o=n<0,(n=Math.abs(n))>=Math.pow(2,1-i)?(h=Math.min(Math.floor(Math.log(n)/Math.LN2),i),l=h+i,u=Math.round(n*Math.pow(2,52-h)-Math.pow(2,52))):(l=0,u=Math.round(n/Math.pow(2,-1074))));const v=[];for(p=52;p;p-=1)v.push(u%2?1:0),u=Math.floor(u/2);for(p=11;p;p-=1)v.push(l%2?1:0),l=Math.floor(l/2);v.push(o?1:0),v.reverse();const R=v.join("");let S="";for(p=0;p<64;p+=8){let x=parseInt(R.substr(p,8),2).toString(16);1===x.length&&(x="0"+x),S+=x}return S.toLowerCase()},go=new RegExp("^-?(0*)\\d{1,10}$"),Xa=function(n){if(go.test(n)){const t=Number(n);if(t>=-2147483648&&t<=2147483647)return t}return null},yn=function(n){try{n()}catch(t){setTimeout(()=>{throw He("Exception was thrown by user callback.",t.stack||""),t},Math.floor(0))}},zn=function(n,t){const e=setTimeout(n,t);return"number"==typeof e&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(e):"object"==typeof e&&e.unref&&e.unref(),e};class kl{constructor(t,e){this.appCheckProvider=e,this.appName=t.name,(0,$._isFirebaseServerApp)(t)&&t.settings.appCheckToken&&(this.serverAppAppCheckToken=t.settings.appCheckToken),this.appCheck=e?.getImmediate({optional:!0}),this.appCheck||e?.get().then(i=>this.appCheck=i)}getToken(t){if(this.serverAppAppCheckToken){if(t)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(t):new Promise((e,i)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(e,i):e(null)},0)})}addTokenChangeListener(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then(i=>i.addTokenListener(t))}notifyForInvalidToken(){He(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}class vo{constructor(t,e,i){this.appName_=t,this.firebaseOptions_=e,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(o=>this.auth_=o)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(e=>e&&"auth/token-not-initialized"===e.code?(Oe("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((e,i)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(e,i):e(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(e=>e.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(e=>e.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';t+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',He(t)}}let ei=(()=>{class n{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const yo=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Io="websocket",rc="long_polling";class Eo{constructor(t,e,i,o,l=!1,u="",h=!1,p=!1){this.secure=e,this.namespace=i,this.webSocketOnly=o,this.nodeAdmin=l,this.persistenceKey=u,this.includeNamespaceInQueryParams=h,this.isUsingEmulator=p,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=vn.get("host:"+t)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&vn.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function ic(n,t,e){let i;if((0,g.vA)("string"==typeof t,"typeof type must == string"),(0,g.vA)("object"==typeof e,"typeof params must == object"),t===Io)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(t!==rc)throw new Error("Unknown connection type: "+t);i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function Pl(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(e.ns=n.namespace);const o=[];return Be(e,(l,u)=>{o.push(l+"="+u)}),i+o.join("&")}class Nl{constructor(){this.counters_={}}incrementCounter(t,e=1){(0,g.gR)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e}get(){return(0,g.A4)(this.counters_)}}const sc={},oc={};function ac(n){const t=n.toString();return sc[t]||(sc[t]=new Nl),sc[t]}class Ol{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,e){for(this.pendingResponses[t]=e;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let o=0;o<i.length;++o)i[o]&&yn(()=>{this.onMessage_(i[o])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Kt{constructor(t,e,i,o,l,u,h){this.connId=t,this.repoInfo=e,this.applicationId=i,this.appCheckToken=o,this.authToken=l,this.transportSessionId=u,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Kn(t),this.stats_=ac(e),this.urlFn=p=>(this.appCheckToken&&(p.ac=this.appCheckToken),ic(e,rc,p))}open(t,e){this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new Ol(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,g.$g)()||"complete"===document.readyState)n();else{let t=!1;const e=function(){document.body?t||(t=!0,n()):setTimeout(e,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&e()}),window.attachEvent("onload",e))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new bo((...l)=>{const[u,h,p,v,R]=l;if(this.incrementIncomingBytes_(l),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===u)this.id=h,this.password=p;else{if("close"!==u)throw new Error("Unrecognized command received: "+u);h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_()}},(...l)=>{const[u,h]=l;this.incrementIncomingBytes_(l),this.myPacketOrderer.handleResponse(u,h)},()=>{this.onClosed_()},this.urlFn);const i={start:"t"};i.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(i.cb=this.scriptTagHolder.uniqueCallbackIdentifier),i.v="5",this.transportSessionId&&(i.s=this.transportSessionId),this.lastSessionId&&(i.ls=this.lastSessionId),this.applicationId&&(i.p=this.applicationId),this.appCheckToken&&(i.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&yo.test(location.hostname)&&(i.r="f");const o=this.urlFn(i);this.log_("Connecting via long-poll to "+o),this.scriptTagHolder.addTag(o,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Kt.forceAllow_=!0}static forceDisallow(){Kt.forceDisallow_=!0}static isAvailable(){return!((0,g.$g)()||!Kt.forceAllow_&&(Kt.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const e=(0,g.As)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const i=(0,g.KA)(e),o=ns(i,1840);for(let l=0;l<o.length;l++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,o.length,o[l]),this.curSegmentNum++}addDisconnectPingFrame(t,e){if((0,g.$g)())return;this.myDisconnFrame=document.createElement("iframe");const i={dframe:"t"};i.id=t,i.pw=e,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const e=(0,g.As)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)}}class bo{constructor(t,e,i,o){if(this.onDisconnect=i,this.urlFn=o,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,g.$g)())this.commandCB=t,this.onMessageCB=e;else{this.uniqueCallbackIdentifier=Zi(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=e,this.myIFrame=bo.createIFrame_();let l="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(l='<script>document.domain="'+document.domain+'";<\/script>');const u="<html><body>"+l+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(u),this.myIFrame.doc.close()}catch(h){Oe("frame writing exception"),h.stack&&Oe(h.stack),Oe(h)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||Oe("No IE domain setting required")}catch{const i=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;let e=this.urlFn(t),i="",o=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+i.length<=1870;){const u=this.pendingSegs.shift();i=i+"&seg"+o+"="+u.seg+"&ts"+o+"="+u.ts+"&d"+o+"="+u.d,o++}return e+=i,this.addLongPollTag_(e,this.currentSerial),!0}return!1}enqueueSegment(t,e,i){this.pendingSegs.push({seg:t,ts:e,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(t,e){this.outstandingRequests.add(e);const i=()=>{this.outstandingRequests.delete(e),this.newRequest_()},o=setTimeout(i,Math.floor(25e3));this.addTag(t,()=>{clearTimeout(o),i()})}addTag(t,e){(0,g.$g)()?this.doNodeLongPoll(t,e):setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){const o=i.readyState;(!o||"loaded"===o||"complete"===o)&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),e())},i.onerror=()=>{Oe("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}let os=null;typeof MozWebSocket<"u"?os=MozWebSocket:typeof WebSocket<"u"&&(os=WebSocket);let Ir=(()=>{class n{constructor(e,i,o,l,u,h,p){this.connId=e,this.applicationId=o,this.appCheckToken=l,this.authToken=u,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Kn(this.connId),this.stats_=ac(i),this.connURL=n.connectionURL_(i,h,p,l,o),this.nodeAdmin=i.nodeAdmin}static connectionURL_(e,i,o,l,u){const h={v:"5"};return!(0,g.$g)()&&typeof location<"u"&&location.hostname&&yo.test(location.hostname)&&(h.r="f"),i&&(h.s=i),o&&(h.ls=o),l&&(h.ac=l),u&&(h.p=u),ic(e,Io,h)}open(e,i){this.onDisconnect=i,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,vn.set("previous_websocket_failure",!0);try{let o;if((0,g.$g)()){o={headers:{"User-Agent":`Firebase/5/${Jr}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(o.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(o.headers["X-Firebase-AppCheck"]=this.appCheckToken);const u=process.env,h=0===this.connURL.indexOf("wss://")?u.HTTPS_PROXY||u.https_proxy:u.HTTP_PROXY||u.http_proxy;h&&(o.proxy={origin:h})}this.mySock=new os(this.connURL,[],o)}catch(o){this.log_("Error instantiating WebSocket.");const l=o.message||o.data;return l&&this.log_(l),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=o=>{this.handleIncomingFrame(o)},this.mySock.onerror=o=>{this.log_("WebSocket error.  Closing connection.");const l=o.message||o.data;l&&this.log_(l),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const o=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);o&&o.length>1&&parseFloat(o[1])<4.4&&(e=!0)}return!e&&null!==os&&!n.forceDisallow_}static previouslyFailed(){return vn.isInMemoryStorage||!0===vn.get("previous_websocket_failure")}markConnectionHealthy(){vn.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const i=this.frames.join("");this.frames=null;const o=(0,g.$L)(i);this.onMessage(o)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if((0,g.vA)(null===this.frames,"We already have a frame buffer"),e.length<=6){const i=Number(e);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const i=e.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(i);else{const o=this.extractFrameCount_(i);null!==o&&this.appendFrame_(o)}}send(e){this.resetKeepAlive();const i=(0,g.As)(e);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);const o=ns(i,16384);o.length>1&&this.sendString_(String(o.length));for(let l=0;l<o.length;l++)this.sendString_(o[l])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),Wl=(()=>{class n{static get ALL_TRANSPORTS(){return[Kt,Ir]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const i=Ir&&Ir.isAvailable();let o=i&&!Ir.previouslyFailed();if(e.webSocketOnly&&(i||He("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[Ir];else{const l=this.transports_=[];for(const u of n.ALL_TRANSPORTS)u&&u.isAvailable()&&l.push(u);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class Ro{constructor(t,e,i,o,l,u,h,p,v,R){this.id=t,this.repoInfo_=e,this.applicationId_=i,this.appCheckToken_=o,this.authToken_=l,this.onMessage_=u,this.onReady_=h,this.onDisconnect_=p,this.onKill_=v,this.lastSessionId=R,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Kn("c:"+this.id+":"),this.transportManager_=new Wl(e),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(e,i)},Math.floor(0));const o=t.healthyTimeout||0;o>0&&(this.healthyTimeout_=zn(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(o)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return e=>{t===this.conn_?this.onConnectionLost_(e):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return e=>{2!==this.state_&&(t===this.rx_?this.onPrimaryMessageReceived_(e):t===this.secondaryConn_?this.onSecondaryMessageReceived_(e):this.log_("message on old connection"))}}sendRequest(t){this.sendData_({t:"d",d:t})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if("t"in t){const e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const e=Gn("t",t),i=Gn("d",t);if("c"===e)this.onSecondaryControl_(i);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(i)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const e=Gn("t",t),i=Gn("d",t);"c"===e?this.onControl_(i):"d"===e&&this.onDataMessage_(i)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const e=Gn("t",t);if("d"in t){const i=t.d;if("h"===e){const o=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(o.h=this.repoInfo_.host),this.onHandshake_(o)}else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let o=0;o<this.pendingDataMessages.length;++o)this.onDataMessage_(this.pendingDataMessages[o]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(i):"r"===e?this.onReset_(i):"e"===e?Zr("Server Error: "+i):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Zr("Unknown control packet command: "+e)}}onHandshake_(t){const e=t.ts,i=t.v,o=t.h;this.sessionId=t.s,this.repoInfo_.host=o,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==i&&He("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(e,i),zn(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,e){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):zn(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(vn.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class pc{put(t,e,i,o){}merge(t,e,i,o){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,e,i){}onDisconnectMerge(t,e,i){}onDisconnectCancel(t,e){}reportStats(t){}}class ti{constructor(t){this.allowedEvents_=t,this.listeners_={},(0,g.vA)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...e){if(Array.isArray(this.listeners_[t])){const i=[...this.listeners_[t]];for(let o=0;o<i.length;o++)i[o].callback.apply(i[o].context,e)}}on(t,e,i){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:i});const o=this.getInitialEvent(t);o&&e.apply(i,o)}off(t,e,i){this.validateEventType_(t);const o=this.listeners_[t]||[];for(let l=0;l<o.length;l++)if(o[l].callback===e&&(!i||i===o[l].context))return void o.splice(l,1)}validateEventType_(t){(0,g.vA)(this.allowedEvents_.find(e=>e===t),"Unknown event: "+t)}}class ni extends ti{static getInstance(){return new ni}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,g.jZ)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(t){return(0,g.vA)("online"===t,"Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}class pe{constructor(t,e){if(void 0===e){this.pieces_=t.split("/");let i=0;for(let o=0;o<this.pieces_.length;o++)this.pieces_[o].length>0&&(this.pieces_[i]=this.pieces_[o],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}toString(){let t="";for(let e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"}}function de(){return new pe("")}function ie(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Gt(n){return n.pieces_.length-n.pieceNum_}function ye(n){let t=n.pieceNum_;return t<n.pieces_.length&&t++,new pe(n.pieces_,t)}function ii(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function si(n,t=0){return n.pieces_.slice(n.pieceNum_+t)}function gc(n){if(n.pieceNum_>=n.pieces_.length)return null;const t=[];for(let e=n.pieceNum_;e<n.pieces_.length-1;e++)t.push(n.pieces_[e]);return new pe(t,0)}function Re(n,t){const e=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)e.push(n.pieces_[i]);if(t instanceof pe)for(let i=t.pieceNum_;i<t.pieces_.length;i++)e.push(t.pieces_[i]);else{const i=t.split("/");for(let o=0;o<i.length;o++)i[o].length>0&&e.push(i[o])}return new pe(e,0)}function X(n){return n.pieceNum_>=n.pieces_.length}function Ye(n,t){const e=ie(n),i=ie(t);if(null===e)return t;if(e===i)return Ye(ye(n),ye(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+n+")")}function Kl(n,t){const e=si(n,0),i=si(t,0);for(let o=0;o<e.length&&o<i.length;o++){const l=en(e[o],i[o]);if(0!==l)return l}return e.length===i.length?0:e.length<i.length?-1:1}function ko(n,t){if(Gt(n)!==Gt(t))return!1;for(let e=n.pieceNum_,i=t.pieceNum_;e<=n.pieces_.length;e++,i++)if(n.pieces_[e]!==t.pieces_[i])return!1;return!0}function st(n,t){let e=n.pieceNum_,i=t.pieceNum_;if(Gt(n)>Gt(t))return!1;for(;e<n.pieces_.length;){if(n.pieces_[e]!==t.pieces_[i])return!1;++e,++i}return!0}class Gl{constructor(t,e){this.errorPrefix_=e,this.parts_=si(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=(0,g.OE)(this.parts_[i]);mc(this)}}function mc(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Pt(n))}function Pt(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class Po extends ti{static getInstance(){return new Po}constructor(){let t,e;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(e="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(e="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(e="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(e="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,e&&document.addEventListener(e,()=>{const i=!document[t];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}getInitialEvent(t){return(0,g.vA)("visible"===t,"Unknown event type: "+t),[this.visible_]}}const oi=1e3;let Tr,Yn=(()=>{class n extends pc{constructor(e,i,o,l,u,h,p,v){if(super(),this.repoInfo_=e,this.applicationId_=i,this.onDataUpdate_=o,this.onConnectStatus_=l,this.onServerInfoUpdate_=u,this.authTokenProvider_=h,this.appCheckTokenProvider_=p,this.authOverride_=v,this.id=n.nextPersistentConnectionId_++,this.log_=Kn("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=oi,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,v&&!(0,g.$g)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Po.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&ni.getInstance().on("online",this.onOnline_,this)}sendRequest(e,i,o){const l=++this.requestNumber_,u={r:l,a:e,b:i};this.log_((0,g.As)(u)),(0,g.vA)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(u),o&&(this.requestCBHash_[l]=o)}get(e){this.initConnection_();const i=new g.cY,l={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:h=>{const p=h.d;"ok"===h.s?i.resolve(p):i.reject(p)}};return this.outstandingGets_.push(l),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),i.promise}listen(e,i,o,l){this.initConnection_();const u=e._queryIdentifier,h=e._path.toString();this.log_("Listen called for "+h+" "+u),this.listens.has(h)||this.listens.set(h,new Map),(0,g.vA)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,g.vA)(!this.listens.get(h).has(u),"listen() called twice for same path/queryId.");const p={onComplete:l,hashFn:i,query:e,tag:o};this.listens.get(h).set(u,p),this.connected_&&this.sendListen_(p)}sendGet_(e){const i=this.outstandingGets_[e];this.sendRequest("g",i.request,o=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(o)})}sendListen_(e){const i=e.query,o=i._path.toString(),l=i._queryIdentifier;this.log_("Listen on "+o+" for "+l);const u={p:o};e.tag&&(u.q=i._queryObject,u.t=e.tag),u.h=e.hashFn(),this.sendRequest("q",u,p=>{const v=p.d,R=p.s;n.warnOnListenWarnings_(v,i),(this.listens.get(o)&&this.listens.get(o).get(l))===e&&(this.log_("listen response",p),"ok"!==R&&this.removeListen_(o,l),e.onComplete&&e.onComplete(R,v))})}static warnOnListenWarnings_(e,i){if(e&&"object"==typeof e&&(0,g.gR)(e,"w")){const o=(0,g.yw)(e,"w");if(Array.isArray(o)&&~o.indexOf("no_index")){const l='".indexOn": "'+i._queryParams.getIndex().toString()+'"',u=i._path.toString();He(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${l} at ${u} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||(0,g.qc)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,i=(0,g.Cv)(e)?"auth":"gauth",o={cred:e};null===this.authOverride_?o.noauth=!0:"object"==typeof this.authOverride_&&(o.authvar=this.authOverride_),this.sendRequest(i,o,l=>{const u=l.s,h=l.d||"error";this.authToken_===e&&("ok"===u?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(u,h))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const i=e.s,o=e.d||"error";"ok"===i?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,o)})}unlisten(e,i){const o=e._path.toString(),l=e._queryIdentifier;this.log_("Unlisten called for "+o+" "+l),(0,g.vA)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(o,l)&&this.connected_&&this.sendUnlisten_(o,l,e._queryObject,i)}sendUnlisten_(e,i,o,l){this.log_("Unlisten on "+e+" for "+i);const u={p:e};l&&(u.q=o,u.t=l),this.sendRequest("n",u)}onDisconnectPut(e,i,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,i,o):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:i,onComplete:o})}onDisconnectMerge(e,i,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,i,o):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:i,onComplete:o})}onDisconnectCancel(e,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(e,i,o,l){const u={p:i,d:o};this.log_("onDisconnect "+e,u),this.sendRequest(e,u,h=>{l&&setTimeout(()=>{l(h.s,h.d)},Math.floor(0))})}put(e,i,o,l){this.putInternal("p",e,i,o,l)}merge(e,i,o,l){this.putInternal("m",e,i,o,l)}putInternal(e,i,o,l,u){this.initConnection_();const h={p:i,d:o};void 0!==u&&(h.h=u),this.outstandingPuts_.push({action:e,request:h,onComplete:l}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+i)}sendPut_(e){const i=this.outstandingPuts_[e].action,o=this.outstandingPuts_[e].request,l=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(i,o,u=>{this.log_(i+" response",u),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),l&&l(u.s,u.d)})}reportStats(e){if(this.connected_){const i={c:e};this.log_("reportStats",i),this.sendRequest("s",i,o=>{"ok"!==o.s&&this.log_("reportStats","Error sending stats: "+o.d)})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+(0,g.As)(e));const i=e.r,o=this.requestCBHash_[i];o&&(delete this.requestCBHash_[i],o(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,i){this.log_("handleServerMessage",e,i),"d"===e?this.onDataUpdate_(i.p,i.d,!1,i.t):"m"===e?this.onDataUpdate_(i.p,i.d,!0,i.t):"c"===e?this.onListenRevoked_(i.p,i.q):"ac"===e?this.onAuthRevoked_(i.s,i.d):"apc"===e?this.onAppCheckRevoked_(i.s,i.d):"sd"===e?this.onSecurityDebugPacket_(i):Zr("Unrecognized action received from server: "+(0,g.As)(e)+"\nAre you using the latest client?")}onReady_(e,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){(0,g.vA)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=oi,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=oi,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=oi),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=Math.max(0,(new Date).getTime()-this.lastConnectionAttemptTime_);let i=Math.max(0,this.reconnectDelay_-e);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var e=this;return(0,be.A)(function*(){if(e.shouldReconnect_()){e.log_("Making a connection attempt"),e.lastConnectionAttemptTime_=(new Date).getTime(),e.lastConnectionEstablishedTime_=null;const i=e.onDataMessage_.bind(e),o=e.onReady_.bind(e),l=e.onRealtimeDisconnect_.bind(e),u=e.id+":"+n.nextConnectionId_++,h=e.lastSessionId;let p=!1,v=null;const R=function(){v?v.close():(p=!0,l())};e.realtime_={close:R,sendRequest:function(j){(0,g.vA)(v,"sendRequest call when we're not connected not allowed."),v.sendRequest(j)}};const x=e.forceTokenRefresh_;e.forceTokenRefresh_=!1;try{const[j,G]=yield Promise.all([e.authTokenProvider_.getToken(x),e.appCheckTokenProvider_.getToken(x)]);p?Oe("getToken() completed but was canceled"):(Oe("getToken() completed. Creating connection."),e.authToken_=j&&j.accessToken,e.appCheckToken_=G&&G.token,v=new Ro(u,e.repoInfo_,e.applicationId_,e.appCheckToken_,e.authToken_,i,o,l,le=>{He(le+" ("+e.repoInfo_.toString()+")"),e.interrupt("server_kill")},h))}catch(j){e.log_("Failed to get token: "+j),p||(e.repoInfo_.nodeAdmin&&He(j),R())}}})()}interrupt(e){Oe("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Oe("Resuming connection for reason: "+e),delete this.interruptReasons_[e],(0,g.Im)(this.interruptReasons_)&&(this.reconnectDelay_=oi,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const i=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const i=this.outstandingPuts_[e];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,i){let o;o=i?i.map(u=>po(u)).join("$"):"default";const l=this.removeListen_(e,o);l&&l.onComplete&&l.onComplete("permission_denied")}removeListen_(e,i){const o=new pe(e).toString();let l;if(this.listens.has(o)){const u=this.listens.get(o);l=u.get(i),u.delete(i),0===u.size&&this.listens.delete(o)}else l=void 0;return l}onAuthRevoked_(e,i){Oe("Auth token revoked: "+e+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===e||"permission_denied"===e)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,i){Oe("App check token revoked: "+e+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===e||"permission_denied"===e)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const i of e.values())this.sendListen_(i);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let i="js";(0,g.$g)()&&(i=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+i+"."+Jr.replace(/\./g,"-")]=1,(0,g.jZ)()?e["framework.cordova"]=1:(0,g.lV)()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=ni.getInstance().currentlyOnline();return(0,g.Im)(this.interruptReasons_)&&e}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class se{constructor(t,e){this.name=t,this.node=e}static Wrap(t,e){return new se(t,e)}}class Qn{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,e){const i=new se(jt,t),o=new se(jt,e);return 0!==this.compare(i,o)}minPost(){return se.MIN}}class vc extends Qn{static get __EMPTY_NODE(){return Tr}static set __EMPTY_NODE(t){Tr=t}compare(t,e){return en(t.name,e.name)}isDefinedOn(t){throw(0,g.Hk)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,e){return!1}minPost(){return se.MIN}maxPost(){return new se($t,Tr)}makePost(t,e){return(0,g.vA)("string"==typeof t,"KeyIndex indexValue must always be a string."),new se(t,Tr)}toString(){return".key"}}const Et=new vc;class wr{constructor(t,e,i,o,l=null){this.isReverse_=o,this.resultGenerator_=l,this.nodeStack_=[];let u=1;for(;!t.isEmpty();)if(u=e?i(t.key,e):1,o&&(u*=-1),u<0)t=this.isReverse_?t.left:t.right;else{if(0===u){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}let xo,ht=(()=>{class n{constructor(e,i,o,l,u){this.key=e,this.value=i,this.color=o??n.RED,this.left=l??Me.EMPTY_NODE,this.right=u??Me.EMPTY_NODE}copy(e,i,o,l,u){return new n(e??this.key,i??this.value,o??this.color,l??this.left,u??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,i,o){let l=this;const u=o(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,i,o),null):0===u?l.copy(null,i,null,null,null):l.copy(null,null,null,null,l.right.insert(e,i,o)),l.fixUp_()}removeMin_(){if(this.left.isEmpty())return Me.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,i){let o,l;if(o=this,i(e,o.key)<0)!o.left.isEmpty()&&!o.left.isRed_()&&!o.left.left.isRed_()&&(o=o.moveRedLeft_()),o=o.copy(null,null,null,o.left.remove(e,i),null);else{if(o.left.isRed_()&&(o=o.rotateRight_()),!o.right.isEmpty()&&!o.right.isRed_()&&!o.right.left.isRed_()&&(o=o.moveRedRight_()),0===i(e,o.key)){if(o.right.isEmpty())return Me.EMPTY_NODE;l=o.right.min_(),o=o.copy(l.key,l.value,null,null,o.right.removeMin_())}o=o.copy(null,null,null,null,o.right.remove(e,i))}return o.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,i)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class Me{constructor(t,e=Me.EMPTY_NODE){this.comparator_=t,this.root_=e}insert(t,e){return new Me(this.comparator_,this.root_.insert(t,e,this.comparator_).copy(null,null,ht.BLACK,null,null))}remove(t){return new Me(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,ht.BLACK,null,null))}get(t){let e,i=this.root_;for(;!i.isEmpty();){if(e=this.comparator_(t,i.key),0===e)return i.value;e<0?i=i.left:e>0&&(i=i.right)}return null}getPredecessorKey(t){let e,i=this.root_,o=null;for(;!i.isEmpty();){if(e=this.comparator_(t,i.key),0===e){if(i.left.isEmpty())return o?o.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}e<0?i=i.left:e>0&&(o=i,i=i.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new wr(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,e){return new wr(this.root_,t,this.comparator_,!1,e)}getReverseIteratorFrom(t,e){return new wr(this.root_,t,this.comparator_,!0,e)}getReverseIterator(t){return new wr(this.root_,null,this.comparator_,!0,t)}}function Oo(n,t){return en(n.name,t.name)}function Do(n,t){return en(n,t)}Me.EMPTY_NODE=new class ai{copy(t,e,i,o,l){return this}insert(t,e,i){return new ht(t,e,null)}remove(t,e){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const hs=function(n){return"number"==typeof n?"number:"+Ja(n):"string:"+n},Lo=function(n){if(n.isLeafNode()){const t=n.val();(0,g.vA)("string"==typeof t||"number"==typeof t||"object"==typeof t&&(0,g.gR)(t,".sv"),"Priority must be a string or number.")}else(0,g.vA)(n===xo||n.isEmpty(),"priority of unexpected type.");(0,g.vA)(n===xo||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let yc,fs,Ic,Cr=(()=>{class n{static set __childrenNodeConstructor(e){yc=e}static get __childrenNodeConstructor(){return yc}constructor(e,i=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=i,this.lazyHash_=null,(0,g.vA)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),Lo(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new n(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return X(e)?this:".priority"===ie(e)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,i){return null}updateImmediateChild(e,i){return".priority"===e?this.updatePriority(i):i.isEmpty()&&".priority"!==e?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,i).updatePriority(this.priorityNode_)}updateChild(e,i){const o=ie(e);return null===o?i:i.isEmpty()&&".priority"!==o?this:((0,g.vA)(".priority"!==o||1===Gt(e),".priority must be the last token in a path"),this.updateImmediateChild(o,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(ye(e),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,i){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+hs(this.priorityNode_.val())+":");const i=typeof this.value_;e+=i+":",e+="number"===i?Ja(this.value_):this.value_,this.lazyHash_=Qa(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===n.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof n.__childrenNodeConstructor?-1:((0,g.vA)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const i=typeof e.value_,o=typeof this.value_,l=n.VALUE_TYPE_ORDER.indexOf(i),u=n.VALUE_TYPE_ORDER.indexOf(o);return(0,g.vA)(l>=0,"Unknown leaf type: "+i),(0,g.vA)(u>=0,"Unknown leaf type: "+o),l===u?"object"===o?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:u-l}withIndex(){return this}isIndexed(){return!0}equals(e){return e===this||!!e.isLeafNode()&&(this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_))}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const ge=new class Fo extends Qn{compare(t,e){const i=t.node.getPriority(),o=e.node.getPriority(),l=i.compareTo(o);return 0===l?en(t.name,e.name):l}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,e){return!t.getPriority().equals(e.getPriority())}minPost(){return se.MIN}maxPost(){return new se($t,new Cr("[PRIORITY-POST]",Ic))}makePost(t,e){const i=fs(t);return new se(e,new Cr("[PRIORITY-POST]",i))}toString(){return".priority"}},eu=Math.log(2);class ci{constructor(t){this.count=parseInt(Math.log(t+1)/eu,10),this.current_=this.count-1;const o=(()=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=t+1&o}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const ps=function(n,t,e,i){n.sort(t);const o=function(p,v){const R=v-p;let S,x;if(0===R)return null;if(1===R)return S=n[p],x=e?e(S):S,new ht(x,S.node,ht.BLACK,null,null);{const j=parseInt(R/2,10)+p,G=o(p,j),le=o(j+1,v);return S=n[j],x=e?e(S):S,new ht(x,S.node,ht.BLACK,G,le)}},h=function(p){let v=null,R=null,S=n.length;const x=function(G,le){const we=S-G,xt=S;S-=G;const Lt=o(we+1,xt),Pe=n[we],ln=e?e(Pe):Pe;j(new ht(ln,Pe.node,le,null,Lt))},j=function(G){v?(v.left=G,v=G):(R=G,v=G)};for(let G=0;G<p.count;++G){const le=p.nextBitIsOne(),we=Math.pow(2,p.count-(G+1));le?x(we,ht.BLACK):(x(we,ht.BLACK),x(we,ht.RED))}return R}(new ci(n.length));return new Me(i||t,h)};let Uo;const An={};class Nt{static get Default(){return(0,g.vA)(An&&ge,"ChildrenNode.ts has not been loaded"),Uo=Uo||new Nt({".priority":An},{".priority":ge}),Uo}constructor(t,e){this.indexes_=t,this.indexSet_=e}get(t){const e=(0,g.yw)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Me?e:null}hasIndex(t){return(0,g.gR)(this.indexSet_,t.toString())}addIndex(t,e){(0,g.vA)(t!==Et,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let o=!1;const l=e.getIterator(se.Wrap);let h,u=l.getNext();for(;u;)o=o||t.isDefinedOn(u.node),i.push(u),u=l.getNext();h=o?ps(i,t.getCompare()):An;const p=t.toString(),v=Object.assign({},this.indexSet_);v[p]=t;const R=Object.assign({},this.indexes_);return R[p]=h,new Nt(R,v)}addToIndexes(t,e){const i=(0,g.kH)(this.indexes_,(o,l)=>{const u=(0,g.yw)(this.indexSet_,l);if((0,g.vA)(u,"Missing index implementation for "+l),o===An){if(u.isDefinedOn(t.node)){const h=[],p=e.getIterator(se.Wrap);let v=p.getNext();for(;v;)v.name!==t.name&&h.push(v),v=p.getNext();return h.push(t),ps(h,u.getCompare())}return An}{const h=e.get(t.name);let p=o;return h&&(p=p.remove(new se(t.name,h))),p.insert(t,t.node)}});return new Nt(i,this.indexSet_)}removeFromIndexes(t,e){const i=(0,g.kH)(this.indexes_,o=>{if(o===An)return o;{const l=e.get(t.name);return l?o.remove(new se(t.name,l)):o}});return new Nt(i,this.indexSet_)}}let Jn,ee=(()=>{class n{static get EMPTY_NODE(){return Jn||(Jn=new n(new Me(Do),null,Nt.Default))}constructor(e,i,o){this.children_=e,this.priorityNode_=i,this.indexMap_=o,this.lazyHash_=null,this.priorityNode_&&Lo(this.priorityNode_),this.children_.isEmpty()&&(0,g.vA)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Jn}updatePriority(e){return this.children_.isEmpty()?this:new n(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const i=this.children_.get(e);return null===i?Jn:i}}getChild(e){const i=ie(e);return null===i?this:this.getImmediateChild(i).getChild(ye(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,i){if((0,g.vA)(i,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(i);{const o=new se(e,i);let l,u;i.isEmpty()?(l=this.children_.remove(e),u=this.indexMap_.removeFromIndexes(o,this.children_)):(l=this.children_.insert(e,i),u=this.indexMap_.addToIndexes(o,this.children_));const h=l.isEmpty()?Jn:this.priorityNode_;return new n(l,h,u)}}updateChild(e,i){const o=ie(e);if(null===o)return i;{(0,g.vA)(".priority"!==ie(e)||1===Gt(e),".priority must be the last token in a path");const l=this.getImmediateChild(o).updateChild(ye(e),i);return this.updateImmediateChild(o,l)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const i={};let o=0,l=0,u=!0;if(this.forEachChild(ge,(h,p)=>{i[h]=p.val(e),o++,u&&n.INTEGER_REGEXP_.test(h)?l=Math.max(l,Number(h)):u=!1}),!e&&u&&l<2*o){const h=[];for(const p in i)h[p]=i[p];return h}return e&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+hs(this.getPriority().val())+":"),this.forEachChild(ge,(i,o)=>{const l=o.hash();""!==l&&(e+=":"+i+":"+l)}),this.lazyHash_=""===e?"":Qa(e)}return this.lazyHash_}getPredecessorChildName(e,i,o){const l=this.resolveIndex_(o);if(l){const u=l.getPredecessorKey(new se(e,i));return u?u.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const i=this.resolveIndex_(e);if(i){const o=i.minKey();return o&&o.name}return this.children_.minKey()}getFirstChild(e){const i=this.getFirstChildName(e);return i?new se(i,this.children_.get(i)):null}getLastChildName(e){const i=this.resolveIndex_(e);if(i){const o=i.maxKey();return o&&o.name}return this.children_.maxKey()}getLastChild(e){const i=this.getLastChildName(e);return i?new se(i,this.children_.get(i)):null}forEachChild(e,i){const o=this.resolveIndex_(e);return o?o.inorderTraversal(l=>i(l.name,l.node)):this.children_.inorderTraversal(i)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,i){const o=this.resolveIndex_(i);if(o)return o.getIteratorFrom(e,l=>l);{const l=this.children_.getIteratorFrom(e.name,se.Wrap);let u=l.peek();for(;null!=u&&i.compare(u,e)<0;)l.getNext(),u=l.peek();return l}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,i){const o=this.resolveIndex_(i);if(o)return o.getReverseIteratorFrom(e,l=>l);{const l=this.children_.getReverseIteratorFrom(e.name,se.Wrap);let u=l.peek();for(;null!=u&&i.compare(u,e)>0;)l.getNext(),u=l.peek();return l}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===br?-1:0}withIndex(e){if(e===Et||this.indexMap_.hasIndex(e))return this;{const i=this.indexMap_.addIndex(e,this.children_);return new n(this.children_,this.priorityNode_,i)}}isIndexed(e){return e===Et||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const i=e;if(this.getPriority().equals(i.getPriority())){if(this.children_.count()===i.children_.count()){const o=this.getIterator(ge),l=i.getIterator(ge);let u=o.getNext(),h=l.getNext();for(;u&&h;){if(u.name!==h.name||!u.node.equals(h.node))return!1;u=o.getNext(),h=l.getNext()}return null===u&&null===h}return!1}return!1}}resolveIndex_(e){return e===Et?null:this.indexMap_.get(e.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const br=new class Vo extends ee{constructor(){super(new Me(Do),ee.EMPTY_NODE,Nt.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return ee.EMPTY_NODE}isEmpty(){return!1}};function ke(n,t=null){if(null===n)return ee.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(t=n[".priority"]),(0,g.vA)(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new Cr(n,ke(t));if(n instanceof Array){let e=ee.EMPTY_NODE;return Be(n,(i,o)=>{if((0,g.gR)(n,i)&&"."!==i.substring(0,1)){const l=ke(o);(l.isLeafNode()||!l.isEmpty())&&(e=e.updateImmediateChild(i,l))}}),e.updatePriority(ke(t))}{const e=[];let i=!1;if(Be(n,(u,h)=>{if("."!==u.substring(0,1)){const p=ke(h);p.isEmpty()||(i=i||!p.getPriority().isEmpty(),e.push(new se(u,p)))}}),0===e.length)return ee.EMPTY_NODE;const l=ps(e,Oo,u=>u.name,Do);if(i){const u=ps(e,ge.getCompare());return new ee(l,ke(t),new Nt({".priority":u},{".priority":ge}))}return new ee(l,ke(t),Nt.Default)}}Object.defineProperties(se,{MIN:{value:new se(jt,ee.EMPTY_NODE)},MAX:{value:new se($t,br)}}),vc.__EMPTY_NODE=ee.EMPTY_NODE,Cr.__childrenNodeConstructor=ee,function Xl(n){xo=n}(br),function Zl(n){Ic=n}(br),function Mo(n){fs=n}(ke);class Wo extends Qn{constructor(t){super(),this.indexPath_=t,(0,g.vA)(!X(t)&&".priority"!==ie(t),"Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,e){const i=this.extractChild(t.node),o=this.extractChild(e.node),l=i.compareTo(o);return 0===l?en(t.name,e.name):l}makePost(t,e){const i=ke(t),o=ee.EMPTY_NODE.updateChild(this.indexPath_,i);return new se(e,o)}maxPost(){const t=ee.EMPTY_NODE.updateChild(this.indexPath_,br);return new se($t,t)}toString(){return si(this.indexPath_,0).join("/")}}const Bo=new class Ho extends Qn{compare(t,e){const i=t.node.compareTo(e.node);return 0===i?en(t.name,e.name):i}isDefinedOn(t){return!0}indexedValueChanged(t,e){return!t.equals(e)}minPost(){return se.MIN}maxPost(){return se.MAX}makePost(t,e){const i=ke(t);return new se(e,i)}toString(){return".value"}};function Ac(n){return{type:"value",snapshotNode:n}}function Tn(n,t){return{type:"child_added",snapshotNode:t,childName:n}}function li(n,t){return{type:"child_removed",snapshotNode:t,childName:n}}function ui(n,t,e){return{type:"child_changed",snapshotNode:t,childName:n,oldSnap:e}}class $o{constructor(t){this.index_=t}updateChild(t,e,i,o,l,u){(0,g.vA)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const h=t.getImmediateChild(e);return h.getChild(o).equals(i.getChild(o))&&h.isEmpty()===i.isEmpty()||(null!=u&&(i.isEmpty()?t.hasChild(e)?u.trackChildChange(li(e,h)):(0,g.vA)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):h.isEmpty()?u.trackChildChange(Tn(e,i)):u.trackChildChange(ui(e,i,h))),t.isLeafNode()&&i.isEmpty())?t:t.updateImmediateChild(e,i).withIndex(this.index_)}updateFullNode(t,e,i){return null!=i&&(t.isLeafNode()||t.forEachChild(ge,(o,l)=>{e.hasChild(o)||i.trackChildChange(li(o,l))}),e.isLeafNode()||e.forEachChild(ge,(o,l)=>{if(t.hasChild(o)){const u=t.getImmediateChild(o);u.equals(l)||i.trackChildChange(ui(o,l,u))}else i.trackChildChange(Tn(o,l))})),e.withIndex(this.index_)}updatePriority(t,e){return t.isEmpty()?ee.EMPTY_NODE:t.updatePriority(e)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Xn{constructor(t){this.indexedFilter_=new $o(t.getIndex()),this.index_=t.getIndex(),this.startPost_=Xn.getStartPost_(t),this.endPost_=Xn.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const e=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,i=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return e&&i}updateChild(t,e,i,o,l,u){return this.matches(new se(e,i))||(i=ee.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,i,o,l,u)}updateFullNode(t,e,i){e.isLeafNode()&&(e=ee.EMPTY_NODE);let o=e.withIndex(this.index_);o=o.updatePriority(ee.EMPTY_NODE);const l=this;return e.forEachChild(ge,(u,h)=>{l.matches(new se(u,h))||(o=o.updateImmediateChild(u,ee.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,o,i)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()}}class _s{constructor(t){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=e=>{const i=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new Xn(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,e,i,o,l,u){return this.rangedFilter_.matches(new se(e,i))||(i=ee.EMPTY_NODE),t.getImmediateChild(e).equals(i)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,i,o,l,u):this.fullLimitUpdateChild_(t,e,i,l,u)}updateFullNode(t,e,i){let o;if(e.isLeafNode()||e.isEmpty())o=ee.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){let l;o=ee.EMPTY_NODE.withIndex(this.index_),l=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let u=0;for(;l.hasNext()&&u<this.limit_;){const h=l.getNext();if(this.withinDirectionalStart(h)){if(!this.withinDirectionalEnd(h))break;o=o.updateImmediateChild(h.name,h.node),u++}}}else{let l;o=e.withIndex(this.index_),o=o.updatePriority(ee.EMPTY_NODE),l=this.reverse_?o.getReverseIterator(this.index_):o.getIterator(this.index_);let u=0;for(;l.hasNext();){const h=l.getNext();u<this.limit_&&this.withinDirectionalStart(h)&&this.withinDirectionalEnd(h)?u++:o=o.updateImmediateChild(h.name,ee.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,o,i)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,e,i,o,l){let u;if(this.reverse_){const S=this.index_.getCompare();u=(x,j)=>S(j,x)}else u=this.index_.getCompare();const h=t;(0,g.vA)(h.numChildren()===this.limit_,"");const p=new se(e,i),v=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),R=this.rangedFilter_.matches(p);if(h.hasChild(e)){const S=h.getImmediateChild(e);let x=o.getChildAfterChild(this.index_,v,this.reverse_);for(;null!=x&&(x.name===e||h.hasChild(x.name));)x=o.getChildAfterChild(this.index_,x,this.reverse_);const j=null==x?1:u(x,p);if(R&&!i.isEmpty()&&j>=0)return l?.trackChildChange(ui(e,i,S)),h.updateImmediateChild(e,i);{l?.trackChildChange(li(e,S));const le=h.updateImmediateChild(e,ee.EMPTY_NODE);return null!=x&&this.rangedFilter_.matches(x)?(l?.trackChildChange(Tn(x.name,x.node)),le.updateImmediateChild(x.name,x.node)):le}}return i.isEmpty()?t:R&&u(v,p)>=0?(null!=l&&(l.trackChildChange(li(v.name,v.node)),l.trackChildChange(Tn(e,i))),h.updateImmediateChild(e,i).updateImmediateChild(v.name,ee.EMPTY_NODE)):t}}class Sr{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ge}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,g.vA)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,g.vA)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:jt}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,g.vA)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,g.vA)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:$t}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,g.vA)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ge}copy(){const t=new Sr;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function gs(n,t,e){const i=n.copy();return i.startSet_=!0,void 0===t&&(t=null),i.indexStartValue_=t,null!=e?(i.startNameSet_=!0,i.indexStartName_=e):(i.startNameSet_=!1,i.indexStartName_=""),i}function ms(n,t,e){const i=n.copy();return i.endSet_=!0,void 0===t&&(t=null),i.indexEndValue_=t,void 0!==e?(i.endNameSet_=!0,i.indexEndName_=e):(i.endNameSet_=!1,i.indexEndName_=""),i}function di(n,t){const e=n.copy();return e.index_=t,e}function vs(n){const t={};if(n.isDefault())return t;let e;if(n.index_===ge?e="$priority":n.index_===Bo?e="$value":n.index_===Et?e="$key":((0,g.vA)(n.index_ instanceof Wo,"Unrecognized index type!"),e=n.index_.toString()),t.orderBy=(0,g.As)(e),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";t[i]=(0,g.As)(n.indexStartValue_),n.startNameSet_&&(t[i]+=","+(0,g.As)(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";t[i]=(0,g.As)(n.indexEndValue_),n.endNameSet_&&(t[i]+=","+(0,g.As)(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?t.limitToFirst=n.limit_:t.limitToLast=n.limit_),t}function Cc(n){const t={};if(n.startSet_&&(t.sp=n.indexStartValue_,n.startNameSet_&&(t.sn=n.indexStartName_),t.sin=!n.startAfterSet_),n.endSet_&&(t.ep=n.indexEndValue_,n.endNameSet_&&(t.en=n.indexEndName_),t.ein=!n.endBeforeSet_),n.limitSet_){t.l=n.limit_;let e=n.viewFrom_;""===e&&(e=n.isViewFromLeft()?"l":"r"),t.vf=e}return n.index_!==ge&&(t.i=n.index_.toString()),t}class ys extends pc{reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,e){return void 0!==e?"tag$"+e:((0,g.vA)(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}constructor(t,e,i,o){super(),this.repoInfo_=t,this.onDataUpdate_=e,this.authTokenProvider_=i,this.appCheckTokenProvider_=o,this.log_=Kn("p:rest:"),this.listens_={}}listen(t,e,i,o){const l=t._path.toString();this.log_("Listen called for "+l+" "+t._queryIdentifier);const u=ys.getListenId_(t,i),h={};this.listens_[u]=h;const p=vs(t._queryParams);this.restRequest_(l+".json",p,(v,R)=>{let S=R;if(404===v&&(S=null,v=null),null===v&&this.onDataUpdate_(l,S,!1,i),(0,g.yw)(this.listens_,u)===h){let x;x=v?401===v?"permission_denied":"rest_error:"+v:"ok",o(x,null)}})}unlisten(t,e){const i=ys.getListenId_(t,e);delete this.listens_[i]}get(t){const e=vs(t._queryParams),i=t._path.toString(),o=new g.cY;return this.restRequest_(i+".json",e,(l,u)=>{let h=u;404===l&&(h=null,l=null),null===l?(this.onDataUpdate_(i,h,!1,null),o.resolve(h)):o.reject(new Error(h))}),o.promise}refreshAuthToken(t){}restRequest_(t,e={},i){return e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([o,l])=>{o&&o.accessToken&&(e.auth=o.accessToken),l&&l.token&&(e.ac=l.token);const u=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+(0,g.Am)(e);this.log_("Sending REST request for "+u);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(i&&4===h.readyState){this.log_("REST Response for "+u+" received. status:",h.status,"response:",h.responseText);let p=null;if(h.status>=200&&h.status<300){try{p=(0,g.$L)(h.responseText)}catch{He("Failed to parse JSON response for "+u+": "+h.responseText)}i(null,p)}else 401!==h.status&&404!==h.status&&He("Got unsuccessful REST response for "+u+" Status: "+h.status),i(h.status);i=null}},h.open("GET",u,!0),h.send()})}}class ru{constructor(){this.rootNode_=ee.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)}}function Rr(){return{value:null,children:new Map}}function kr(n,t,e){if(X(t))n.value=e,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(t,e);else{const i=ie(t);n.children.has(i)||n.children.set(i,Rr()),kr(n.children.get(i),t=ye(t),e)}}function Go(n,t){if(X(t))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const e=n.value;return n.value=null,e.forEachChild(ge,(i,o)=>{kr(n,new pe(i),o)}),Go(n,t)}}if(n.children.size>0){const e=ie(t);return t=ye(t),n.children.has(e)&&Go(n.children.get(e),t)&&n.children.delete(e),0===n.children.size}return!0}function Is(n,t,e){null!==n.value?e(t,n.value):function iu(n,t){n.children.forEach((e,i)=>{t(i,e)})}(n,(i,o)=>{Is(o,new pe(t.toString()+"/"+i),e)})}class Es{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),e=Object.assign({},t);return this.last_&&Be(this.last_,(i,o)=>{e[i]=e[i]-o}),this.last_=t,e}}class au{constructor(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Es(t);const i=1e4+2e4*Math.random();zn(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const t=this.statsListener_.get(),e={};let i=!1;Be(t,(o,l)=>{l>0&&(0,g.gR)(this.statsToReport_,o)&&(e[o]=l,i=!0)}),i&&this.server_.reportStats(e),zn(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var zt=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(zt||{});function Yo(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class Pr{constructor(t,e,i){this.path=t,this.affectedTree=e,this.revert=i,this.type=zt.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(t){if(X(this.path)){if(null!=this.affectedTree.value)return(0,g.vA)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const e=this.affectedTree.subtree(new pe(t));return new Pr(de(),e,this.revert)}}return(0,g.vA)(ie(this.path)===t,"operationForChild called for unrelated child."),new Pr(ye(this.path),this.affectedTree,this.revert)}}class hi{constructor(t,e){this.source=t,this.path=e,this.type=zt.LISTEN_COMPLETE}operationForChild(t){return X(this.path)?new hi(this.source,de()):new hi(this.source,ye(this.path))}}class Zn{constructor(t,e,i){this.source=t,this.path=e,this.snap=i,this.type=zt.OVERWRITE}operationForChild(t){return X(this.path)?new Zn(this.source,de(),this.snap.getImmediateChild(t)):new Zn(this.source,ye(this.path),this.snap)}}class Nr{constructor(t,e,i){this.source=t,this.path=e,this.children=i,this.type=zt.MERGE}operationForChild(t){if(X(this.path)){const e=this.children.subtree(new pe(t));return e.isEmpty()?null:e.value?new Zn(this.source,de(),e.value):new Nr(this.source,de(),e)}return(0,g.vA)(ie(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new Nr(this.source,ye(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class wn{constructor(t,e,i){this.node_=t,this.fullyInitialized_=e,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(X(t))return this.isFullyInitialized()&&!this.filtered_;const e=ie(t);return this.isCompleteForChild(e)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}class cu{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function fi(n,t,e,i,o,l){const u=i.filter(h=>h.type===e);u.sort((h,p)=>function uu(n,t,e){if(null==t.childName||null==e.childName)throw(0,g.Hk)("Should only compare child_ events.");const i=new se(t.childName,t.snapshotNode),o=new se(e.childName,e.snapshotNode);return n.index_.compare(i,o)}(n,h,p)),u.forEach(h=>{const p=function lu(n,t,e){return"value"===t.type||"child_removed"===t.type||(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,n.index_)),t}(n,h,l);o.forEach(v=>{v.respondsTo(h.type)&&t.push(v.createEvent(p,n.query_))})})}function As(n,t){return{eventCache:n,serverCache:t}}function pi(n,t,e,i){return As(new wn(t,e,i),n.serverCache)}function Ts(n,t,e,i){return As(n.eventCache,new wn(t,e,i))}function Or(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function er(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let _i;class Ie{static fromObject(t){let e=new Ie(null);return Be(t,(i,o)=>{e=e.set(new pe(i),o)}),e}constructor(t,e=(()=>(_i||(_i=new Me(wl)),_i))()){this.value=t,this.children=e}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,e){if(null!=this.value&&e(this.value))return{path:de(),value:this.value};if(X(t))return null;{const i=ie(t),o=this.children.get(i);if(null!==o){const l=o.findRootMostMatchingPathAndValue(ye(t),e);return null!=l?{path:Re(new pe(i),l.path),value:l.value}:null}return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(X(t))return this;{const e=ie(t),i=this.children.get(e);return null!==i?i.subtree(ye(t)):new Ie(null)}}set(t,e){if(X(t))return new Ie(e,this.children);{const i=ie(t),l=(this.children.get(i)||new Ie(null)).set(ye(t),e),u=this.children.insert(i,l);return new Ie(this.value,u)}}remove(t){if(X(t))return this.children.isEmpty()?new Ie(null):new Ie(null,this.children);{const e=ie(t),i=this.children.get(e);if(i){const o=i.remove(ye(t));let l;return l=o.isEmpty()?this.children.remove(e):this.children.insert(e,o),null===this.value&&l.isEmpty()?new Ie(null):new Ie(this.value,l)}return this}}get(t){if(X(t))return this.value;{const e=ie(t),i=this.children.get(e);return i?i.get(ye(t)):null}}setTree(t,e){if(X(t))return e;{const i=ie(t),l=(this.children.get(i)||new Ie(null)).setTree(ye(t),e);let u;return u=l.isEmpty()?this.children.remove(i):this.children.insert(i,l),new Ie(this.value,u)}}fold(t){return this.fold_(de(),t)}fold_(t,e){const i={};return this.children.inorderTraversal((o,l)=>{i[o]=l.fold_(Re(t,o),e)}),e(t,this.value,i)}findOnPath(t,e){return this.findOnPath_(t,de(),e)}findOnPath_(t,e,i){const o=!!this.value&&i(e,this.value);if(o)return o;if(X(t))return null;{const l=ie(t),u=this.children.get(l);return u?u.findOnPath_(ye(t),Re(e,l),i):null}}foreachOnPath(t,e){return this.foreachOnPath_(t,de(),e)}foreachOnPath_(t,e,i){if(X(t))return this;{this.value&&i(e,this.value);const o=ie(t),l=this.children.get(o);return l?l.foreachOnPath_(ye(t),Re(e,o),i):new Ie(null)}}foreach(t){this.foreach_(de(),t)}foreach_(t,e){this.children.inorderTraversal((i,o)=>{o.foreach_(Re(t,i),e)}),this.value&&e(t,this.value)}foreachChild(t){this.children.inorderTraversal((e,i)=>{i.value&&t(e,i.value)})}}class At{constructor(t){this.writeTree_=t}static empty(){return new At(new Ie(null))}}function tr(n,t,e){if(X(t))return new At(new Ie(e));{const i=n.writeTree_.findRootMostValueAndPath(t);if(null!=i){const o=i.path;let l=i.value;const u=Ye(o,t);return l=l.updateChild(u,e),new At(n.writeTree_.set(o,l))}{const o=new Ie(e),l=n.writeTree_.setTree(t,o);return new At(l)}}}function Qo(n,t,e){let i=n;return Be(e,(o,l)=>{i=tr(i,Re(t,o),l)}),i}function hu(n,t){if(X(t))return At.empty();{const e=n.writeTree_.setTree(t,new Ie(null));return new At(e)}}function gi(n,t){return null!=Cn(n,t)}function Cn(n,t){const e=n.writeTree_.findRootMostValueAndPath(t);return null!=e?n.writeTree_.get(e.path).getChild(Ye(e.path,t)):null}function mi(n){const t=[],e=n.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(ge,(i,o)=>{t.push(new se(i,o))}):n.writeTree_.children.inorderTraversal((i,o)=>{null!=o.value&&t.push(new se(i,o.value))}),t}function tn(n,t){if(X(t))return n;{const e=Cn(n,t);return new At(null!=e?new Ie(e):n.writeTree_.subtree(t))}}function ws(n){return n.writeTree_.isEmpty()}function Dr(n,t){return Rc(de(),n.writeTree_,t)}function Rc(n,t,e){if(null!=t.value)return e.updateChild(n,t.value);{let i=null;return t.children.inorderTraversal((o,l)=>{".priority"===o?((0,g.vA)(null!==l.value,"Priority writes must always be leaf nodes"),i=l.value):e=Rc(Re(n,o),l,e)}),!e.getChild(n).isEmpty()&&null!==i&&(e=e.updateChild(Re(n,".priority"),i)),e}}function Cs(n,t){return Dc(t,n)}function ld(n,t){if(n.snap)return st(n.path,t);for(const e in n.children)if(n.children.hasOwnProperty(e)&&st(Re(n.path,e),t))return!0;return!1}function nr(n){return n.visible}function Pc(n,t,e){let i=At.empty();for(let o=0;o<n.length;++o){const l=n[o];if(t(l)){const u=l.path;let h;if(l.snap)st(e,u)?(h=Ye(e,u),i=tr(i,h,l.snap)):st(u,e)&&(h=Ye(u,e),i=tr(i,de(),l.snap.getChild(h)));else{if(!l.children)throw(0,g.Hk)("WriteRecord should have .snap or .children");if(st(e,u))h=Ye(e,u),i=Qo(i,h,l.children);else if(st(u,e))if(h=Ye(u,e),X(h))i=Qo(i,de(),l.children);else{const p=(0,g.yw)(l.children,ie(h));if(p){const v=p.getChild(ye(h));i=tr(i,de(),v)}}}}}return i}function Nc(n,t,e,i,o){if(i||o){const l=tn(n.visibleWrites,t);return!o&&ws(l)?e:o||null!=e||gi(l,de())?Dr(Pc(n.allWrites,function(v){return(v.visible||o)&&(!i||!~i.indexOf(v.writeId))&&(st(v.path,t)||st(t,v.path))},t),e||ee.EMPTY_NODE):null}{const l=Cn(n.visibleWrites,t);if(null!=l)return l;{const u=tn(n.visibleWrites,t);return ws(u)?e:null!=e||gi(u,de())?Dr(u,e||ee.EMPTY_NODE):null}}}function bs(n,t,e,i){return Nc(n.writeTree,n.treePath,t,e,i)}function ea(n,t){return function Jo(n,t,e){let i=ee.EMPTY_NODE;const o=Cn(n.visibleWrites,t);if(o)return o.isLeafNode()||o.forEachChild(ge,(l,u)=>{i=i.updateImmediateChild(l,u)}),i;if(e){const l=tn(n.visibleWrites,t);return e.forEachChild(ge,(u,h)=>{const p=Dr(tn(l,new pe(u)),h);i=i.updateImmediateChild(u,p)}),mi(l).forEach(u=>{i=i.updateImmediateChild(u.name,u.node)}),i}return mi(tn(n.visibleWrites,t)).forEach(u=>{i=i.updateImmediateChild(u.name,u.node)}),i}(n.writeTree,n.treePath,t)}function Ss(n,t,e,i){return function mu(n,t,e,i,o){(0,g.vA)(i||o,"Either existingEventSnap or existingServerSnap must exist");const l=Re(t,e);if(gi(n.visibleWrites,l))return null;{const u=tn(n.visibleWrites,l);return ws(u)?o.getChild(e):Dr(u,o.getChild(e))}}(n.writeTree,n.treePath,t,e,i)}function Rs(n,t){return function vu(n,t){return Cn(n.visibleWrites,t)}(n.writeTree,Re(n.treePath,t))}function ta(n,t,e){return function Xo(n,t,e,i){const o=Re(t,e),l=Cn(n.visibleWrites,o);return null!=l?l:i.isCompleteForChild(e)?Dr(tn(n.visibleWrites,o),i.getNode().getImmediateChild(e)):null}(n.writeTree,n.treePath,t,e)}function Oc(n,t){return Dc(Re(n.treePath,t),n.writeTree)}function Dc(n,t){return{treePath:n,writeTree:t}}class xc{constructor(){this.changeMap=new Map}trackChildChange(t){const e=t.type,i=t.childName;(0,g.vA)("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),(0,g.vA)(".priority"!==i,"Only non-priority child changes can be tracked.");const o=this.changeMap.get(i);if(o){const l=o.type;if("child_added"===e&&"child_removed"===l)this.changeMap.set(i,ui(i,t.snapshotNode,o.snapshotNode));else if("child_removed"===e&&"child_added"===l)this.changeMap.delete(i);else if("child_removed"===e&&"child_changed"===l)this.changeMap.set(i,li(i,o.oldSnap));else if("child_changed"===e&&"child_added"===l)this.changeMap.set(i,Tn(i,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==l)throw(0,g.Hk)("Illegal combination of changes: "+t+" occurred after "+o);this.changeMap.set(i,ui(i,t.snapshotNode,o.oldSnap))}}else this.changeMap.set(i,t)}getChanges(){return Array.from(this.changeMap.values())}}const Lc=new class na{getCompleteChild(t){return null}getChildAfterChild(t,e,i){return null}};class ra{constructor(t,e,i=null){this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=i}getCompleteChild(t){const e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);{const i=null!=this.optCompleteServerCache_?new wn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ta(this.writes_,t,i)}}getChildAfterChild(t,e,i){const o=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:er(this.viewCache_),l=function Iu(n,t,e,i,o,l){return function yu(n,t,e,i,o,l,u){let h;const p=tn(n.visibleWrites,t),v=Cn(p,de());if(null!=v)h=v;else{if(null==e)return[];h=Dr(p,e)}if(h=h.withIndex(u),h.isEmpty()||h.isLeafNode())return[];{const R=[],S=u.getCompare(),x=l?h.getReverseIteratorFrom(i,u):h.getIteratorFrom(i,u);let j=x.getNext();for(;j&&R.length<o;)0!==S(j,i)&&R.push(j),j=x.getNext();return R}}(n.writeTree,n.treePath,t,e,i,o,l)}(this.writes_,o,e,1,i,t);return 0===l.length?null:l[0]}}function vi(n,t,e,i,o,l){const u=t.eventCache;if(null!=Rs(i,e))return t;{let h,p;if(X(e))if((0,g.vA)(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const v=er(t),S=ea(i,v instanceof ee?v:ee.EMPTY_NODE);h=n.filter.updateFullNode(t.eventCache.getNode(),S,l)}else{const v=bs(i,er(t));h=n.filter.updateFullNode(t.eventCache.getNode(),v,l)}else{const v=ie(e);if(".priority"===v){(0,g.vA)(1===Gt(e),"Can't have a priority with additional path components");const R=u.getNode();p=t.serverCache.getNode();const S=Ss(i,e,R,p);h=null!=S?n.filter.updatePriority(R,S):u.getNode()}else{const R=ye(e);let S;if(u.isCompleteForChild(v)){p=t.serverCache.getNode();const x=Ss(i,e,u.getNode(),p);S=null!=x?u.getNode().getImmediateChild(v).updateChild(R,x):u.getNode().getImmediateChild(v)}else S=ta(i,v,t.serverCache);h=null!=S?n.filter.updateChild(u.getNode(),v,S,R,o,l):u.getNode()}}return pi(t,h,u.isFullyInitialized()||X(e),n.filter.filtersNodes())}}function ks(n,t,e,i,o,l,u,h){const p=t.serverCache;let v;const R=u?n.filter:n.filter.getIndexedFilter();if(X(e))v=R.updateFullNode(p.getNode(),i,null);else if(R.filtersNodes()&&!p.isFiltered()){const j=p.getNode().updateChild(e,i);v=R.updateFullNode(p.getNode(),j,null)}else{const j=ie(e);if(!p.isCompleteForPath(e)&&Gt(e)>1)return t;const G=ye(e),we=p.getNode().getImmediateChild(j).updateChild(G,i);v=".priority"===j?R.updatePriority(p.getNode(),we):R.updateChild(p.getNode(),j,we,G,Lc,null)}const S=Ts(t,v,p.isFullyInitialized()||X(e),R.filtersNodes());return vi(n,S,e,o,new ra(o,S,l),h)}function oa(n,t,e,i,o,l,u){const h=t.eventCache;let p,v;const R=new ra(o,t,l);if(X(e))v=n.filter.updateFullNode(t.eventCache.getNode(),i,u),p=pi(t,v,!0,n.filter.filtersNodes());else{const S=ie(e);if(".priority"===S)v=n.filter.updatePriority(t.eventCache.getNode(),i),p=pi(t,v,h.isFullyInitialized(),h.isFiltered());else{const x=ye(e),j=h.getNode().getImmediateChild(S);let G;if(X(x))G=i;else{const le=R.getCompleteChild(S);G=null!=le?".priority"===ii(x)&&le.getChild(gc(x)).isEmpty()?le:le.updateChild(x,i):ee.EMPTY_NODE}p=j.equals(G)?t:pi(t,n.filter.updateChild(h.getNode(),S,G,x,R,u),h.isFullyInitialized(),n.filter.filtersNodes())}}return p}function Mc(n,t){return n.eventCache.isCompleteForChild(t)}function Uc(n,t,e){return e.foreach((i,o)=>{t=t.updateChild(i,o)}),t}function aa(n,t,e,i,o,l,u,h){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let v,p=t;v=X(e)?i:new Ie(null).setTree(e,i);const R=t.serverCache.getNode();return v.children.inorderTraversal((S,x)=>{if(R.hasChild(S)){const G=Uc(0,t.serverCache.getNode().getImmediateChild(S),x);p=ks(n,p,new pe(S),G,o,l,u,h)}}),v.children.inorderTraversal((S,x)=>{const j=!t.serverCache.isCompleteForChild(S)&&null===x.value;if(!R.hasChild(S)&&!j){const le=Uc(0,t.serverCache.getNode().getImmediateChild(S),x);p=ks(n,p,new pe(S),le,o,l,u,h)}}),p}class Cu{constructor(t,e){this.query_=t,this.eventRegistrations_=[];const i=this.query_._queryParams,o=new $o(i.getIndex()),l=function Tc(n){return n.loadsAllData()?new $o(n.getIndex()):n.hasLimit()?new _s(n):new Xn(n)}(i);this.processor_=function ia(n){return{filter:n}}(l);const u=e.serverCache,h=e.eventCache,p=o.updateFullNode(ee.EMPTY_NODE,u.getNode(),null),v=l.updateFullNode(ee.EMPTY_NODE,h.getNode(),null),R=new wn(p,u.isFullyInitialized(),o.filtersNodes()),S=new wn(v,h.isFullyInitialized(),l.filtersNodes());this.viewCache_=As(S,R),this.eventGenerator_=new cu(this.query_)}get query(){return this.query_}}function Su(n,t){const e=er(n.viewCache_);return e&&(n.query._queryParams.loadsAllData()||!X(t)&&!e.getImmediateChild(ie(t)).isEmpty())?e.getChild(t):null}function Wc(n){return 0===n.eventRegistrations_.length}function ca(n,t,e){const i=[];if(e){(0,g.vA)(null==t,"A cancel should cancel all event registrations.");const o=n.query._path;n.eventRegistrations_.forEach(l=>{const u=l.createCancelEvent(e,o);u&&i.push(u)})}if(t){let o=[];for(let l=0;l<n.eventRegistrations_.length;++l){const u=n.eventRegistrations_[l];if(u.matches(t)){if(t.hasAnyCallback()){o=o.concat(n.eventRegistrations_.slice(l+1));break}}else o.push(u)}n.eventRegistrations_=o}else n.eventRegistrations_=[];return i}function Ps(n,t,e,i){t.type===zt.MERGE&&null!==t.source.queryId&&((0,g.vA)(er(n.viewCache_),"We should always have a full cache before handling merges"),(0,g.vA)(Or(n.viewCache_),"Missing event cache, even though we have a server cache"));const o=n.viewCache_,l=function Eu(n,t,e,i,o){const l=new xc;let u,h;if(e.type===zt.OVERWRITE){const v=e;v.source.fromUser?u=oa(n,t,v.path,v.snap,i,o,l):((0,g.vA)(v.source.fromServer,"Unknown source."),h=v.source.tagged||t.serverCache.isFiltered()&&!X(v.path),u=ks(n,t,v.path,v.snap,i,o,h,l))}else if(e.type===zt.MERGE){const v=e;v.source.fromUser?u=function Fc(n,t,e,i,o,l,u){let h=t;return i.foreach((p,v)=>{const R=Re(e,p);Mc(t,ie(R))&&(h=oa(n,h,R,v,o,l,u))}),i.foreach((p,v)=>{const R=Re(e,p);Mc(t,ie(R))||(h=oa(n,h,R,v,o,l,u))}),h}(n,t,v.path,v.children,i,o,l):((0,g.vA)(v.source.fromServer,"Unknown source."),h=v.source.tagged||t.serverCache.isFiltered(),u=aa(n,t,v.path,v.children,i,o,h,l))}else if(e.type===zt.ACK_USER_WRITE){const v=e;u=v.revert?function yi(n,t,e,i,o,l){let u;if(null!=Rs(i,e))return t;{const h=new ra(i,t,o),p=t.eventCache.getNode();let v;if(X(e)||".priority"===ie(e)){let R;if(t.serverCache.isFullyInitialized())R=bs(i,er(t));else{const S=t.serverCache.getNode();(0,g.vA)(S instanceof ee,"serverChildren would be complete if leaf node"),R=ea(i,S)}v=n.filter.updateFullNode(p,R,l)}else{const R=ie(e);let S=ta(i,R,t.serverCache);null==S&&t.serverCache.isCompleteForChild(R)&&(S=p.getImmediateChild(R)),v=null!=S?n.filter.updateChild(p,R,S,ye(e),h,l):t.eventCache.getNode().hasChild(R)?n.filter.updateChild(p,R,ee.EMPTY_NODE,ye(e),h,l):p,v.isEmpty()&&t.serverCache.isFullyInitialized()&&(u=bs(i,er(t)),u.isLeafNode()&&(v=n.filter.updateFullNode(v,u,l)))}return u=t.serverCache.isFullyInitialized()||null!=Rs(i,de()),pi(t,v,u,n.filter.filtersNodes())}}(n,t,v.path,i,o,l):function Tu(n,t,e,i,o,l,u){if(null!=Rs(o,e))return t;const h=t.serverCache.isFiltered(),p=t.serverCache;if(null!=i.value){if(X(e)&&p.isFullyInitialized()||p.isCompleteForPath(e))return ks(n,t,e,p.getNode().getChild(e),o,l,h,u);if(X(e)){let v=new Ie(null);return p.getNode().forEachChild(Et,(R,S)=>{v=v.set(new pe(R),S)}),aa(n,t,e,v,o,l,h,u)}return t}{let v=new Ie(null);return i.foreach((R,S)=>{const x=Re(e,R);p.isCompleteForPath(x)&&(v=v.set(R,p.getNode().getChild(x)))}),aa(n,t,e,v,o,l,h,u)}}(n,t,v.path,v.affectedTree,i,o,l)}else{if(e.type!==zt.LISTEN_COMPLETE)throw(0,g.Hk)("Unknown operation type: "+e.type);u=function wu(n,t,e,i,o){const l=t.serverCache;return vi(n,Ts(t,l.getNode(),l.isFullyInitialized()||X(e),l.isFiltered()),e,i,Lc,o)}(n,t,e.path,i,l)}const p=l.getChanges();return function Au(n,t,e){const i=t.eventCache;if(i.isFullyInitialized()){const o=i.getNode().isLeafNode()||i.getNode().isEmpty(),l=Or(n);(e.length>0||!n.eventCache.isFullyInitialized()||o&&!i.getNode().equals(l)||!i.getNode().getPriority().equals(l.getPriority()))&&e.push(Ac(Or(t)))}}(t,u,p),{viewCache:u,changes:p}}(n.processor_,o,t,e,i);return function sa(n,t){(0,g.vA)(t.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,g.vA)(t.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,l.viewCache),(0,g.vA)(l.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=l.viewCache,ua(n,l.changes,l.viewCache.eventCache.getNode(),null)}function ua(n,t,e,i){return function Sc(n,t,e,i){const o=[],l=[];return t.forEach(u=>{"child_changed"===u.type&&n.index_.indexedValueChanged(u.oldSnap,u.snapshotNode)&&l.push(function jo(n,t){return{type:"child_moved",snapshotNode:t,childName:n}}(u.childName,u.snapshotNode))}),fi(n,o,"child_removed",t,i,e),fi(n,o,"child_added",t,i,e),fi(n,o,"child_moved",l,i,e),fi(n,o,"child_changed",t,i,e),fi(n,o,"value",t,i,e),o}(n.eventGenerator_,t,e,i?[i]:n.eventRegistrations_)}let Ns,Ls;class Os{constructor(){this.views=new Map}}function Ds(n,t,e,i){const o=t.source.queryId;if(null!==o){const l=n.views.get(o);return(0,g.vA)(null!=l,"SyncTree gave us an op for an invalid query."),Ps(l,t,e,i)}{let l=[];for(const u of n.views.values())l=l.concat(Ps(u,t,e,i));return l}}function Hc(n,t,e,i,o){const u=n.views.get(t._queryIdentifier);if(!u){let h=bs(e,o?i:null),p=!1;h?p=!0:i instanceof ee?(h=ea(e,i),p=!1):(h=ee.EMPTY_NODE,p=!1);const v=As(new wn(h,p,!1),new wn(i,o,!1));return new Cu(t,v)}return u}function Bc(n){const t=[];for(const e of n.views.values())e.query._queryParams.loadsAllData()||t.push(e);return t}function nn(n,t){let e=null;for(const i of n.views.values())e=e||Su(i,t);return e}function jc(n,t){return t._queryParams.loadsAllData()?xs(n):n.views.get(t._queryIdentifier)}function rn(n,t){return null!=jc(n,t)}function sn(n){return null!=xs(n)}function xs(n){for(const t of n.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let ot=1;class Ms{constructor(t){this.listenProvider_=t,this.syncPointTree_=new Ie(null),this.pendingWriteTree_=function Zo(){return{visibleWrites:At.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Ei(n,t,e,i,o){return function fu(n,t,e,i,o){(0,g.vA)(i>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===o&&(o=!0),n.allWrites.push({path:t,snap:e,writeId:i,visible:o}),o&&(n.visibleWrites=tr(n.visibleWrites,t,e)),n.lastWriteId=i}(n.pendingWriteTree_,t,e,i,o),o?r(n,new Zn({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,e)):[]}function Qe(n,t,e=!1){const i=function kc(n,t){for(let e=0;e<n.allWrites.length;e++){const i=n.allWrites[e];if(i.writeId===t)return i}return null}(n.pendingWriteTree_,t);if(function _u(n,t){const e=n.allWrites.findIndex(h=>h.writeId===t);(0,g.vA)(e>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[e];n.allWrites.splice(e,1);let o=i.visible,l=!1,u=n.allWrites.length-1;for(;o&&u>=0;){const h=n.allWrites[u];h.visible&&(u>=e&&ld(h,i.path)?o=!1:st(i.path,h.path)&&(l=!0)),u--}return!!o&&(l?(function gu(n){n.visibleWrites=Pc(n.allWrites,nr,de()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(i.snap?n.visibleWrites=hu(n.visibleWrites,i.path):Be(i.children,p=>{n.visibleWrites=hu(n.visibleWrites,Re(i.path,p))}),!0))}(n.pendingWriteTree_,t)){let l=new Ie(null);return null!=i.snap?l=l.set(de(),!0):Be(i.children,u=>{l=l.set(new pe(u),!0)}),r(n,new Pr(i.path,l,e))}return[]}function on(n,t,e){return r(n,new Zn({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,e))}function xr(n,t,e,i,o=!1){const l=t._path,u=n.syncPointTree_.get(l);let h=[];if(u&&("default"===t._queryIdentifier||rn(u,t))){const p=function ha(n,t,e,i){const o=t._queryIdentifier,l=[];let u=[];const h=sn(n);if("default"===o)for(const[p,v]of n.views.entries())u=u.concat(ca(v,e,i)),Wc(v)&&(n.views.delete(p),v.query._queryParams.loadsAllData()||l.push(v.query));else{const p=n.views.get(o);p&&(u=u.concat(ca(p,e,i)),Wc(p)&&(n.views.delete(o),p.query._queryParams.loadsAllData()||l.push(p.query)))}return h&&!sn(n)&&l.push(new(function ft(){return(0,g.vA)(Ns,"Reference.ts has not been loaded"),Ns}())(t._repo,t._path)),{removed:l,events:u}}(u,t,e,i);(function Ii(n){return 0===n.views.size})(u)&&(n.syncPointTree_=n.syncPointTree_.remove(l));const v=p.removed;if(h=p.events,!o){const R=-1!==v.findIndex(x=>x._queryParams.loadsAllData()),S=n.syncPointTree_.findOnPath(l,(x,j)=>sn(j));if(R&&!S){const x=n.syncPointTree_.subtree(l);if(!x.isEmpty()){const j=function W(n){return n.fold((t,e,i)=>{if(e&&sn(e))return[xs(e)];{let o=[];return e&&(o=Bc(e)),Be(i,(l,u)=>{o=o.concat(u)}),o}})}(x);for(let G=0;G<j.length;++G){const le=j[G],we=le.query,xt=d(n,le);n.listenProvider_.startListening(F(we),f(n,we),xt.hashFn,xt.onComplete)}}}!S&&v.length>0&&!i&&(R?n.listenProvider_.stopListening(F(t),null):v.forEach(x=>{const j=n.queryToTagMap.get(y(x));n.listenProvider_.stopListening(F(x),j)}))}!function ce(n,t){for(let e=0;e<t.length;++e){const i=t[e];if(!i._queryParams.loadsAllData()){const o=y(i),l=n.queryToTagMap.get(o);n.queryToTagMap.delete(o),n.tagToQueryMap.delete(l)}}}(n,v)}return h}function zc(n,t,e,i){const o=A(n,i);if(null!=o){const l=k(o),u=l.path,h=l.queryId,p=Ye(u,t);return M(n,u,new Zn(Yo(h),p,e))}return[]}function fa(n,t,e,i=!1){const o=t._path;let l=null,u=!1;n.syncPointTree_.foreachOnPath(o,(x,j)=>{const G=Ye(x,o);l=l||nn(j,G),u=u||sn(j)});let p,h=n.syncPointTree_.get(o);h?(u=u||sn(h),l=l||nn(h,de())):(h=new Os,n.syncPointTree_=n.syncPointTree_.set(o,h)),null!=l?p=!0:(p=!1,l=ee.EMPTY_NODE,n.syncPointTree_.subtree(o).foreachChild((j,G)=>{const le=nn(G,de());le&&(l=l.updateImmediateChild(j,le))}));const v=rn(h,t);if(!v&&!t._queryParams.loadsAllData()){const x=y(t);(0,g.vA)(!n.queryToTagMap.has(x),"View does not exist, but we have a tag");const j=function Ve(){return ot++}();n.queryToTagMap.set(x,j),n.tagToQueryMap.set(j,x)}let S=function da(n,t,e,i,o,l){const u=Hc(n,t,i,o,l);return n.views.has(t._queryIdentifier)||n.views.set(t._queryIdentifier,u),function Ru(n,t){n.eventRegistrations_.push(t)}(u,e),function la(n,t){const e=n.viewCache_.eventCache,i=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(ge,(l,u)=>{i.push(Tn(l,u))}),e.isFullyInitialized()&&i.push(Ac(e.getNode())),ua(n,i,e.getNode(),t)}(u,e)}(h,t,e,Cs(n.pendingWriteTree_,o),l,p);if(!v&&!u&&!i){const x=jc(h,t);S=S.concat(function rr(n,t,e){const i=t._path,o=f(n,t),l=d(n,e),u=n.listenProvider_.startListening(F(t),o,l.hashFn,l.onComplete),h=n.syncPointTree_.subtree(i);if(o)(0,g.vA)(!sn(h.value),"If we're adding a query, it shouldn't be shadowed");else{const p=h.fold((v,R,S)=>{if(!X(v)&&R&&sn(R))return[xs(R).query];{let x=[];return R&&(x=x.concat(Bc(R).map(j=>j.query))),Be(S,(j,G)=>{x=x.concat(G)}),x}});for(let v=0;v<p.length;++v){const R=p[v];n.listenProvider_.stopListening(F(R),f(n,R))}}return u}(n,t,x))}return S}function Fs(n,t,e){const o=n.pendingWriteTree_,l=n.syncPointTree_.findOnPath(t,(u,h)=>{const v=nn(h,Ye(u,t));if(v)return v});return Nc(o,t,l,e,!0)}function r(n,t){return s(t,n.syncPointTree_,null,Cs(n.pendingWriteTree_,de()))}function s(n,t,e,i){if(X(n.path))return c(n,t,e,i);{const o=t.get(de());null==e&&null!=o&&(e=nn(o,de()));let l=[];const u=ie(n.path),h=n.operationForChild(u),p=t.children.get(u);if(p&&h){const v=e?e.getImmediateChild(u):null,R=Oc(i,u);l=l.concat(s(h,p,v,R))}return o&&(l=l.concat(Ds(o,n,i,e))),l}}function c(n,t,e,i){const o=t.get(de());null==e&&null!=o&&(e=nn(o,de()));let l=[];return t.children.inorderTraversal((u,h)=>{const p=e?e.getImmediateChild(u):null,v=Oc(i,u),R=n.operationForChild(u);R&&(l=l.concat(c(R,h,p,v)))}),o&&(l=l.concat(Ds(o,n,i,e))),l}function d(n,t){const e=t.query,i=f(n,e);return{hashFn:()=>(function Vc(n){return n.viewCache_.serverCache.getNode()}(t)||ee.EMPTY_NODE).hash(),onComplete:o=>{if("ok"===o)return i?function Ou(n,t,e){const i=A(n,e);if(i){const o=k(i),l=o.path,u=o.queryId,h=Ye(l,t);return M(n,l,new hi(Yo(u),h))}return[]}(n,e._path,i):function Gc(n,t){return r(n,new hi({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(n,e._path);{const l=function bl(n,t){let e="Unknown Error";"too_big"===n?e="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?e="Client doesn't have permission to access the desired data.":"unavailable"===n&&(e="The service is unavailable");const i=new Error(n+" at "+t._path.toString()+": "+e);return i.code=n.toUpperCase(),i}(o,e);return xr(n,e,null,l)}}}}function f(n,t){const e=y(t);return n.queryToTagMap.get(e)}function y(n){return n._path.toString()+"$"+n._queryIdentifier}function A(n,t){return n.tagToQueryMap.get(t)}function k(n){const t=n.indexOf("$");return(0,g.vA)(-1!==t&&t<n.length-1,"Bad queryKey."),{queryId:n.substr(t+1),path:new pe(n.substr(0,t))}}function M(n,t,e){const i=n.syncPointTree_.get(t);return(0,g.vA)(i,"Missing sync point for query tag that we're tracking"),Ds(i,e,Cs(n.pendingWriteTree_,t),null)}function F(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function $c(){return(0,g.vA)(Ls,"Reference.ts has not been loaded"),Ls}())(n._repo,n._path):n}class Us{constructor(t){this.node_=t}getImmediateChild(t){const e=this.node_.getImmediateChild(t);return new Us(e)}node(){return this.node_}}class Ai{constructor(t,e){this.syncTree_=t,this.path_=e}getImmediateChild(t){const e=Re(this.path_,t);return new Ai(this.syncTree_,e)}node(){return Fs(this.syncTree_,this.path_)}}const pa=function(n,t,e){return n&&"object"==typeof n?((0,g.vA)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?_a(n[".sv"],t,e):"object"==typeof n[".sv"]?Yc(n[".sv"],t):void(0,g.vA)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},_a=function(n,t,e){if("timestamp"===n)return e.timestamp;(0,g.vA)(!1,"Unexpected server value: "+n)},Yc=function(n,t,e){n.hasOwnProperty("increment")||(0,g.vA)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;"number"!=typeof i&&(0,g.vA)(!1,"Unexpected increment value: "+i);const o=t.node();if((0,g.vA)(null!==o&&typeof o<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!o.isLeafNode())return i;const u=o.getValue();return"number"!=typeof u?i:u+i},ga=function(n,t,e,i){return Vs(t,new Ai(e,n),i)},Ti=function(n,t,e){return Vs(n,new Us(t),e)};function Vs(n,t,e){const i=n.getPriority().val(),o=pa(i,t.getImmediateChild(".priority"),e);let l;if(n.isLeafNode()){const u=n,h=pa(u.getValue(),t,e);return h!==u.getValue()||o!==u.getPriority().val()?new Cr(h,ke(o)):n}{const u=n;return l=u,o!==u.getPriority().val()&&(l=l.updatePriority(new Cr(o))),u.forEachChild(ge,(h,p)=>{const v=Vs(p,t.getImmediateChild(h),e);v!==p&&(l=l.updateImmediateChild(h,v))}),l}}class ma{constructor(t="",e=null,i={children:{},childCount:0}){this.name=t,this.parent=e,this.node=i}}function Lr(n,t){let e=t instanceof pe?t:new pe(t),i=n,o=ie(e);for(;null!==o;){const l=(0,g.yw)(i.node.children,o)||{children:{},childCount:0};i=new ma(o,i,l),e=ye(e),o=ie(e)}return i}function ir(n){return n.node.value}function xu(n,t){n.node.value=t,Lu(n)}function ud(n){return n.node.childCount>0}function Qc(n,t){Be(n.node.children,(e,i)=>{t(new ma(e,n,i))})}function dd(n,t,e,i){e&&!i&&t(n),Qc(n,o=>{dd(o,t,!0,i)}),e&&i&&t(n)}function va(n){return new pe(null===n.parent?n.name:va(n.parent)+"/"+n.name)}function Lu(n){null!==n.parent&&function ah(n,t,e){const i=function sh(n){return void 0===ir(n)&&!ud(n)}(e),o=(0,g.gR)(n.node.children,t);i&&o?(delete n.node.children[t],n.node.childCount--,Lu(n)):!i&&!o&&(n.node.children[t]=e.node,n.node.childCount++,Lu(n))}(n.parent,n.name,n)}const ch=/[\[\].#$\/\u0000-\u001F\u007F]/,lh=/[\[\].#$\u0000-\u001F\u007F]/,Mu=10485760,Jc=function(n){return"string"==typeof n&&0!==n.length&&!ch.test(n)},hd=function(n){return"string"==typeof n&&0!==n.length&&!lh.test(n)},ya=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!vr(n)||n&&"object"==typeof n&&(0,g.gR)(n,".sv")},bn=function(n,t,e,i){i&&void 0===t||Ia((0,g.dI)(n,"value"),t,e)},Ia=function(n,t,e){const i=e instanceof pe?new Gl(e,n):e;if(void 0===t)throw new Error(n+"contains undefined "+Pt(i));if("function"==typeof t)throw new Error(n+"contains a function "+Pt(i)+" with contents = "+t.toString());if(vr(t))throw new Error(n+"contains "+t.toString()+" "+Pt(i));if("string"==typeof t&&t.length>Mu/3&&(0,g.OE)(t)>Mu)throw new Error(n+"contains a string greater than "+Mu+" utf8 bytes "+Pt(i)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let o=!1,l=!1;if(Be(t,(u,h)=>{if(".value"===u)o=!0;else if(".priority"!==u&&".sv"!==u&&(l=!0,!Jc(u)))throw new Error(n+" contains an invalid key ("+u+") "+Pt(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function zl(n,t){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(t),n.byteLength_+=(0,g.OE)(t),mc(n)})(i,u),Ia(n,h,i),function ql(n){const t=n.parts_.pop();n.byteLength_-=(0,g.OE)(t),n.parts_.length>0&&(n.byteLength_-=1)}(i)}),o&&l)throw new Error(n+' contains ".value" child '+Pt(i)+" in addition to actual children.")}},fd=function(n,t,e,i){if(i&&void 0===t)return;const o=(0,g.dI)(n,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(o+" must be an object containing the children to replace.");const l=[];Be(t,(u,h)=>{const p=new pe(u);if(Ia(o,h,Re(e,p)),".priority"===ii(p)&&!ya(h))throw new Error(o+"contains an invalid value for '"+p.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");l.push(p)}),function(n,t){let e,i;for(e=0;e<t.length;e++){i=t[e];const l=si(i);for(let u=0;u<l.length;u++)if((".priority"!==l[u]||u!==l.length-1)&&!Jc(l[u]))throw new Error(n+"contains an invalid key ("+l[u]+") in path "+i.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(Kl);let o=null;for(e=0;e<t.length;e++){if(i=t[e],null!==o&&st(o,i))throw new Error(n+"contains a path "+o.toString()+" that is ancestor of another path "+i.toString());o=i}}(o,l)},Fu=function(n,t,e){if(!e||void 0!==t){if(vr(t))throw new Error((0,g.dI)(n,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!ya(t))throw new Error((0,g.dI)(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Ea=function(n,t,e,i){if(!(i&&void 0===e||Jc(e)))throw new Error((0,g.dI)(n,t)+'was an invalid key = "'+e+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Aa=function(n,t,e,i){if(!(i&&void 0===e||hd(e)))throw new Error((0,g.dI)(n,t)+'was an invalid path = "'+e+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},qt=function(n,t){if(".info"===ie(t))throw new Error(n+" failed = Can't modify data under /.info/")},pd=function(n,t){const e=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Jc(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==e.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),hd(n)}(e))throw new Error((0,g.dI)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class fh{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Xc(n,t){let e=null;for(let i=0;i<t.length;i++){const o=t[i],l=o.getPath();null!==e&&!ko(l,e.path)&&(n.eventLists_.push(e),e=null),null===e&&(e={events:[],path:l}),e.events.push(o)}e&&n.eventLists_.push(e)}function _d(n,t,e){Xc(n,e),gd(n,i=>ko(i,t))}function Ot(n,t,e){Xc(n,e),gd(n,i=>st(i,t)||st(t,i))}function gd(n,t){n.recursionDepth_++;let e=!0;for(let i=0;i<n.eventLists_.length;i++){const o=n.eventLists_[i];o&&(t(o.path)?(ph(n.eventLists_[i]),n.eventLists_[i]=null):e=!1)}e&&(n.eventLists_=[]),n.recursionDepth_--}function ph(n){for(let t=0;t<n.events.length;t++){const e=n.events[t];if(null!==e){n.events[t]=null;const i=e.getEventRunner();kt&&Oe("event: "+e.toString()),yn(i)}}}const md="repo_interrupt";class gh{constructor(t,e,i,o){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=i,this.appCheckProvider_=o,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new fh,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Rr(),this.transactionQueueTree_=new ma,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function vd(n){const e=n.infoData_.getNode(new pe(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function Ta(n){return function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n}({timestamp:vd(n)})}function yd(n,t,e,i,o){n.dataUpdateCount++;const l=new pe(t);e=n.interceptServerDataCallback_?n.interceptServerDataCallback_(t,e):e;let u=[];if(o)if(i){const p=(0,g.kH)(e,v=>ke(v));u=function Du(n,t,e,i){const o=A(n,i);if(o){const l=k(o),u=l.path,h=l.queryId,p=Ye(u,t),v=Ie.fromObject(e);return M(n,u,new Nr(Yo(h),p,v))}return[]}(n.serverSyncTree_,l,p,o)}else{const p=ke(e);u=zc(n.serverSyncTree_,l,p,o)}else if(i){const p=(0,g.kH)(e,v=>ke(v));u=function Kc(n,t,e){const i=Ie.fromObject(e);return r(n,new Nr({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,i))}(n.serverSyncTree_,l,p)}else{const p=ke(e);u=on(n.serverSyncTree_,l,p)}let h=l;u.length>0&&(h=Hs(n,l)),Ot(n.eventQueue_,h,u)}function Id(n,t){Uu(n,"connected",t),!1===t&&function Eh(n){Ws(n,"onDisconnectEvents");const t=Ta(n),e=Rr();Is(n.onDisconnect_,de(),(o,l)=>{const u=ga(o,l,n.serverSyncTree_,t);kr(e,o,u)});let i=[];Is(e,de(),(o,l)=>{i=i.concat(on(n.serverSyncTree_,o,l));const u=Bu(n,o);Hs(n,u)}),n.onDisconnect_=Rr(),Ot(n.eventQueue_,de(),i)}(n)}function Uu(n,t,e){const i=new pe("/.info/"+t),o=ke(e);n.infoData_.updateSnapshot(i,o);const l=on(n.infoSyncTree_,i,o);Ot(n.eventQueue_,i,l)}function Zc(n){return n.nextWriteId_++}function Vu(n,t,e,i,o){Ws(n,"set",{path:t.toString(),value:e,priority:i});const l=Ta(n),u=ke(e,i),h=Fs(n.serverSyncTree_,t),p=Ti(u,h,l),v=Zc(n),R=Ei(n.serverSyncTree_,t,p,v,!0);Xc(n.eventQueue_,R),n.server_.put(t.toString(),u.val(!0),(x,j)=>{const G="ok"===x;G||He("set at "+t+" failed: "+x);const le=Qe(n.serverSyncTree_,v,!G);Ot(n.eventQueue_,t,le),Mr(0,o,x,j)});const S=Bu(n,t);Hs(n,S),Ot(n.eventQueue_,S,[])}function Ah(n,t,e){n.server_.onDisconnectCancel(t.toString(),(i,o)=>{"ok"===i&&Go(n.onDisconnect_,t),Mr(0,e,i,o)})}function Ed(n,t,e,i){const o=ke(e);n.server_.onDisconnectPut(t.toString(),o.val(!0),(l,u)=>{"ok"===l&&kr(n.onDisconnect_,t,o),Mr(0,i,l,u)})}function Wu(n,t,e){let i;i=".info"===ie(t._path)?xr(n.infoSyncTree_,t,e):xr(n.serverSyncTree_,t,e),_d(n.eventQueue_,t._path,i)}function Ad(n){n.persistentConnection_&&n.persistentConnection_.interrupt(md)}function Ws(n,...t){let e="";n.persistentConnection_&&(e=n.persistentConnection_.id+":"),Oe(e,...t)}function Mr(n,t,e,i){t&&yn(()=>{if("ok"===e)t(null);else{const o=(e||"error").toUpperCase();let l=o;i&&(l+=": "+i);const u=new Error(l);u.code=o,t(u)}})}function Hu(n,t,e){return Fs(n.serverSyncTree_,t,e)||ee.EMPTY_NODE}function el(n,t=n.transactionQueueTree_){if(t||tl(n,t),ir(t)){const e=wd(n,t);(0,g.vA)(e.length>0,"Sending zero length transaction queue"),e.every(o=>0===o.status)&&function Rh(n,t,e){const i=e.map(v=>v.currentWriteId),o=Hu(n,t,i);let l=o;const u=o.hash();for(let v=0;v<e.length;v++){const R=e[v];(0,g.vA)(0===R.status,"tryToSendTransactionQueue_: items in queue should all be run."),R.status=1,R.retryCount++;const S=Ye(t,R.path);l=l.updateChild(S,R.currentOutputSnapshotRaw)}const h=l.val(!0),p=t;n.server_.put(p.toString(),h,v=>{Ws(n,"transaction put response",{path:p.toString(),status:v});let R=[];if("ok"===v){const S=[];for(let x=0;x<e.length;x++)e[x].status=2,R=R.concat(Qe(n.serverSyncTree_,e[x].currentWriteId)),e[x].onComplete&&S.push(()=>e[x].onComplete(null,!0,e[x].currentOutputSnapshotResolved)),e[x].unwatcher();tl(n,Lr(n.transactionQueueTree_,t)),el(n,n.transactionQueueTree_),Ot(n.eventQueue_,t,R);for(let x=0;x<S.length;x++)yn(S[x])}else{if("datastale"===v)for(let S=0;S<e.length;S++)e[S].status=3===e[S].status?4:0;else{He("transaction at "+p.toString()+" failed: "+v);for(let S=0;S<e.length;S++)e[S].status=4,e[S].abortReason=v}Hs(n,t)}},u)}(n,va(t),e)}else ud(t)&&Qc(t,e=>{el(n,e)})}function Hs(n,t){const e=Td(n,t),i=va(e);return function kh(n,t,e){if(0===t.length)return;const i=[];let o=[];const u=t.filter(h=>0===h.status).map(h=>h.currentWriteId);for(let h=0;h<t.length;h++){const p=t[h],v=Ye(e,p.path);let S,R=!1;if((0,g.vA)(null!==v,"rerunTransactionsUnderNode_: relativePath should not be null."),4===p.status)R=!0,S=p.abortReason,o=o.concat(Qe(n.serverSyncTree_,p.currentWriteId,!0));else if(0===p.status)if(p.retryCount>=25)R=!0,S="maxretry",o=o.concat(Qe(n.serverSyncTree_,p.currentWriteId,!0));else{const x=Hu(n,p.path,u);p.currentInputSnapshot=x;const j=t[h].update(x.val());if(void 0!==j){Ia("transaction failed: Data returned ",j,p.path);let G=ke(j);"object"==typeof j&&null!=j&&(0,g.gR)(j,".priority")||(G=G.updatePriority(x.getPriority()));const we=p.currentWriteId,xt=Ta(n),Lt=Ti(G,x,xt);p.currentOutputSnapshotRaw=G,p.currentOutputSnapshotResolved=Lt,p.currentWriteId=Zc(n),u.splice(u.indexOf(we),1),o=o.concat(Ei(n.serverSyncTree_,p.path,Lt,p.currentWriteId,p.applyLocally)),o=o.concat(Qe(n.serverSyncTree_,we,!0))}else R=!0,S="nodata",o=o.concat(Qe(n.serverSyncTree_,p.currentWriteId,!0))}Ot(n.eventQueue_,e,o),o=[],R&&(t[h].status=2,setTimeout(t[h].unwatcher,Math.floor(0)),t[h].onComplete&&i.push("nodata"===S?()=>t[h].onComplete(null,!1,t[h].currentInputSnapshot):()=>t[h].onComplete(new Error(S),!1,null)))}tl(n,n.transactionQueueTree_);for(let h=0;h<i.length;h++)yn(i[h]);el(n,n.transactionQueueTree_)}(n,wd(n,e),i),i}function Td(n,t){let e,i=n.transactionQueueTree_;for(e=ie(t);null!==e&&void 0===ir(i);)i=Lr(i,e),e=ie(t=ye(t));return i}function wd(n,t){const e=[];return Cd(n,t,e),e.sort((i,o)=>i.order-o.order),e}function Cd(n,t,e){const i=ir(t);if(i)for(let o=0;o<i.length;o++)e.push(i[o]);Qc(t,o=>{Cd(n,o,e)})}function tl(n,t){const e=ir(t);if(e){let i=0;for(let o=0;o<e.length;o++)2!==e[o].status&&(e[i]=e[o],i++);e.length=i,xu(t,e.length>0?e:void 0)}Qc(t,i=>{tl(n,i)})}function Bu(n,t){const e=va(Td(n,t)),i=Lr(n.transactionQueueTree_,t);return function oh(n,t,e){let i=e?n:n.parent;for(;null!==i;){if(t(i))return!0;i=i.parent}}(i,o=>{ju(n,o)}),ju(n,i),dd(i,o=>{ju(n,o)}),e}function ju(n,t){const e=ir(t);if(e){const i=[];let o=[],l=-1;for(let u=0;u<e.length;u++)3===e[u].status||(1===e[u].status?((0,g.vA)(l===u-1,"All SENT items should be at beginning of queue."),l=u,e[u].status=3,e[u].abortReason="set"):((0,g.vA)(0===e[u].status,"Unexpected transaction status in abort"),e[u].unwatcher(),o=o.concat(Qe(n.serverSyncTree_,e[u].currentWriteId,!0)),e[u].onComplete&&i.push(e[u].onComplete.bind(null,new Error("set"),!1,null))));-1===l?xu(t,void 0):e.length=l+1,Ot(n.eventQueue_,va(t),o);for(let u=0;u<i.length;u++)yn(i[u])}}const $u=function(n,t){const e=Oh(n),i=e.namespace;return"firebase.com"===e.domain&&Bt(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||"undefined"===i)&&"localhost"!==e.domain&&Bt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&He("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new Eo(e.host,e.secure,i,"ws"===e.scheme||"wss"===e.scheme,t,"",i!==e.subdomain),path:new pe(e.pathString)}},Oh=function(n){let t="",e="",i="",o="",l="",u=!0,h="https",p=443;if("string"==typeof n){let v=n.indexOf("//");v>=0&&(h=n.substring(0,v-1),n=n.substring(v+2));let R=n.indexOf("/");-1===R&&(R=n.length);let S=n.indexOf("?");-1===S&&(S=n.length),t=n.substring(0,Math.min(R,S)),R<S&&(o=function Ph(n){let t="";const e=n.split("/");for(let i=0;i<e.length;i++)if(e[i].length>0){let o=e[i];try{o=decodeURIComponent(o.replace(/\+/g," "))}catch{}t+="/"+o}return t}(n.substring(R,S)));const x=function Nh(n){const t={};"?"===n.charAt(0)&&(n=n.substring(1));for(const e of n.split("&")){if(0===e.length)continue;const i=e.split("=");2===i.length?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):He(`Invalid query segment '${e}' in query '${n}'`)}return t}(n.substring(Math.min(n.length,S)));v=t.indexOf(":"),v>=0?(u="https"===h||"wss"===h,p=parseInt(t.substring(v+1),10)):v=t.length;const j=t.slice(0,v);if("localhost"===j.toLowerCase())e="localhost";else if(j.split(".").length<=2)e=j;else{const G=t.indexOf(".");i=t.substring(0,G).toLowerCase(),e=t.substring(G+1),l=i}"ns"in x&&(l=x.ns)}return{host:t,port:p,domain:e,subdomain:i,secure:u,scheme:h,pathString:o,namespace:l}},bd="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Dh=function(){let n=0;const t=[];return function(e){const i=e===n;let o;n=e;const l=new Array(8);for(o=7;o>=0;o--)l[o]=bd.charAt(e%64),e=Math.floor(e/64);(0,g.vA)(0===e,"Cannot push at time == 0");let u=l.join("");if(i){for(o=11;o>=0&&63===t[o];o--)t[o]=0;t[o]++}else for(o=0;o<12;o++)t[o]=Math.floor(64*Math.random());for(o=0;o<12;o++)u+=bd.charAt(t[o]);return(0,g.vA)(20===u.length,"nextPushId: Length should be 20."),u}}();class Sd{constructor(t,e,i,o){this.eventType=t,this.eventRegistration=e,this.snapshot=i,this.prevName=o}getPath(){const t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,g.As)(this.snapshot.exportVal())}}class Rd{constructor(t,e,i){this.eventRegistration=t,this.error=e,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class Ku{constructor(t,e){this.snapshotCallback=t,this.cancelCallback=e}onValue(t,e){this.snapshotCallback.call(null,t,e)}onCancel(t){return(0,g.vA)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}class kd{constructor(t,e){this._repo=t,this._path=e}cancel(){const t=new g.cY;return Ah(this._repo,this._path,t.wrapCallback(()=>{})),t.promise}remove(){qt("OnDisconnect.remove",this._path);const t=new g.cY;return Ed(this._repo,this._path,null,t.wrapCallback(()=>{})),t.promise}set(t){qt("OnDisconnect.set",this._path),bn("OnDisconnect.set",t,this._path,!1);const e=new g.cY;return Ed(this._repo,this._path,t,e.wrapCallback(()=>{})),e.promise}setWithPriority(t,e){qt("OnDisconnect.setWithPriority",this._path),bn("OnDisconnect.setWithPriority",t,this._path,!1),Fu("OnDisconnect.setWithPriority",e,!1);const i=new g.cY;return function Th(n,t,e,i,o){const l=ke(e,i);n.server_.onDisconnectPut(t.toString(),l.val(!0),(u,h)=>{"ok"===u&&kr(n.onDisconnect_,t,l),Mr(0,o,u,h)})}(this._repo,this._path,t,e,i.wrapCallback(()=>{})),i.promise}update(t){qt("OnDisconnect.update",this._path),fd("OnDisconnect.update",t,this._path,!1);const e=new g.cY;return function wh(n,t,e,i){if((0,g.Im)(e))return Oe("onDisconnect().update() called with empty data.  Don't do anything."),void Mr(0,i,"ok",void 0);n.server_.onDisconnectMerge(t.toString(),e,(o,l)=>{"ok"===o&&Be(e,(u,h)=>{const p=ke(h);kr(n.onDisconnect_,Re(t,u),p)}),Mr(0,i,o,l)})}(this._repo,this._path,t,e.wrapCallback(()=>{})),e.promise}}class Tt{constructor(t,e,i,o){this._repo=t,this._path=e,this._queryParams=i,this._orderByCalled=o}get key(){return X(this._path)?null:ii(this._path)}get ref(){return new Yt(this._repo,this._path)}get _queryIdentifier(){const t=Cc(this._queryParams),e=po(t);return"{}"===e?"default":e}get _queryObject(){return Cc(this._queryParams)}isEqual(t){if(!((t=(0,g.Ku)(t))instanceof Tt))return!1;const e=this._repo===t._repo,i=ko(this._path,t._path);return e&&i&&this._queryIdentifier===t._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function _c(n){let t="";for(let e=n.pieceNum_;e<n.pieces_.length;e++)""!==n.pieces_[e]&&(t+="/"+encodeURIComponent(String(n.pieces_[e])));return t||"/"}(this._path)}}function nl(n,t){if(!0===n._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function Fr(n){let t=null,e=null;if(n.hasStart()&&(t=n.getIndexStartValue()),n.hasEnd()&&(e=n.getIndexEndValue()),n.getIndex()===Et){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",o="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==jt)throw new Error(i);if("string"!=typeof t)throw new Error(o)}if(n.hasEnd()){if(n.getIndexEndName()!==$t)throw new Error(i);if("string"!=typeof e)throw new Error(o)}}else if(n.getIndex()===ge){if(null!=t&&!ya(t)||null!=e&&!ya(e))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,g.vA)(n.getIndex()instanceof Wo||n.getIndex()===Bo,"unknown index type."),null!=t&&"object"==typeof t||null!=e&&"object"==typeof e)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function rl(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Yt extends Tt{constructor(t,e){super(t,e,new Sr,!1)}get parent(){const t=gc(this._path);return null===t?null:new Yt(this._repo,t)}get root(){let t=this;for(;null!==t.parent;)t=t.parent;return t}}class wi{constructor(t,e,i){this._node=t,this.ref=e,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const e=new pe(t),i=Ci(this.ref,t);return new wi(this._node.getChild(e),i,ge)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(i,o)=>t(new wi(o,Ci(this.ref,i),ge)))}hasChild(t){const e=new pe(t);return!this._node.getChild(e).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Pd(n,t){return(n=(0,g.Ku)(n))._checkNotDeleted("ref"),void 0!==t?Ci(n._root,t):n._root}function Nd(n,t){(n=(0,g.Ku)(n))._checkNotDeleted("refFromURL");const e=$u(t,n._repo.repoInfo_.nodeAdmin);pd("refFromURL",e);const i=e.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&i.host!==n._repo.repoInfo_.host&&Bt("refFromURL: Host name does not match the current database: (found "+i.host+" but expected "+n._repo.repoInfo_.host+")"),Pd(n,e.path.toString())}function Ci(n,t){return null===ie((n=(0,g.Ku)(n))._path)?((e=t)&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Aa("child","path",e,!1)):Aa("child","path",t,!1),new Yt(n._repo,Re(n._path,t));var e}function Gu(n,t){n=(0,g.Ku)(n),qt("set",n._path),bn("set",t,n._path,!1);const e=new g.cY;return Vu(n._repo,n._path,t,null,e.wrapCallback(()=>{})),e.promise}function Uh(n,t){fd("update",t,n._path,!1);const e=new g.cY;return function Ih(n,t,e,i){Ws(n,"update",{path:t.toString(),value:e});let o=!0;const l=Ta(n),u={};if(Be(e,(h,p)=>{o=!1,u[h]=ga(Re(t,h),ke(p),n.serverSyncTree_,l)}),o)Oe("update() called with empty data.  Don't do anything."),Mr(0,i,"ok",void 0);else{const h=Zc(n),p=function Nu(n,t,e,i){!function pu(n,t,e,i){(0,g.vA)(i>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:t,children:e,writeId:i,visible:!0}),n.visibleWrites=Qo(n.visibleWrites,t,e),n.lastWriteId=i}(n.pendingWriteTree_,t,e,i);const o=Ie.fromObject(e);return r(n,new Nr({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,o))}(n.serverSyncTree_,t,u,h);Xc(n.eventQueue_,p),n.server_.merge(t.toString(),e,(v,R)=>{const S="ok"===v;S||He("update at "+t+" failed: "+v);const x=Qe(n.serverSyncTree_,h,!S),j=x.length>0?Hs(n,t):t;Ot(n.eventQueue_,j,x),Mr(0,i,v,R)}),Be(e,v=>{const R=Bu(n,Re(t,v));Hs(n,R)}),Ot(n.eventQueue_,t,[])}}(n._repo,n._path,t,e.wrapCallback(()=>{})),e.promise}function Vh(n){n=(0,g.Ku)(n);const t=new Ku(()=>{}),e=new wa(t);return function yh(n,t,e){const i=function a(n,t){const e=t._path;let i=null;n.syncPointTree_.foreachOnPath(e,(v,R)=>{const S=Ye(v,e);i=i||nn(R,S)});let o=n.syncPointTree_.get(e);o?i=i||nn(o,de()):(o=new Os,n.syncPointTree_=n.syncPointTree_.set(e,o));const l=null!=i,u=l?new wn(i,!0,!1):null;return function bu(n){return Or(n.viewCache_)}(Hc(o,t,Cs(n.pendingWriteTree_,t._path),l?u.getNode():ee.EMPTY_NODE,l))}(n.serverSyncTree_,t);return null!=i?Promise.resolve(i):n.server_.get(t).then(o=>{const l=ke(o).withIndex(t._queryParams.getIndex());let u;if(fa(n.serverSyncTree_,t,e,!0),t._queryParams.loadsAllData())u=on(n.serverSyncTree_,t._path,l);else{const h=f(n.serverSyncTree_,t);u=zc(n.serverSyncTree_,t._path,l,h)}return Ot(n.eventQueue_,t._path,u),xr(n.serverSyncTree_,t,e,null,!0),l},o=>(Ws(n,"get for query "+(0,g.As)(t)+" failed: "+o),Promise.reject(new Error(o))))}(n._repo,n,e).then(i=>new wi(i,new Yt(n._repo,n._path),n._queryParams.getIndex()))}class wa{constructor(t){this.callbackContext=t}respondsTo(t){return"value"===t}createEvent(t,e){const i=e._queryParams.getIndex();return new Sd("value",this,new wi(t.snapshotNode,new Yt(e._repo,e._path),i))}getEventRunner(t){return"cancel"===t.getEventType()?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new Rd(this,t,e):null}matches(t){return t instanceof wa&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class il{constructor(t,e){this.eventType=t,this.callbackContext=e}respondsTo(t){let e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,this.eventType===e}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new Rd(this,t,e):null}createEvent(t,e){(0,g.vA)(null!=t.childName,"Child events should have a childName.");const i=Ci(new Yt(e._repo,e._path),t.childName),o=e._queryParams.getIndex();return new Sd(t.type,this,new wi(t.snapshotNode,i,o),t.prevName)}getEventRunner(t){return"cancel"===t.getEventType()?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,t.prevName)}matches(t){return t instanceof il&&this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function Ca(n,t,e,i,o){let l;if("object"==typeof i&&(l=void 0,o=i),"function"==typeof i&&(l=i),o&&o.onlyOnce){const p=e,v=(R,S)=>{Wu(n._repo,n,h),p(R,S)};v.userCallback=e.userCallback,v.context=e.context,e=v}const u=new Ku(e,l||void 0),h="value"===t?new wa(u):new il(t,u);return function Ch(n,t,e){let i;i=".info"===ie(t._path)?fa(n.infoSyncTree_,t,e):fa(n.serverSyncTree_,t,e),_d(n.eventQueue_,t._path,i)}(n._repo,n,h),()=>Wu(n._repo,n,h)}function zu(n,t,e,i){return Ca(n,"value",t,e,i)}function Od(n,t,e,i){return Ca(n,"child_added",t,e,i)}function Dd(n,t,e,i){return Ca(n,"child_changed",t,e,i)}function xd(n,t,e,i){return Ca(n,"child_moved",t,e,i)}function Ld(n,t,e,i){return Ca(n,"child_removed",t,e,i)}function Md(n,t,e){let i=null;const o=e?new Ku(e):null;"value"===t?i=new wa(o):t&&(i=new il(t,o)),Wu(n._repo,n,i)}class an{}class Fd extends an{constructor(t,e){super(),this._value=t,this._key=e,this.type="endAt"}_apply(t){bn("endAt",this._value,t._path,!0);const e=ms(t._queryParams,this._value,this._key);if(rl(e),Fr(e),t._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Tt(t._repo,t._path,e,t._orderByCalled)}}class Hh extends an{constructor(t,e){super(),this._value=t,this._key=e,this.type="endBefore"}_apply(t){bn("endBefore",this._value,t._path,!1);const e=function nu(n,t,e){let i;return i=ms(n,t,n.index_===Et||e?e:jt),i.endBeforeSet_=!0,i}(t._queryParams,this._value,this._key);if(rl(e),Fr(e),t._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Tt(t._repo,t._path,e,t._orderByCalled)}}class Ud extends an{constructor(t,e){super(),this._value=t,this._key=e,this.type="startAt"}_apply(t){bn("startAt",this._value,t._path,!0);const e=gs(t._queryParams,this._value,this._key);if(rl(e),Fr(e),t._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Tt(t._repo,t._path,e,t._orderByCalled)}}class $h extends an{constructor(t,e){super(),this._value=t,this._key=e,this.type="startAfter"}_apply(t){bn("startAfter",this._value,t._path,!1);const e=function wc(n,t,e){let i;return i=gs(n,t,n.index_===Et||e?e:$t),i.startAfterSet_=!0,i}(t._queryParams,this._value,this._key);if(rl(e),Fr(e),t._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Tt(t._repo,t._path,e,t._orderByCalled)}}class Gh extends an{constructor(t){super(),this._limit=t,this.type="limitToFirst"}_apply(t){if(t._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Tt(t._repo,t._path,function Ko(n,t){const e=n.copy();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="l",e}(t._queryParams,this._limit),t._orderByCalled)}}class qh extends an{constructor(t){super(),this._limit=t,this.type="limitToLast"}_apply(t){if(t._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Tt(t._repo,t._path,function tu(n,t){const e=n.copy();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="r",e}(t._queryParams,this._limit),t._orderByCalled)}}class Qh extends an{constructor(t){super(),this._path=t,this.type="orderByChild"}_apply(t){nl(t,"orderByChild");const e=new pe(this._path);if(X(e))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const i=new Wo(e),o=di(t._queryParams,i);return Fr(o),new Tt(t._repo,t._path,o,!0)}}class Xh extends an{constructor(){super(...arguments),this.type="orderByKey"}_apply(t){nl(t,"orderByKey");const e=di(t._queryParams,Et);return Fr(e),new Tt(t._repo,t._path,e,!0)}}class ef extends an{constructor(){super(...arguments),this.type="orderByPriority"}_apply(t){nl(t,"orderByPriority");const e=di(t._queryParams,ge);return Fr(e),new Tt(t._repo,t._path,e,!0)}}class nf extends an{constructor(){super(...arguments),this.type="orderByValue"}_apply(t){nl(t,"orderByValue");const e=di(t._queryParams,Bo);return Fr(e),new Tt(t._repo,t._path,e,!0)}}class sf extends an{constructor(t,e){super(),this._value=t,this._key=e,this.type="equalTo"}_apply(t){if(bn("equalTo",this._value,t._path,!1),t._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(t._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Fd(this._value,this._key)._apply(new Ud(this._value,this._key)._apply(t))}}function cn(n,...t){let e=(0,g.Ku)(n);for(const i of t)e=i._apply(e);return e}(function ku(n){(0,g.vA)(!Ns,"__referenceConstructor has already been defined"),Ns=n})(Yt),function Pu(n){(0,g.vA)(!Ls,"__referenceConstructor has already been defined"),Ls=n}(Yt);const qu={};function Yu(n,t,e,i,o){let l=i||n.options.databaseURL;void 0===l&&(n.options.projectId||Bt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Oe("Using default host for project ",n.options.projectId),l=`${n.options.projectId}-default-rtdb.firebaseio.com`);let p,v,u=$u(l,o),h=u.repoInfo;typeof process<"u"&&process.env&&(v=process.env.FIREBASE_DATABASE_EMULATOR_HOST),v?(p=!0,l=`http://${v}?ns=${h.namespace}`,u=$u(l,o),h=u.repoInfo):p=!u.repoInfo.secure;const R=o&&p?new ei(ei.OWNER):new vo(n.name,n.options,t);pd("Invalid Firebase Database URL",u),X(u.path)||Bt("Database URL must point to the root of a Firebase Database (not including a child path).");const S=function uf(n,t,e,i){let o=qu[t.name];o||(o={},qu[t.name]=o);let l=o[n.toURLString()];return l&&Bt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),l=new gh(n,false,e,i),o[n.toURLString()]=l,l}(h,n,R,new kl(n,e));return new hf(S,n)}class hf{constructor(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function mh(n,t,e){if(n.stats_=ac(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new ys(n.repoInfo_,(i,o,l,u)=>{yd(n,i,o,l,u)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>Id(n,!0),0);else{if(typeof e<"u"&&null!==e){if("object"!=typeof e)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,g.As)(e)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new Yn(n.repoInfo_,t,(i,o,l,u)=>{yd(n,i,o,l,u)},i=>{Id(n,i)},i=>{!function vh(n,t){Be(t,(e,i)=>{Uu(n,e,i)})}(n,i)},n.authTokenProvider_,n.appCheckProvider_,e),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=function Ao(n,t){const e=n.toString();return oc[e]||(oc[e]=t()),oc[e]}(n.repoInfo_,()=>new au(n.stats_,n.server_)),n.infoData_=new ru,n.infoSyncTree_=new Ms({startListening:(i,o,l,u)=>{let h=[];const p=n.infoData_.getNode(i._path);return p.isEmpty()||(h=on(n.infoSyncTree_,i._path,p),setTimeout(()=>{u("ok")},0)),h},stopListening:()=>{}}),Uu(n,"connected",!1),n.serverSyncTree_=new Ms({startListening:(i,o,l,u)=>(n.server_.listen(i,l,o,(h,p)=>{const v=u(h,p);Ot(n.eventQueue_,i._path,v)}),[]),stopListening:(i,o)=>{n.server_.unlisten(i,o)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Yt(this._repo,de())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function lf(n,t){const e=qu[t];(!e||e[n.key]!==n)&&Bt(`Database ${t}(${n.repoInfo_}) has already been deleted.`),Ad(n),delete e[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){null===this._rootInternal&&Bt("Cannot call "+t+" on a deleted database.")}}function Wd(){Wl.IS_TRANSPORT_INITIALIZED&&He("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function ff(){Wd(),Kt.forceDisallow()}function pf(){Wd(),Ir.forceDisallow(),Kt.forceAllow()}function mf(n,t){ts(n,t)}const yf={".sv":"timestamp"};class Af{constructor(t,e){this.committed=t,this.snapshot=e}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}Yn.prototype.simpleListen=function(n,t){this.sendRequest("q",{p:n},t)},Yn.prototype.echo=function(n,t){this.sendRequest("echo",{d:n},t)},function vf(n){gr($.SDK_VERSION),(0,$._registerComponent)(new Ge.uA("database",(t,{instanceIdentifier:e})=>Yu(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"),t.getProvider("app-check-internal"),e),"PUBLIC").setMultipleInstances(!0)),(0,$.registerVersion)(Ji,"1.0.12",n),(0,$.registerVersion)(Ji,"1.0.12","esm2017")}();const bf=new Vt.Vy("@firebase/database-compat"),Bd=function(n){bf.warn("FIREBASE WARNING: "+n)};class kf{constructor(t){this._delegate=t}cancel(t){(0,g.od)("OnDisconnect.cancel",0,1,arguments.length),(0,g.oD)("OnDisconnect.cancel","onComplete",t,!0);const e=this._delegate.cancel();return t&&e.then(()=>t(null),i=>t(i)),e}remove(t){(0,g.od)("OnDisconnect.remove",0,1,arguments.length),(0,g.oD)("OnDisconnect.remove","onComplete",t,!0);const e=this._delegate.remove();return t&&e.then(()=>t(null),i=>t(i)),e}set(t,e){(0,g.od)("OnDisconnect.set",1,2,arguments.length),(0,g.oD)("OnDisconnect.set","onComplete",e,!0);const i=this._delegate.set(t);return e&&i.then(()=>e(null),o=>e(o)),i}setWithPriority(t,e,i){(0,g.od)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,g.oD)("OnDisconnect.setWithPriority","onComplete",i,!0);const o=this._delegate.setWithPriority(t,e);return i&&o.then(()=>i(null),l=>i(l)),o}update(t,e){if((0,g.od)("OnDisconnect.update",1,2,arguments.length),Array.isArray(t)){const o={};for(let l=0;l<t.length;++l)o[""+l]=t[l];t=o,Bd("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,g.oD)("OnDisconnect.update","onComplete",e,!0);const i=this._delegate.update(t);return e&&i.then(()=>e(null),o=>e(o)),i}}class Pf{constructor(t,e){this.committed=t,this.snapshot=e}toJSON(){return(0,g.od)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class Ur{constructor(t,e){this._database=t,this._delegate=e}val(){return(0,g.od)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,g.od)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,g.od)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,g.od)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(t){return(0,g.od)("DataSnapshot.child",0,1,arguments.length),t=String(t),Aa("DataSnapshot.child","path",t,!1),new Ur(this._database,this._delegate.child(t))}hasChild(t){return(0,g.od)("DataSnapshot.hasChild",1,1,arguments.length),Aa("DataSnapshot.hasChild","path",t,!1),this._delegate.hasChild(t)}getPriority(){return(0,g.od)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(t){return(0,g.od)("DataSnapshot.forEach",1,1,arguments.length),(0,g.oD)("DataSnapshot.forEach","action",t,!1),this._delegate.forEach(e=>t(new Ur(this._database,e)))}hasChildren(){return(0,g.od)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,g.od)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,g.od)("DataSnapshot.ref",0,0,arguments.length),new Dt(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class et{constructor(t,e){this.database=t,this._delegate=e}on(t,e,i,o){var l;(0,g.od)("Query.on",2,4,arguments.length),(0,g.oD)("Query.on","callback",e,!1);const u=et.getCancelAndContextArgs_("Query.on",i,o),h=(v,R)=>{e.call(u.context,new Ur(this.database,v),R)};h.userCallback=e,h.context=u.context;const p=null===(l=u.cancel)||void 0===l?void 0:l.bind(u.context);switch(t){case"value":return zu(this._delegate,h,p),e;case"child_added":return Od(this._delegate,h,p),e;case"child_removed":return Ld(this._delegate,h,p),e;case"child_changed":return Dd(this._delegate,h,p),e;case"child_moved":return xd(this._delegate,h,p),e;default:throw new Error((0,g.dI)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(t,e,i){if((0,g.od)("Query.off",0,3,arguments.length),function(n,t){if(void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,g.dI)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,t),(0,g.oD)("Query.off","callback",e,!0),(0,g.HN)("Query.off","context",i,!0),e){const o=()=>{};o.userCallback=e,o.context=i,Md(this._delegate,t,o)}else Md(this._delegate,t)}get(){return Vh(this._delegate).then(t=>new Ur(this.database,t))}once(t,e,i,o){(0,g.od)("Query.once",1,4,arguments.length),(0,g.oD)("Query.once","callback",e,!0);const l=et.getCancelAndContextArgs_("Query.once",i,o),u=new g.cY,h=(v,R)=>{const S=new Ur(this.database,v);e&&e.call(l.context,S,R),u.resolve(S)};h.userCallback=e,h.context=l.context;const p=v=>{l.cancel&&l.cancel.call(l.context,v),u.reject(v)};switch(t){case"value":zu(this._delegate,h,p,{onlyOnce:!0});break;case"child_added":Od(this._delegate,h,p,{onlyOnce:!0});break;case"child_removed":Ld(this._delegate,h,p,{onlyOnce:!0});break;case"child_changed":Dd(this._delegate,h,p,{onlyOnce:!0});break;case"child_moved":xd(this._delegate,h,p,{onlyOnce:!0});break;default:throw new Error((0,g.dI)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return u.promise}limitToFirst(t){return(0,g.od)("Query.limitToFirst",1,1,arguments.length),new et(this.database,cn(this._delegate,function zh(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Gh(n)}(t)))}limitToLast(t){return(0,g.od)("Query.limitToLast",1,1,arguments.length),new et(this.database,cn(this._delegate,function Yh(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new qh(n)}(t)))}orderByChild(t){return(0,g.od)("Query.orderByChild",1,1,arguments.length),new et(this.database,cn(this._delegate,function Jh(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Aa("orderByChild","path",n,!1),new Qh(n)}(t)))}orderByKey(){return(0,g.od)("Query.orderByKey",0,0,arguments.length),new et(this.database,cn(this._delegate,function Zh(){return new Xh}()))}orderByPriority(){return(0,g.od)("Query.orderByPriority",0,0,arguments.length),new et(this.database,cn(this._delegate,function tf(){return new ef}()))}orderByValue(){return(0,g.od)("Query.orderByValue",0,0,arguments.length),new et(this.database,cn(this._delegate,function rf(){return new nf}()))}startAt(t=null,e){return(0,g.od)("Query.startAt",0,2,arguments.length),new et(this.database,cn(this._delegate,function jh(n=null,t){return Ea("startAt","key",t,!0),new Ud(n,t)}(t,e)))}startAfter(t=null,e){return(0,g.od)("Query.startAfter",0,2,arguments.length),new et(this.database,cn(this._delegate,function Kh(n,t){return Ea("startAfter","key",t,!0),new $h(n,t)}(t,e)))}endAt(t=null,e){return(0,g.od)("Query.endAt",0,2,arguments.length),new et(this.database,cn(this._delegate,function Wh(n,t){return Ea("endAt","key",t,!0),new Fd(n,t)}(t,e)))}endBefore(t=null,e){return(0,g.od)("Query.endBefore",0,2,arguments.length),new et(this.database,cn(this._delegate,function Bh(n,t){return Ea("endBefore","key",t,!0),new Hh(n,t)}(t,e)))}equalTo(t,e){return(0,g.od)("Query.equalTo",1,2,arguments.length),new et(this.database,cn(this._delegate,function of(n,t){return Ea("equalTo","key",t,!0),new sf(n,t)}(t,e)))}toString(){return(0,g.od)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,g.od)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(t){if((0,g.od)("Query.isEqual",1,1,arguments.length),!(t instanceof et))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(t._delegate)}static getCancelAndContextArgs_(t,e,i){const o={cancel:void 0,context:void 0};if(e&&i)o.cancel=e,(0,g.oD)(t,"cancel",o.cancel,!0),o.context=i,(0,g.HN)(t,"context",o.context,!0);else if(e)if("object"==typeof e&&null!==e)o.context=e;else{if("function"!=typeof e)throw new Error((0,g.dI)(t,"cancelOrContext")+" must either be a cancel callback or a context object.");o.cancel=e}return o}get ref(){return new Dt(this.database,new Yt(this._delegate._repo,this._delegate._path))}}class Dt extends et{constructor(t,e){super(t,new Tt(e._repo,e._path,new Sr,!1)),this.database=t,this._delegate=e}getKey(){return(0,g.od)("Reference.key",0,0,arguments.length),this._delegate.key}child(t){return(0,g.od)("Reference.child",1,1,arguments.length),"number"==typeof t&&(t=String(t)),new Dt(this.database,Ci(this._delegate,t))}getParent(){(0,g.od)("Reference.parent",0,0,arguments.length);const t=this._delegate.parent;return t?new Dt(this.database,t):null}getRoot(){return(0,g.od)("Reference.root",0,0,arguments.length),new Dt(this.database,this._delegate.root)}set(t,e){(0,g.od)("Reference.set",1,2,arguments.length),(0,g.oD)("Reference.set","onComplete",e,!0);const i=Gu(this._delegate,t);return e&&i.then(()=>e(null),o=>e(o)),i}update(t,e){if((0,g.od)("Reference.update",1,2,arguments.length),Array.isArray(t)){const o={};for(let l=0;l<t.length;++l)o[""+l]=t[l];t=o,Bd("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}qt("Reference.update",this._delegate._path),(0,g.oD)("Reference.update","onComplete",e,!0);const i=Uh(this._delegate,t);return e&&i.then(()=>e(null),o=>e(o)),i}setWithPriority(t,e,i){(0,g.od)("Reference.setWithPriority",2,3,arguments.length),(0,g.oD)("Reference.setWithPriority","onComplete",i,!0);const o=function Fh(n,t,e){if(qt("setWithPriority",n._path),bn("setWithPriority",t,n._path,!1),Fu("setWithPriority",e,!1),".length"===n.key||".keys"===n.key)throw"setWithPriority failed: "+n.key+" is a read-only object.";const i=new g.cY;return Vu(n._repo,n._path,t,e,i.wrapCallback(()=>{})),i.promise}(this._delegate,t,e);return i&&o.then(()=>i(null),l=>i(l)),o}remove(t){(0,g.od)("Reference.remove",0,1,arguments.length),(0,g.oD)("Reference.remove","onComplete",t,!0);const e=function Lh(n){return qt("remove",n._path),Gu(n,null)}(this._delegate);return t&&e.then(()=>t(null),i=>t(i)),e}transaction(t,e,i){(0,g.od)("Reference.transaction",1,3,arguments.length),(0,g.oD)("Reference.transaction","transactionUpdate",t,!1),(0,g.oD)("Reference.transaction","onComplete",e,!0),function(n,t,e){if(void 0!==e&&"boolean"!=typeof e)throw new Error((0,g.dI)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,i);const o=function Tf(n,t,e){var i;if(n=(0,g.Ku)(n),qt("Reference.transaction",n._path),".length"===n.key||".keys"===n.key)throw"Reference.transaction failed: "+n.key+" is a read-only object.";const o=null===(i=e?.applyLocally)||void 0===i||i,l=new g.cY,h=zu(n,()=>{});return function Sh(n,t,e,i,o,l){Ws(n,"transaction on "+t);const u={path:t,update:e,onComplete:i,status:null,order:Zi(),applyLocally:l,retryCount:0,unwatcher:o,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},h=Hu(n,t,void 0);u.currentInputSnapshot=h;const p=u.update(h.val());if(void 0===p)u.unwatcher(),u.currentOutputSnapshotRaw=null,u.currentOutputSnapshotResolved=null,u.onComplete&&u.onComplete(null,!1,u.currentInputSnapshot);else{Ia("transaction failed: Data returned ",p,u.path),u.status=0;const v=Lr(n.transactionQueueTree_,t),R=ir(v)||[];let S;R.push(u),xu(v,R),"object"==typeof p&&null!==p&&(0,g.gR)(p,".priority")?(S=(0,g.yw)(p,".priority"),(0,g.vA)(ya(S),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):S=(Fs(n.serverSyncTree_,t)||ee.EMPTY_NODE).getPriority().val();const x=Ta(n),j=ke(p,S),G=Ti(j,h,x);u.currentOutputSnapshotRaw=j,u.currentOutputSnapshotResolved=G,u.currentWriteId=Zc(n);const le=Ei(n.serverSyncTree_,t,G,u.currentWriteId,u.applyLocally);Ot(n.eventQueue_,t,le),el(n,n.transactionQueueTree_)}}(n._repo,n._path,t,(p,v,R)=>{let S=null;p?l.reject(p):(S=new wi(R,new Yt(n._repo,n._path),ge),l.resolve(new Af(v,S)))},h,o),l.promise}(this._delegate,t,{applyLocally:i}).then(l=>new Pf(l.committed,new Ur(this.database,l.snapshot)));return e&&o.then(l=>e(null,l.committed,l.snapshot),l=>e(l,!1,null)),o}setPriority(t,e){(0,g.od)("Reference.setPriority",1,2,arguments.length),(0,g.oD)("Reference.setPriority","onComplete",e,!0);const i=function Mh(n,t){n=(0,g.Ku)(n),qt("setPriority",n._path),Fu("setPriority",t,!1);const e=new g.cY;return Vu(n._repo,Re(n._path,".priority"),t,null,e.wrapCallback(()=>{})),e.promise}(this._delegate,t);return e&&i.then(()=>e(null),o=>e(o)),i}push(t,e){(0,g.od)("Reference.push",0,2,arguments.length),(0,g.oD)("Reference.push","onComplete",e,!0);const i=function xh(n,t){n=(0,g.Ku)(n),qt("push",n._path),bn("push",t,n._path,!0);const e=vd(n._repo),i=Dh(e),o=Ci(n,i),l=Ci(n,i);let u;return u=null!=t?Gu(l,t).then(()=>l):Promise.resolve(l),o.then=u.then.bind(u),o.catch=u.then.bind(u,void 0),o}(this._delegate,t),o=i.then(u=>new Dt(this.database,u));e&&o.then(()=>e(null),u=>e(u));const l=new Dt(this.database,i);return l.then=o.then.bind(o),l.catch=o.catch.bind(o,void 0),l}onDisconnect(){return qt("Reference.onDisconnect",this._delegate._path),new kf(new kd(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class ba{constructor(t,e){this._delegate=t,this.app=e,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:ff,forceLongPolling:pf}}useEmulator(t,e,i={}){!function Hd(n,t,e,i={}){(n=(0,g.Ku)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&Bt("Cannot call useEmulator() after instance has already been initialized.");const o=n._repoInternal;let l;if(o.repoInfo_.nodeAdmin)i.mockUserToken&&Bt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),l=new ei(ei.OWNER);else if(i.mockUserToken){const u="string"==typeof i.mockUserToken?i.mockUserToken:(0,g.Fy)(i.mockUserToken,n.app.options.projectId);l=new ei(u)}!function cf(n,t,e,i){n.repoInfo_=new Eo(`${t}:${e}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}(o,t,e,l)}(this._delegate,t,e,i)}ref(t){if((0,g.od)("database.ref",0,1,arguments.length),t instanceof Dt){const e=Nd(this._delegate,t.toString());return new Dt(this,e)}{const e=Pd(this._delegate,t);return new Dt(this,e)}}refFromURL(t){(0,g.od)("database.refFromURL",1,1,arguments.length);const i=Nd(this._delegate,t);return new Dt(this,i)}goOffline(){return(0,g.od)("database.goOffline",0,0,arguments.length),function _f(n){(n=(0,g.Ku)(n))._checkNotDeleted("goOffline"),Ad(n._repo)}(this._delegate)}goOnline(){return(0,g.od)("database.goOnline",0,0,arguments.length),function gf(n){(n=(0,g.Ku)(n))._checkNotDeleted("goOnline"),function bh(n){n.persistentConnection_&&n.persistentConnection_.resume(md)}(n._repo)}(this._delegate)}}ba.ServerValue={TIMESTAMP:function If(){return yf}(),increment:n=>function Ef(n){return{".sv":{increment:n}}}(n)};var Of=Object.freeze({__proto__:null,initStandalone:function Nf({app:n,url:t,version:e,customAuthImpl:i,customAppCheckImpl:o,namespace:l,nodeAdmin:u=!1}){gr(e);const h=new Ge.h1("database-standalone"),p=new Ge.Kq("auth-internal",h);let v;return p.setComponent(new Ge.uA("auth-internal",()=>i,"PRIVATE")),o&&(v=new Ge.Kq("app-check-internal",h),v.setComponent(new Ge.uA("app-check-internal",()=>o,"PRIVATE"))),{instance:new ba(Yu(n,p,v,t,u),n),namespace:l}}});const Df=ba.ServerValue;function Sa(n,t,e="on",i=K.E){return new We.c(o=>{let l=null;return l=n[e](t,(u,h)=>{i.schedule(()=>{o.next({snapshot:u,prevKey:h})}),"once"===e&&i.schedule(()=>o.complete())},u=>{i.schedule(()=>o.error(u))}),"on"===e?{unsubscribe(){null!=l&&n.off(t,l)}}:{unsubscribe(){}}}).pipe((0,qe.T)(o=>{const{snapshot:l,prevKey:u}=o;let h=null;return l.exists()&&(h=l.key),{type:t,payload:l,prevKey:u,key:h}}),(0,ao.u)())}function jd(n){return null==n}function $d(n){return"function"==typeof n.set}function Kd(n,t){return $d(t)?t:n.ref(t)}function Gd(n,t){if(function Lf(n){return"string"==typeof n}(n))return t.stringCase();if($d(n))return t.firebaseCase();if(function Mf(n){return"function"==typeof n.exportVal}(n))return t.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof n)}function zd(n){return(jd(n)||0===n.length)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function qd(n,t,e){const i=(t=zd(t)).map(o=>Sa(n,o,"on",e));return(0,Rt.h)(...i)}function Yd(n,t){return function(i,o){return Gd(i,{stringCase:()=>n.child(i)[t](o),firebaseCase:()=>i[t](o),snapshotCase:()=>i.ref[t](o)})}}function Wf(n){return function(e){return e?Gd(e,{stringCase:()=>n.child(e).remove(),firebaseCase:()=>e.remove(),snapshotCase:()=>e.ref.remove()}):n.remove()}}function Qd(n,t){const e=n.length;for(let i=0;i<e;i++)if(n[i].payload.key===t)return i;return-1}function jf(n,t){const{payload:e,prevKey:i,key:o}=t,l=Qd(n,o),u=function Bf(n,t){if(jd(t))return 0;{const e=Qd(n,t);return-1===e?n.length:e+1}}(n,i);switch(t.type){case"value":if(t.payload?.exists()){let h=null;t.payload.forEach(p=>{const v={payload:p,type:"value",prevKey:h,key:p.key};return h=p.key,n=[...n,v],!1})}return n;case"child_added":if(l>-1)(n[l-1]?.key||null)!==i&&(n=n.filter(p=>p.payload.key!==e.key)).splice(u,0,t);else{if(null==i)return[t,...n];(n=n.slice()).splice(u,0,t)}return n;case"child_removed":return n.filter(h=>h.payload.key!==e.key);case"child_changed":return n.map(h=>h.payload.key===o?t:h);case"child_moved":if(l>-1){const h=n.splice(l,1)[0];return(n=n.slice()).splice(u,0,h),n}return n;default:return n}}function Jd(n,t,e){return function Hf(n,t,e){return Sa(n,"value","once",e).pipe((0,Le.n)(i=>{const o=[(0,mn.of)(i)];return t.forEach(l=>o.push(Sa(n,l,"on",e))),(0,Rt.h)(...o).pipe((0,Yi.S)(jf,[]))}),(0,qa.F)())}(n,t=zd(t),e)}function Xd(n,t){return function(){return Sa(n,"value","on",t)}}!function xf(n){n.INTERNAL.registerComponent(new Ge.uA("database-compat",(t,{instanceIdentifier:e})=>{const i=t.getProvider("app-compat").getImmediate(),o=t.getProvider("database").getImmediate({identifier:e});return new ba(o,i)},"PUBLIC").setServiceProps({Reference:Dt,Query:et,Database:ba,DataSnapshot:Ur,enableLogging:mf,INTERNAL:Of,ServerValue:Df}).setMultipleInstances(!0)),n.registerVersion("@firebase/database-compat","2.0.3")}(O.A);const Gf=new _.nKC("angularfire2.realtimeDatabaseURL"),zf=new _.nKC("angularfire2.database.use-emulator");let Zd=(()=>{class n{schedulers;database;injector=(0,_.WQX)(_.uvJ);constructor(e,i,o,l,u,h,p,v,R,S,x,j,G,le,we){this.schedulers=h;const xt=p,Lt=dn(e,u,i);v&&Yr(Lt,u,R,x,j,G,S,le),this.database=fe(`${Lt.name}.database.${o}`,"AngularFireDatabase",Lt.name,()=>{const Pe=u.runOutsideAngular(()=>Lt.database(o||void 0));return xt&&Pe.useEmulator(...xt),Pe},[xt])}list(e,i){const o=(0,_.WQX)(_.SKi).runOutsideAngular(()=>Kd(this.database,e));let l=o;return i&&(l=i(o)),function $f(n,t,e){const i=t.schedulers.outsideAngular,o=(0,_.WQX)(_.SKi).run(()=>n.ref);return{query:n,update:Yd(o,"update"),set:Yd(o,"set"),push:l=>o.push(l),remove:Wf(o),snapshotChanges:l=>Jd(n,l,i).pipe(mt(e)),stateChanges:l=>qd(n,l,i).pipe(mt(e)),auditTrail:l=>function Ff(n,t,e){return function Vf(n,t,e){return function Uf(n,t){return Sa(n,"value","on",t).pipe((0,qe.T)(e=>{let i;return e.payload.forEach(o=>(i=o.key,!1)),{data:e,lastKeyToLoad:i}}))}(n,e).pipe((0,co.E)(t),(0,qe.T)(([o,l])=>{const u=o.lastKeyToLoad,h=l.map(p=>p.key);return{actions:l,lastKeyToLoad:u,loadedKeys:h}}),function uo(n){return(0,lo.N)((t,e)=>{let i=!1,o=0;t.subscribe((0,Qi._)(e,l=>(i||(i=!n(l,o++)))&&e.next(l)))})}(o=>-1===o.loadedKeys.indexOf(o.lastKeyToLoad)),(0,qe.T)(o=>o.actions))}(n,qd(n,t).pipe((0,Yi.S)((o,l)=>[...o,l],[])),e)}(n,l,i).pipe(mt(e)),valueChanges:(l,u)=>Jd(n,l,i).pipe((0,qe.T)(p=>p.map(v=>u&&u.idField?{...v.payload.val(),[u.idField]:v.key}:v.payload.val())),mt(e))}}(l,this,this.injector)}object(e){return function Kf(n,t,e){return{query:n,snapshotChanges:()=>Xd(n,t.schedulers.outsideAngular)().pipe(mt(e)),update:i=>n.ref.update(i),set:i=>n.ref.set(i),remove:()=>n.ref.remove(),valueChanges:()=>Xd(n,t.schedulers.outsideAngular)().pipe(mt(e),(0,qe.T)(o=>o.payload.exists()?o.payload.val():null))}}((0,_.WQX)(_.SKi).runOutsideAngular(()=>Kd(this.database,e)),this,this.injector)}createPushId(){return(0,_.WQX)(_.SKi).runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(i){return new(i||n)(_.KVO(Sn),_.KVO(gt,8),_.KVO(Gf,8),_.KVO(_.Agw),_.KVO(_.SKi),_.KVO(Fe),_.KVO(zf,8),_.KVO(Qr,8),_.KVO(so,8),_.KVO(zi,8),_.KVO(dt,8),_.KVO(oo,8),_.KVO(Ga,8),_.KVO(qi,8),_.KVO(St,8))};static \u0275prov=_.jDH({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),qf=(()=>{class n{constructor(){O.A.registerVersion("angularfire",oe.full,"rtdb-compat")}static \u0275fac=function(i){return new(i||n)};static \u0275mod=_.$C({type:n});static \u0275inj=_.G2t({providers:[Zd]})}return n})();var Yf=H(73688),Qt=H(99437),Ra=H(96697),Vr=H(93609),Qf=H(5884),Qu=H(61106);let sl=(()=>{class n extends Qf.m{constructor(e){super(),this.afAuth=e}logout(){const e="logout";return(0,it.H)(this.afAuth.signOut()).pipe((0,qe.T)(()=>new Vr.q(!0,null,this.getOption(`${e}.redirect.success`),[],this.getOption(`${e}.defaultMessages`))),(0,Qt.W)(i=>this.processFailure(i,e)))}register(e){throw new Error(`'register' is not supported by '${this.constructor.name}', use 'authenticate'.`)}requestPassword(e){throw new Error(`'requestPassword' is not supported by '${this.constructor.name}', use 'authenticate'.`)}resetPassword(e={}){throw new Error(`'resetPassword' is not supported by '${this.constructor.name}', use 'authenticate'.`)}refreshToken(e={}){throw new Error(`'refreshToken' is not supported by '${this.constructor.name}', use 'authenticate'.`)}processFailure(e,i){const o=[];return o.push(e instanceof Qu.wO?e.message:this.getOption("errors.getter")(i,e,this.options)),(0,mn.of)(new Vr.q(!1,e,this.getOption(`${i}.redirect.failure`),o,[]))}processSuccess(e,i){return this.afAuth.idToken.pipe((0,qe.T)(o=>new Vr.q(!0,e,this.getOption(`${i}.redirect.success`),[],this.getOption("messages.getter")(i,e,this.options),this.createToken(o))))}static{this.\u0275fac=function(i){return new(i||n)(_.KVO(Qr))}}static{this.\u0275prov=_.jDH({token:n,factory:n.\u0275fac})}}return n})();var eh=H(72863),th=H(60061);const Xf=new class Jf extends eh.K{constructor(){super(...arguments),this.token={class:Qu.ts},this.register={redirect:{success:"/",failure:null},defaultErrors:["Something went wrong, please try again."],defaultMessages:["You have been successfully registered."]},this.login={redirect:{success:"/",failure:null},defaultErrors:["Login/Email combination is not correct, please try again."],defaultMessages:["You have been successfully logged in."]},this.logout={redirect:{success:"/",failure:null},defaultErrors:["Something went wrong, please try again."],defaultMessages:["You have been successfully logged out."]},this.refreshToken={redirect:{success:null,failure:null},defaultErrors:["Something went wrong, please try again."],defaultMessages:["Your token has been successfully refreshed."]},this.requestPassword={redirect:{success:"/",failure:null},defaultErrors:["Something went wrong, please try again."],defaultMessages:["Reset password instructions have been sent to your email."]},this.resetPassword={redirect:{success:"/",failure:null},defaultErrors:["Something went wrong, please try again."],defaultMessages:["Your password has been successfully changed."]},this.errors={key:"message",getter:(t,e,i)=>(0,th.mf)(e,i.errors.key,i[t].defaultErrors)},this.messages={key:"messages",getter:(t,e,i)=>(0,th.mf)(e.body,i.messages.key,i[t].defaultMessages)}}};let nh=(()=>{class n extends sl{constructor(){super(...arguments),this.defaultOptions=Xf}static setup(e){return[n,e]}authenticate({email:e,password:i}){const o="login";return(0,it.H)(this.afAuth.signInWithEmailAndPassword(e,i)).pipe((0,Le.n)(l=>this.processSuccess(l,o)),(0,Qt.W)(l=>this.processFailure(l,o)))}refreshToken(e){const i="refreshToken";return this.afAuth.authState.pipe((0,Ra.s)(1),(0,Le.n)(o=>null==o?(0,mn.of)(new Vr.q(!1,null,this.getOption(`${i}.redirect.failure`),["There is no logged in user so refresh of id token isn't possible"])):this.refreshIdToken(o,i)))}register({email:e,password:i}){const o="register";return(0,it.H)(this.afAuth.createUserWithEmailAndPassword(e,i)).pipe((0,Le.n)(l=>this.processSuccess(l,o)),(0,Qt.W)(l=>this.processFailure(l,o)))}requestPassword({email:e}){const i="requestPassword";return(0,it.H)(this.afAuth.sendPasswordResetEmail(e)).pipe((0,qe.T)(()=>new Vr.q(!0,null,this.getOption(`${i}.redirect.success`),[],this.getOption(`${i}.defaultMessages`))),(0,Qt.W)(o=>this.processFailure(o,i)))}resetPassword({code:e,password:i}){const o="resetPassword";return(0,it.H)(this.afAuth.confirmPasswordReset(e,i)).pipe((0,qe.T)(()=>new Vr.q(!0,null,this.getOption(`${o}.redirect.success`),[],this.getOption(`${o}.defaultMessages`))),(0,Qt.W)(l=>this.processFailure(l,o)))}updatePassword(e,i,o){return(0,it.H)(e.updatePassword(i)).pipe((0,qe.T)(l=>new Vr.q(!0,null,this.getOption(`${o}.redirect.success`),[],this.getOption(`${o}.defaultMessages`),this.createToken(l))),(0,Qt.W)(l=>this.processFailure(l,o)))}refreshIdToken(e,i){return(0,it.H)(e.getIdToken(!0)).pipe((0,qe.T)(o=>new Vr.q(!0,null,this.getOption(`${i}.redirect.success`),[],this.getOption(`${i}.defaultMessages`),this.createToken(o))),(0,Qt.W)(o=>this.processFailure(o,i)))}static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=_.xGo(n)))(o||n)}})()}static{this.\u0275prov=_.jDH({token:n,factory:n.\u0275fac})}}return n})();class Ju extends eh.K{constructor(){super(...arguments),this.token={class:Qu.ts},this.logout={redirect:{success:"/",failure:null},defaultErrors:["Something went wrong, please try again."],defaultMessages:["You have been successfully logged out."]},this.authenticate={redirect:{success:"/",failure:null},defaultErrors:["Something went wrong, please try again."],defaultMessages:["You have been successfully authenticated."]},this.errors={key:"message",getter:(t,e,i)=>i[t].defaultErrors},this.messages={key:"message",getter:(t,e,i)=>i[t].defaultMessages},this.scopes=[],this.customParameters={}}}let rh=(()=>{class n extends sl{constructor(){super(...arguments),this.defaultOptions=new Ju}static setup(e){return[n,e]}authenticate(e){const i="authenticate",o=new O.A.auth.GoogleAuthProvider;return this.getOption("scopes").forEach(u=>o.addScope(u)),o.setCustomParameters(this.getOption("customParameters")),(0,it.H)(this.afAuth.signInWithPopup(o)).pipe((0,Le.n)(u=>this.processSuccess(u,i)),(0,Qt.W)(u=>this.processFailure(u,i)))}static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=_.xGo(n)))(o||n)}})()}static{this.\u0275prov=_.jDH({token:n,factory:n.\u0275fac})}}return n})(),Zf=(()=>{class n extends sl{constructor(){super(...arguments),this.defaultOptions=new Ju}static setup(e){return[n,e]}authenticate(e){const i="authenticate",o=new O.A.auth.FacebookAuthProvider;return this.getOption("scopes").forEach(u=>o.addScope(u)),o.setCustomParameters(this.getOption("customParameters")),(0,it.H)(this.afAuth.signInWithPopup(o)).pipe((0,Le.n)(u=>this.processSuccess(u,i)),(0,Qt.W)(u=>this.processFailure(u,i)))}static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=_.xGo(n)))(o||n)}})()}static{this.\u0275prov=_.jDH({token:n,factory:n.\u0275fac})}}return n})(),ep=(()=>{class n extends sl{constructor(){super(...arguments),this.defaultOptions=new Ju}static setup(e){return[n,e]}authenticate(e){const i="authenticate",o=new O.A.auth.TwitterAuthProvider;return o.setCustomParameters(this.getOption("customParameters")),(0,it.H)(this.afAuth.signInWithPopup(o)).pipe((0,Le.n)(l=>this.processSuccess(l,i)),(0,Qt.W)(l=>this.processFailure(l,i)))}static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=_.xGo(n)))(o||n)}})()}static{this.\u0275prov=_.jDH({token:n,factory:n.\u0275fac})}}return n})(),tp=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=_.$C({type:n})}static{this.\u0275inj=_.G2t({providers:[nh,rh,Zf,ep]})}}return n})(),Xu=(()=>{class n{constructor(e){this.db=e}getGreeting(){return this.db.object("/greeting/").valueChanges()}static{this.\u0275fac=function(i){return new(i||n)(_.KVO(Zd))}}static{this.\u0275prov=_.jDH({token:n,factory:n.\u0275fac})}}return n})();var ka=H(54614),np=H(37438),rp=H(33555),ip=H(99019),sp=H(42653),op=H(36167),ap=H(69967);let cp=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=_.VBU({type:n,selectors:[["nb-firebase-playground"]],standalone:!1,decls:1,vars:0,template:function(i,o){1&i&&_.nrm(0,"router-outlet")},dependencies:[ka.n3],encapsulation:2})}}return n})();var ih=H(22170);function lp(n,t){if(1&n&&(_.j41(0,"div"),_.EFF(1," Current User Token: "),_.j41(2,"pre"),_.EFF(3),_.nI1(4,"async"),_.nI1(5,"json"),_.k0s()()),2&n){const e=_.XpG();_.R7$(3),_.SpI(" ",_.bMT(5,3,_.bMT(4,1,e.userToken$))," ")}}function up(n,t){if(1&n&&(_.j41(0,"div"),_.EFF(1," Data from backend "),_.j41(2,"pre"),_.EFF(3),_.nI1(4,"async"),_.nI1(5,"json"),_.k0s()()),2&n){const e=_.XpG();_.R7$(3),_.JRh(_.bMT(5,3,_.bMT(4,1,e.data$)))}}function dp(n,t){if(1&n){const e=_.RV6();_.j41(0,"button",2),_.bIt("click",function(){_.eBV(e);const o=_.XpG();return _.Njj(o.logout())}),_.EFF(1," Logout\n"),_.k0s()}}function hp(n,t){if(1&n){const e=_.RV6();_.j41(0,"button",2),_.bIt("click",function(){_.eBV(e);const o=_.XpG();return _.Njj(o.login())}),_.EFF(1," Login\n"),_.k0s()}}function pp(n,t){if(1&n&&(_.j41(0,"div"),_.EFF(1," Current User Token: "),_.j41(2,"pre"),_.EFF(3),_.nI1(4,"async"),_.nI1(5,"json"),_.k0s()()),2&n){const e=_.XpG();_.R7$(3),_.SpI(" ",_.bMT(5,3,_.bMT(4,1,e.userToken$))," ")}}function _p(n,t){if(1&n&&(_.j41(0,"div"),_.EFF(1," Data from backend "),_.j41(2,"pre"),_.EFF(3),_.nI1(4,"async"),_.nI1(5,"json"),_.k0s()()),2&n){const e=_.XpG();_.R7$(3),_.JRh(_.bMT(5,3,_.bMT(4,1,e.data$)))}}function gp(n,t){if(1&n){const e=_.RV6();_.j41(0,"button",2),_.bIt("click",function(){_.eBV(e);const o=_.XpG();return _.Njj(o.logout())}),_.EFF(1," Logout\n"),_.k0s()}}function mp(n,t){if(1&n){const e=_.RV6();_.j41(0,"button",2),_.bIt("click",function(){_.eBV(e);const o=_.XpG();return _.Njj(o.loginWithGoogle())}),_.EFF(1," Login with google\n"),_.k0s()}}const yp=[{path:"",component:cp,children:[{path:"",component:np.s,children:[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:rp.f},{path:"register",component:ip.J},{path:"logout",component:sp.k},{path:"request-password",component:op.g},{path:"reset-password",component:ap.A}]}]},{path:"password-showcase",component:(()=>{class n{constructor(e,i,o,l){this.authService=e,this.router=i,this.firebaseApi=o,this.route=l,this.userToken$=this.authService.onTokenChange(),this.isAuthenticated$=this.authService.isAuthenticated()}logout(){this.router.navigate(["../logout"],{relativeTo:this.route})}login(){this.router.navigate(["../login"],{relativeTo:this.route})}resetPassword(){this.router.navigate(["../reset-password"],{relativeTo:this.route})}getData(){this.data$=this.firebaseApi.getGreeting().pipe((0,Ra.s)(1),(0,Qt.W)(e=>(0,mn.of)(e)),(0,ao.u)())}static{this.\u0275fac=function(i){return new(i||n)(_.rXU(ih.U),_.rXU(ka.Ix),_.rXU(Xu),_.rXU(ka.nX))}}static{this.\u0275cmp=_.VBU({type:n,selectors:[["nb-password-auth-showcase"]],standalone:!1,decls:15,vars:15,consts:[[4,"ngIf"],[3,"click",4,"ngIf"],[3,"click"]],template:function(i,o){1&i&&(_.j41(0,"div"),_.EFF(1),_.nI1(2,"async"),_.k0s(),_.DNE(3,lp,6,5,"div",0),_.nI1(4,"async"),_.DNE(5,up,6,5,"div",0),_.nI1(6,"async"),_.DNE(7,dp,2,0,"button",1),_.nI1(8,"async"),_.DNE(9,hp,2,0,"button",1),_.nI1(10,"async"),_.j41(11,"button",2),_.bIt("click",function(){return o.resetPassword()}),_.EFF(12,"Reset password"),_.k0s(),_.j41(13,"button",2),_.bIt("click",function(){return o.getData()}),_.EFF(14,"Get data from Firebase"),_.k0s()),2&i&&(_.R7$(),_.SpI("Authenticated: ",_.bMT(2,5,o.isAuthenticated$),""),_.R7$(2),_.Y8G("ngIf",_.bMT(4,7,o.isAuthenticated$)),_.R7$(2),_.Y8G("ngIf",_.bMT(6,9,o.data$)),_.R7$(2),_.Y8G("ngIf",_.bMT(8,11,o.isAuthenticated$)),_.R7$(2),_.Y8G("ngIf",!_.bMT(10,13,o.isAuthenticated$)))},dependencies:[m.bT,m.Jj,m.TG],encapsulation:2})}}return n})()},{path:"social-auth-showcase",component:(()=>{class n{constructor(e,i){this.firebaseApi=e,this.authService=i,this.userToken$=this.authService.onTokenChange(),this.isAuthenticated$=this.authService.onAuthenticationChange()}logout(){this.authService.logout("google").pipe((0,Ra.s)(1)).subscribe(e=>{})}loginWithGoogle(){this.authService.authenticate("google").pipe((0,Ra.s)(1)).subscribe(e=>{})}getData(){this.data$=this.firebaseApi.getGreeting().pipe((0,Ra.s)(1),(0,Qt.W)(e=>(0,mn.of)(e)),(0,ao.u)())}static{this.\u0275fac=function(i){return new(i||n)(_.rXU(Xu),_.rXU(ih.U))}}static{this.\u0275cmp=_.VBU({type:n,selectors:[["app-google-auth-showcase"]],standalone:!1,decls:13,vars:15,consts:[[4,"ngIf"],[3,"click",4,"ngIf"],[3,"click"]],template:function(i,o){1&i&&(_.j41(0,"div"),_.EFF(1),_.nI1(2,"async"),_.k0s(),_.DNE(3,pp,6,5,"div",0),_.nI1(4,"async"),_.DNE(5,_p,6,5,"div",0),_.nI1(6,"async"),_.DNE(7,gp,2,0,"button",1),_.nI1(8,"async"),_.DNE(9,mp,2,0,"button",1),_.nI1(10,"async"),_.j41(11,"button",2),_.bIt("click",function(){return o.getData()}),_.EFF(12,"Get data from Firebase"),_.k0s()),2&i&&(_.R7$(),_.SpI("Authenticated: ",_.bMT(2,5,o.isAuthenticated$),""),_.R7$(2),_.Y8G("ngIf",_.bMT(4,7,o.isAuthenticated$)),_.R7$(2),_.Y8G("ngIf",_.bMT(6,9,o.data$)),_.R7$(2),_.Y8G("ngIf",_.bMT(8,11,o.isAuthenticated$)),_.R7$(2),_.Y8G("ngIf",!_.bMT(10,13,o.isAuthenticated$)))},dependencies:[m.bT,m.Jj,m.TG],encapsulation:2})}}return n})()}];let Ip=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=_.$C({type:n})}static{this.\u0275inj=_.G2t({imports:[ka.iI.forChild(yp),ka.iI]})}}return n})(),Ep=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=_.$C({type:n})}static{this.\u0275inj=_.G2t({providers:[Xu],imports:[m.MD,Ri.initializeApp({apiKey:"AIzaSyBEvySH74-sISCTkCC6lXUd3zzYj26GjRk",authDomain:"auth-sample-f48f1.firebaseapp.com",databaseURL:"https://auth-sample-f48f1.firebaseio.com",projectId:"auth-sample-f48f1",storageBucket:"auth-sample-f48f1.appspot.com",messagingSenderId:"246754092661",appId:"1:246754092661:web:c2606b9ecdbed579673a3c"}),za,qf,Ip,tp,Yf.bI.forRoot({forms:{login:{strategy:"password",rememberMe:!0,socialLinks:[]},register:{strategy:"password",terms:!0,socialLinks:[]},logout:{strategy:"password"},requestPassword:{strategy:"password",socialLinks:[]},resetPassword:{strategy:"password",socialLinks:[]},validation:{password:{required:!0,minLength:6,maxLength:50},email:{required:!0},fullName:{required:!1,minLength:4,maxLength:50}}},strategies:[nh.setup({name:"password",login:{redirect:{success:"example/firebase/password-showcase"}},register:{redirect:{success:"example/firebase/password-showcase"}},logout:{redirect:{success:"example/firebase/login"}},requestPassword:{redirect:{success:"example/firebase/login"}},resetPassword:{redirect:{success:"example/firebase/login"}}}),rh.setup({name:"google"})]})]})}}return n})()},63345:(Si,pt,H)=>{H.d(pt,{A:()=>Xe});var m=H(21076),_=H(51362),$=H(17852),N=H(8041);class tt{constructor(J,ae){this._delegate=J,this.firebase=ae,(0,$._addComponent)(J,new _.uA("app-compat",()=>this,"PUBLIC")),this.container=J.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(J){this._delegate.automaticDataCollectionEnabled=J}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(J=>{this._delegate.checkDestroyed(),J()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,$.deleteApp)(this._delegate)))}_getService(J,ae=$._DEFAULT_ENTRY_NAME){var nt;this._delegate.checkDestroyed();const rt=this._delegate.container.getProvider(J);return!rt.isInitialized()&&"EXPLICIT"===(null===(nt=rt.getComponent())||void 0===nt?void 0:nt.instantiationMode)&&rt.initialize(),rt.getImmediate({identifier:ae})}_removeServiceInstance(J,ae=$._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(J).clearInstance(ae)}_addComponent(J){(0,$._addComponent)(this._delegate,J)}_addOrOverwriteComponent(J){(0,$._addOrOverwriteComponent)(this._delegate,J)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Je=new m.FA("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),L=function Ce(){const Ee=function wt(Ee){const J={},ae={__esModule:!0,initializeApp:function Fe(z,Ue={}){const Ne=$.initializeApp(z,Ue);if((0,m.gR)(J,Ne.name))return J[Ne.name];const O=new Ee(Ne,ae);return J[Ne.name]=O,O},app:rt,registerVersion:$.registerVersion,setLogLevel:$.setLogLevel,onLog:$.onLog,apps:null,SDK_VERSION:$.SDK_VERSION,INTERNAL:{registerComponent:function Ae(z){const Ue=z.name,Ne=Ue.replace("-compat","");if($._registerComponent(z)&&"PUBLIC"===z.type){const O=(xe=rt())=>{if("function"!=typeof xe[Ne])throw Je.create("invalid-app-argument",{appName:Ue});return xe[Ne]()};void 0!==z.serviceProps&&(0,m.zw)(O,z.serviceProps),ae[Ne]=O,Ee.prototype[Ne]=function(...xe){return this._getService.bind(this,Ue).apply(this,z.multipleInstances?xe:[])}}return"PUBLIC"===z.type?ae[Ne]:null},removeApp:function nt(z){delete J[z]},useAsService:function un(z,Ue){return"serverAuth"===Ue?null:Ue},modularAPIs:$}};function rt(z){if(!(0,m.gR)(J,z=z||$._DEFAULT_ENTRY_NAME))throw Je.create("no-app",{appName:z});return J[z]}return ae.default=ae,Object.defineProperty(ae,"apps",{get:function me(){return Object.keys(J).map(z=>J[z])}}),rt.App=Ee,ae}(tt);return Ee.INTERNAL=Object.assign(Object.assign({},Ee.INTERNAL),{createFirebaseNamespace:Ce,extendNamespace:function J(ae){(0,m.zw)(Ee,ae)},createSubscribe:m.tD,ErrorFactory:m.FA,deepExtend:m.zw}),Ee}(),U=new N.Vy("@firebase/app-compat");try{const Ee=(0,m.mS)();if(void 0!==Ee.firebase){U.warn("\n      Warning: Firebase is already defined in the global scope. Please make sure\n      Firebase library is only loaded once.\n    ");const J=Ee.firebase.SDK_VERSION;J&&J.indexOf("LITE")>=0&&U.warn("\n        Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n        ")}}catch{}const Xe=L;!function _e(Ee){(0,$.registerVersion)("@firebase/app-compat","0.2.50",Ee)}()},17852:(Si,pt,H)=>{H.r(pt),H.d(pt,{FirebaseError:()=>N.g,SDK_VERSION:()=>Dn,_DEFAULT_ENTRY_NAME:()=>Ct,_addComponent:()=>ki,_addOrOverwriteComponent:()=>Pi,_apps:()=>ct,_clearComponents:()=>ur,_components:()=>lt,_getProvider:()=>On,_isFirebaseApp:()=>Br,_isFirebaseServerApp:()=>yt,_registerComponent:()=>bt,_removeServiceInstance:()=>Ut,_serverApps:()=>vt,deleteApp:()=>E,getApp:()=>ve,getApps:()=>jr,initializeApp:()=>_n,initializeServerApp:()=>Oi,onLog:()=>D,registerVersion:()=>T,setLogLevel:()=>C});var m=H(10467),_=H(51362),$=H(8041),N=H(21076);let $e,Je;const L=new WeakMap,U=new WeakMap,K=new WeakMap,oe=new WeakMap,_e=new WeakMap;let J={get(b,w,P){if(b instanceof IDBTransaction){if("done"===w)return U.get(b);if("objectStoreNames"===w)return b.objectStoreNames||K.get(b);if("store"===w)return P.objectStoreNames[1]?void 0:P.objectStore(P.objectStoreNames[0])}return Fe(b[w])},set:(b,w,P)=>(b[w]=P,!0),has:(b,w)=>b instanceof IDBTransaction&&("done"===w||"store"===w)||w in b};function rt(b){return"function"==typeof b?function nt(b){return b!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Ce(){return Je||(Je=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(b)?function(...w){return b.apply(me(this),w),Fe(L.get(this))}:function(...w){return Fe(b.apply(me(this),w))}:function(w,...P){const V=b.call(me(this),w,...P);return K.set(V,w.sort?w.sort():[w]),Fe(V)}}(b):(b instanceof IDBTransaction&&function Ee(b){if(U.has(b))return;const w=new Promise((P,V)=>{const q=()=>{b.removeEventListener("complete",Q),b.removeEventListener("error",ne),b.removeEventListener("abort",ne)},Q=()=>{P(),q()},ne=()=>{V(b.error||new DOMException("AbortError","AbortError")),q()};b.addEventListener("complete",Q),b.addEventListener("error",ne),b.addEventListener("abort",ne)});U.set(b,w)}(b),((b,w)=>w.some(P=>b instanceof P))(b,function wt(){return $e||($e=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(b,J):b)}function Fe(b){if(b instanceof IDBRequest)return function Xe(b){const w=new Promise((P,V)=>{const q=()=>{b.removeEventListener("success",Q),b.removeEventListener("error",ne)},Q=()=>{P(Fe(b.result)),q()},ne=()=>{V(b.error),q()};b.addEventListener("success",Q),b.addEventListener("error",ne)});return w.then(P=>{P instanceof IDBCursor&&L.set(P,b)}).catch(()=>{}),_e.set(w,b),w}(b);if(oe.has(b))return oe.get(b);const w=rt(b);return w!==b&&(oe.set(b,w),_e.set(w,b)),w}const me=b=>_e.get(b),z=["get","getKey","getAll","getAllKeys","count"],Ue=["put","add","delete","clear"],Ne=new Map;function O(b,w){if(!(b instanceof IDBDatabase)||w in b||"string"!=typeof w)return;if(Ne.get(w))return Ne.get(w);const P=w.replace(/FromIndex$/,""),V=w!==P,q=Ue.includes(P);if(!(P in(V?IDBIndex:IDBObjectStore).prototype)||!q&&!z.includes(P))return;const Q=function(){var ne=(0,m.A)(function*(Te,...Y){const Ze=this.transaction(Te,q?"readwrite":"readonly");let It=Ze.store;return V&&(It=It.index(Y.shift())),(yield Promise.all([It[P](...Y),q&&Ze.done]))[0]});return function(Y){return ne.apply(this,arguments)}}();return Ne.set(w,Q),Q}!function ae(b){J=b(J)}(b=>({...b,get:(w,P,V)=>O(w,P)||b.get(w,P,V),has:(w,P)=>!!O(w,P)||b.has(w,P)}));class xe{constructor(w){this.container=w}getPlatformInfoString(){return this.container.getProviders().map(P=>{if(function Ke(b){const w=b.getComponent();return"VERSION"===w?.type}(P)){const V=P.getImmediate();return`${V.library}/${V.version}`}return null}).filter(P=>P).join(" ")}}const _t="@firebase/app",Jt="0.11.1",at=new $.Vy("@firebase/app"),sr="@firebase/app-compat",Sn="@firebase/analytics-compat",gt="@firebase/analytics",dn="@firebase/app-check-compat",or="@firebase/app-check",Wr="@firebase/auth",Ri="@firebase/auth-compat",fe="@firebase/database",he="@firebase/data-connect",hn="@firebase/database-compat",Rn="@firebase/functions",ar="@firebase/functions-compat",We="@firebase/installations",fn="@firebase/installations-compat",Xt="@firebase/messaging",Bs="@firebase/messaging-compat",js="@firebase/performance",Mt="@firebase/performance-compat",Hr="@firebase/remote-config",cr="@firebase/remote-config-compat",lr="@firebase/storage",mt="@firebase/storage-compat",kn="@firebase/firestore",Ft="@firebase/vertexai",pn="@firebase/firestore-compat",$s="firebase",Ct="[DEFAULT]",Nn={[_t]:"fire-core",[sr]:"fire-core-compat",[gt]:"fire-analytics",[Sn]:"fire-analytics-compat",[or]:"fire-app-check",[dn]:"fire-app-check-compat",[Wr]:"fire-auth",[Ri]:"fire-auth-compat",[fe]:"fire-rtdb",[he]:"fire-data-connect",[hn]:"fire-rtdb-compat",[Rn]:"fire-fn",[ar]:"fire-fn-compat",[We]:"fire-iid",[fn]:"fire-iid-compat",[Xt]:"fire-fcm",[Bs]:"fire-fcm-compat",[js]:"fire-perf",[Mt]:"fire-perf-compat",[Hr]:"fire-rc",[cr]:"fire-rc-compat",[lr]:"fire-gcs",[mt]:"fire-gcs-compat",[kn]:"fire-fst",[pn]:"fire-fst-compat",[Ft]:"fire-vertex","fire-js":"fire-js",[$s]:"fire-js-all"},ct=new Map,vt=new Map,lt=new Map;function ki(b,w){try{b.container.addComponent(w)}catch(P){at.debug(`Component ${w.name} failed to register with FirebaseApp ${b.name}`,P)}}function Pi(b,w){b.container.addOrOverwriteComponent(w)}function bt(b){const w=b.name;if(lt.has(w))return at.debug(`There were multiple attempts to register component ${w}.`),!1;lt.set(w,b);for(const P of ct.values())ki(P,b);for(const P of vt.values())ki(P,b);return!0}function On(b,w){const P=b.container.getProvider("heartbeat").getImmediate({optional:!0});return P&&P.triggerHeartbeat(),b.container.getProvider(w)}function Ut(b,w,P=Ct){On(b,w).clearInstance(P)}function Br(b){return void 0!==b.options}function yt(b){return null!=b&&void 0!==b.settings}function ur(){lt.clear()}const be=new N.FA("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Ge{constructor(w,P,V){this._isDeleted=!1,this._options=Object.assign({},w),this._config=Object.assign({},P),this._name=P.name,this._automaticDataCollectionEnabled=P.automaticDataCollectionEnabled,this._container=V,this.container.addComponent(new _.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(w){this.checkDestroyed(),this._automaticDataCollectionEnabled=w}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(w){this._isDeleted=w}checkDestroyed(){if(this.isDeleted)throw be.create("app-deleted",{appName:this._name})}}function g(b,w){const P=(0,N.u)(b.split(".")[1]);null!==P?void 0!==JSON.parse(P).exp?1e3*JSON.parse(P).exp-(new Date).getTime()<=0&&console.error(`FirebaseServerApp ${w} is invalid: the token has expired.`):console.error(`FirebaseServerApp ${w} is invalid: expiration claim could not be parsed`):console.error(`FirebaseServerApp ${w} is invalid: second part could not be parsed.`)}class Vt extends Ge{constructor(w,P,V,q){const Q=void 0!==P.automaticDataCollectionEnabled&&P.automaticDataCollectionEnabled,ne={name:V,automaticDataCollectionEnabled:Q};super(void 0!==w.apiKey?w:w.options,ne,q),this._serverConfig=Object.assign({automaticDataCollectionEnabled:Q},P),this._serverConfig.authIdToken&&g(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&g(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,P.releaseOnDeref=void 0,T(_t,Jt,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(w){this.isDeleted||(this._refCount++,void 0!==w&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(w,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){E(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw be.create("server-app-deleted")}}const Dn="11.3.1";function _n(b,w={}){let P=b;"object"!=typeof w&&(w={name:w});const V=Object.assign({name:Ct,automaticDataCollectionEnabled:!1},w),q=V.name;if("string"!=typeof q||!q)throw be.create("bad-app-name",{appName:String(q)});if(P||(P=(0,N.T9)()),!P)throw be.create("no-options");const Q=ct.get(q);if(Q){if((0,N.bD)(P,Q.options)&&(0,N.bD)(V,Q.config))return Q;throw be.create("duplicate-app",{appName:q})}const ne=new _.h1(q);for(const Y of lt.values())ne.addComponent(Y);const Te=new Ge(P,V,ne);return ct.set(q,Te),Te}function Oi(b,w){if((0,N.Bd)()&&!(0,N.p7)())throw be.create("invalid-server-app-environment");let P;void 0===w.automaticDataCollectionEnabled&&(w.automaticDataCollectionEnabled=!1),P=Br(b)?b.options:b;const V=Object.assign(Object.assign({},w),P);if(void 0!==V.releaseOnDeref&&delete V.releaseOnDeref,void 0!==w.releaseOnDeref&&typeof FinalizationRegistry>"u")throw be.create("finalization-registry-not-supported",{});const Q=""+(Ze=JSON.stringify(V),[...Ze].reduce((It,Un)=>Math.imul(31,It)+Un.charCodeAt(0)|0,0)),ne=vt.get(Q);var Ze;if(ne)return ne.incRefCount(w.releaseOnDeref),ne;const Te=new _.h1(Q);for(const Ze of lt.values())Te.addComponent(Ze);const Y=new Vt(P,w,Q,Te);return vt.set(Q,Y),Y}function ve(b=Ct){const w=ct.get(b);if(!w&&b===Ct&&(0,N.T9)())return _n();if(!w)throw be.create("no-app",{appName:b});return w}function jr(){return Array.from(ct.values())}function E(b){return I.apply(this,arguments)}function I(){return(I=(0,m.A)(function*(b){let w=!1;const P=b.name;ct.has(P)?(w=!0,ct.delete(P)):vt.has(P)&&b.decRefCount()<=0&&(vt.delete(P),w=!0),w&&(yield Promise.all(b.container.getProviders().map(V=>V.delete())),b.isDeleted=!0)})).apply(this,arguments)}function T(b,w,P){var V;let q=null!==(V=Nn[b])&&void 0!==V?V:b;P&&(q+=`-${P}`);const Q=q.match(/\s|\//),ne=w.match(/\s|\//);if(Q||ne){const Te=[`Unable to register library "${q}" with version "${w}":`];return Q&&Te.push(`library name "${q}" contains illegal characters (whitespace or "/")`),Q&&ne&&Te.push("and"),ne&&Te.push(`version name "${w}" contains illegal characters (whitespace or "/")`),void at.warn(Te.join(" "))}bt(new _.uA(`${q}-version`,()=>({library:q,version:w}),"VERSION"))}function D(b,w){if(null!==b&&"function"!=typeof b)throw be.create("invalid-log-argument");(0,$.Ey)(b,w)}function C(b){(0,$.He)(b)}const re="firebase-heartbeat-store";let ze=null;function Se(){return ze||(ze=function Ae(b,w,{blocked:P,upgrade:V,blocking:q,terminated:Q}={}){const ne=indexedDB.open(b,w),Te=Fe(ne);return V&&ne.addEventListener("upgradeneeded",Y=>{V(Fe(ne.result),Y.oldVersion,Y.newVersion,Fe(ne.transaction),Y)}),P&&ne.addEventListener("blocked",Y=>P(Y.oldVersion,Y.newVersion,Y)),Te.then(Y=>{Q&&Y.addEventListener("close",()=>Q()),q&&Y.addEventListener("versionchange",Ze=>q(Ze.oldVersion,Ze.newVersion,Ze))}).catch(()=>{}),Te}("firebase-heartbeat-database",1,{upgrade:(b,w)=>{if(0===w)try{b.createObjectStore(re)}catch(P){console.warn(P)}}}).catch(b=>{throw be.create("idb-open",{originalErrorMessage:b.message})})),ze}function te(){return(te=(0,m.A)(function*(b){try{const P=(yield Se()).transaction(re),V=yield P.objectStore(re).get(Wt(b));return yield P.done,V}catch(w){if(w instanceof N.g)at.warn(w.message);else{const P=be.create("idb-get",{originalErrorMessage:w?.message});at.warn(P.message)}}})).apply(this,arguments)}function je(b,w){return ut.apply(this,arguments)}function ut(){return(ut=(0,m.A)(function*(b,w){try{const V=(yield Se()).transaction(re,"readwrite");yield V.objectStore(re).put(w,Wt(b)),yield V.done}catch(P){if(P instanceof N.g)at.warn(P.message);else{const V=be.create("idb-set",{originalErrorMessage:P?.message});at.warn(V.message)}}})).apply(this,arguments)}function Wt(b){return`${b.name}!${b.options.appId}`}class Ln{constructor(w){this.container=w,this._heartbeatsCache=null;const P=this.container.getProvider("app").getImmediate();this._storage=new Mn(P),this._heartbeatsCachePromise=this._storage.read().then(V=>(this._heartbeatsCache=V,V))}triggerHeartbeat(){var w=this;return(0,m.A)(function*(){var P,V;try{const Q=w.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),ne=$r();if(null==(null===(P=w._heartbeatsCache)||void 0===P?void 0:P.heartbeats)&&(w._heartbeatsCache=yield w._heartbeatsCachePromise,null==(null===(V=w._heartbeatsCache)||void 0===V?void 0:V.heartbeats))||w._heartbeatsCache.lastSentHeartbeatDate===ne||w._heartbeatsCache.heartbeats.some(Te=>Te.date===ne))return;if(w._heartbeatsCache.heartbeats.push({date:ne,agent:Q}),w._heartbeatsCache.heartbeats.length>30){const Te=function Fn(b){if(0===b.length)return-1;let w=0,P=b[0].date;for(let V=1;V<b.length;V++)b[V].date<P&&(P=b[V].date,w=V);return w}(w._heartbeatsCache.heartbeats);w._heartbeatsCache.heartbeats.splice(Te,1)}return w._storage.overwrite(w._heartbeatsCache)}catch(q){at.warn(q)}})()}getHeartbeatsHeader(){var w=this;return(0,m.A)(function*(){var P;try{if(null===w._heartbeatsCache&&(yield w._heartbeatsCachePromise),null==(null===(P=w._heartbeatsCache)||void 0===P?void 0:P.heartbeats)||0===w._heartbeatsCache.heartbeats.length)return"";const V=$r(),{heartbeatsToSend:q,unsentEntries:Q}=function Kr(b,w=1024){const P=[];let V=b.slice();for(const q of b){const Q=P.find(ne=>ne.agent===q.agent);if(Q){if(Q.dates.push(q.date),Di(P)>w){Q.dates.pop();break}}else if(P.push({agent:q.agent,dates:[q.date]}),Di(P)>w){P.pop();break}V=V.slice(1)}return{heartbeatsToSend:P,unsentEntries:V}}(w._heartbeatsCache.heartbeats),ne=(0,N.Uj)(JSON.stringify({version:2,heartbeats:q}));return w._heartbeatsCache.lastSentHeartbeatDate=V,Q.length>0?(w._heartbeatsCache.heartbeats=Q,yield w._storage.overwrite(w._heartbeatsCache)):(w._heartbeatsCache.heartbeats=[],w._storage.overwrite(w._heartbeatsCache)),ne}catch(V){return at.warn(V),""}})()}}function $r(){return(new Date).toISOString().substring(0,10)}class Mn{constructor(w){this.app=w,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,m.A)(function*(){return!!(0,N.zW)()&&(0,N.eX)().then(()=>!0).catch(()=>!1)})()}read(){var w=this;return(0,m.A)(function*(){if(yield w._canUseIndexedDBPromise){const V=yield function ue(b){return te.apply(this,arguments)}(w.app);return V?.heartbeats?V:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(w){var P=this;return(0,m.A)(function*(){var V;if(yield P._canUseIndexedDBPromise){const Q=yield P.read();return je(P.app,{lastSentHeartbeatDate:null!==(V=w.lastSentHeartbeatDate)&&void 0!==V?V:Q.lastSentHeartbeatDate,heartbeats:w.heartbeats})}})()}add(w){var P=this;return(0,m.A)(function*(){var V;if(yield P._canUseIndexedDBPromise){const Q=yield P.read();return je(P.app,{lastSentHeartbeatDate:null!==(V=w.lastSentHeartbeatDate)&&void 0!==V?V:Q.lastSentHeartbeatDate,heartbeats:[...Q.heartbeats,...w.heartbeats]})}})()}}function Di(b){return(0,N.Uj)(JSON.stringify({version:2,heartbeats:b})).length}!function xi(b){bt(new _.uA("platform-logger",w=>new xe(w),"PRIVATE")),bt(new _.uA("heartbeat",w=>new Ln(w),"PRIVATE")),T(_t,Jt,b),T(_t,Jt,"esm2017"),T("fire-js","")}("")},51362:(Si,pt,H)=>{H.d(pt,{Kq:()=>tt,h1:()=>wt,uA:()=>$});var m=H(10467),_=H(21076);class ${constructor(L,U,K){this.name=L,this.instanceFactory=U,this.type=K,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(L){return this.instantiationMode=L,this}setMultipleInstances(L){return this.multipleInstances=L,this}setServiceProps(L){return this.serviceProps=L,this}setInstanceCreatedCallback(L){return this.onInstanceCreated=L,this}}const N="[DEFAULT]";class tt{constructor(L,U){this.name=L,this.container=U,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(L){const U=this.normalizeInstanceIdentifier(L);if(!this.instancesDeferred.has(U)){const K=new _.cY;if(this.instancesDeferred.set(U,K),this.isInitialized(U)||this.shouldAutoInitialize())try{const oe=this.getOrInitializeService({instanceIdentifier:U});oe&&K.resolve(oe)}catch{}}return this.instancesDeferred.get(U).promise}getImmediate(L){var U;const K=this.normalizeInstanceIdentifier(L?.identifier),oe=null!==(U=L?.optional)&&void 0!==U&&U;if(!this.isInitialized(K)&&!this.shouldAutoInitialize()){if(oe)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:K})}catch(_e){if(oe)return null;throw _e}}getComponent(){return this.component}setComponent(L){if(L.name!==this.name)throw Error(`Mismatching Component ${L.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=L,this.shouldAutoInitialize()){if(function Je(Ce){return"EAGER"===Ce.instantiationMode}(L))try{this.getOrInitializeService({instanceIdentifier:N})}catch{}for(const[U,K]of this.instancesDeferred.entries()){const oe=this.normalizeInstanceIdentifier(U);try{const _e=this.getOrInitializeService({instanceIdentifier:oe});K.resolve(_e)}catch{}}}}clearInstance(L=N){this.instancesDeferred.delete(L),this.instancesOptions.delete(L),this.instances.delete(L)}delete(){var L=this;return(0,m.A)(function*(){const U=Array.from(L.instances.values());yield Promise.all([...U.filter(K=>"INTERNAL"in K).map(K=>K.INTERNAL.delete()),...U.filter(K=>"_delete"in K).map(K=>K._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(L=N){return this.instances.has(L)}getOptions(L=N){return this.instancesOptions.get(L)||{}}initialize(L={}){const{options:U={}}=L,K=this.normalizeInstanceIdentifier(L.instanceIdentifier);if(this.isInitialized(K))throw Error(`${this.name}(${K}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const oe=this.getOrInitializeService({instanceIdentifier:K,options:U});for(const[_e,Xe]of this.instancesDeferred.entries())K===this.normalizeInstanceIdentifier(_e)&&Xe.resolve(oe);return oe}onInit(L,U){var K;const oe=this.normalizeInstanceIdentifier(U),_e=null!==(K=this.onInitCallbacks.get(oe))&&void 0!==K?K:new Set;_e.add(L),this.onInitCallbacks.set(oe,_e);const Xe=this.instances.get(oe);return Xe&&L(Xe,oe),()=>{_e.delete(L)}}invokeOnInitCallbacks(L,U){const K=this.onInitCallbacks.get(U);if(K)for(const oe of K)try{oe(L,U)}catch{}}getOrInitializeService({instanceIdentifier:L,options:U={}}){let K=this.instances.get(L);if(!K&&this.component&&(K=this.component.instanceFactory(this.container,{instanceIdentifier:(Ce=L,Ce===N?void 0:Ce),options:U}),this.instances.set(L,K),this.instancesOptions.set(L,U),this.invokeOnInitCallbacks(K,L),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,L,K)}catch{}var Ce;return K||null}normalizeInstanceIdentifier(L=N){return this.component?this.component.multipleInstances?L:N:L}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class wt{constructor(L){this.name=L,this.providers=new Map}addComponent(L){const U=this.getProvider(L.name);if(U.isComponentSet())throw new Error(`Component ${L.name} has already been registered with ${this.name}`);U.setComponent(L)}addOrOverwriteComponent(L){this.getProvider(L.name).isComponentSet()&&this.providers.delete(L.name),this.addComponent(L)}getProvider(L){if(this.providers.has(L))return this.providers.get(L);const U=new tt(L,this);return this.providers.set(L,U),U}getProviders(){return Array.from(this.providers.values())}}},8041:(Si,pt,H)=>{H.d(pt,{$b:()=>_,Ey:()=>Ce,He:()=>wt,Vy:()=>Je});const m=[];var _=function(L){return L[L.DEBUG=0]="DEBUG",L[L.VERBOSE=1]="VERBOSE",L[L.INFO=2]="INFO",L[L.WARN=3]="WARN",L[L.ERROR=4]="ERROR",L[L.SILENT=5]="SILENT",L}(_||{});const $={debug:_.DEBUG,verbose:_.VERBOSE,info:_.INFO,warn:_.WARN,error:_.ERROR,silent:_.SILENT},N=_.INFO,tt={[_.DEBUG]:"log",[_.VERBOSE]:"log",[_.INFO]:"info",[_.WARN]:"warn",[_.ERROR]:"error"},$e=(L,U,...K)=>{if(U<L.logLevel)return;const oe=(new Date).toISOString(),_e=tt[U];if(!_e)throw new Error(`Attempted to log a message with an invalid logType (value: ${U})`);console[_e](`[${oe}]  ${L.name}:`,...K)};class Je{constructor(U){this.name=U,this._logLevel=N,this._logHandler=$e,this._userLogHandler=null,m.push(this)}get logLevel(){return this._logLevel}set logLevel(U){if(!(U in _))throw new TypeError(`Invalid value "${U}" assigned to \`logLevel\``);this._logLevel=U}setLogLevel(U){this._logLevel="string"==typeof U?$[U]:U}get logHandler(){return this._logHandler}set logHandler(U){if("function"!=typeof U)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=U}get userLogHandler(){return this._userLogHandler}set userLogHandler(U){this._userLogHandler=U}debug(...U){this._userLogHandler&&this._userLogHandler(this,_.DEBUG,...U),this._logHandler(this,_.DEBUG,...U)}log(...U){this._userLogHandler&&this._userLogHandler(this,_.VERBOSE,...U),this._logHandler(this,_.VERBOSE,...U)}info(...U){this._userLogHandler&&this._userLogHandler(this,_.INFO,...U),this._logHandler(this,_.INFO,...U)}warn(...U){this._userLogHandler&&this._userLogHandler(this,_.WARN,...U),this._logHandler(this,_.WARN,...U)}error(...U){this._userLogHandler&&this._userLogHandler(this,_.ERROR,...U),this._logHandler(this,_.ERROR,...U)}}function wt(L){m.forEach(U=>{U.setLogLevel(L)})}function Ce(L,U){for(const K of m){let oe=null;U&&U.level&&(oe=$[U.level]),K.userLogHandler=null===L?null:(_e,Xe,...Ee)=>{const J=Ee.map(ae=>{if(null==ae)return null;if("string"==typeof ae)return ae;if("number"==typeof ae||"boolean"==typeof ae)return ae.toString();if(ae instanceof Error)return ae.message;try{return JSON.stringify(ae)}catch{return null}}).filter(ae=>ae).join(" ");Xe>=(oe??_e.logLevel)&&L({level:_[Xe].toLowerCase(),message:J,args:Ee,type:_e.name})}}}},66240:(Si,pt,H)=>{var m=H(10467),_=H(63345),$=H(17852),N=H(21076),tt=H(8041),$e=H(31635),Je=H(51362);const Xe=function oe(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}},Ee=function _e(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},J=new N.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),nt=new tt.Vy("@firebase/auth");function Fe(a,...r){nt.logLevel<=tt.$b.ERROR&&nt.error(`Auth (${$.SDK_VERSION}): ${a}`,...r)}function me(a,...r){throw Ne(a,...r)}function Ae(a,...r){return Ne(a,...r)}function un(a,r,s){const c=Object.assign(Object.assign({},Ee()),{[r]:s});return new N.FA("auth","Firebase",c).create(r,{appName:a.name})}function z(a){return un(a,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ue(a,r,s){if(!(r instanceof s))throw s.name!==r.constructor.name&&me(a,"argument-error"),un(a,"argument-error",`Type of ${r.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ne(a,...r){if("string"!=typeof a){const s=r[0],c=[...r.slice(1)];return c[0]&&(c[0].appName=a.name),a._errorFactory.create(s,...c)}return J.create(a,...r)}function O(a,r,...s){if(!a)throw Ne(r,...s)}function xe(a){const r="INTERNAL ASSERTION FAILED: "+a;throw Fe(r),new Error(r)}function Ke(a,r){a||xe(r)}function _t(){var a;return typeof self<"u"&&(null===(a=self.location)||void 0===a?void 0:a.href)||""}function Jt(){return"http:"===at()||"https:"===at()}function at(){var a;return typeof self<"u"&&(null===(a=self.location)||void 0===a?void 0:a.protocol)||null}class gt{constructor(r,s){this.shortDelay=r,this.longDelay=s,Ke(s>r,"Short delay should be less than long delay!"),this.isMobile=(0,N.jZ)()||(0,N.lV)()}get(){return function sr(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Jt()||(0,N.sr)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function dn(a,r){Ke(a.emulator,"Emulator should always be set here");const{url:s}=a.emulator;return r?`${s}${r.startsWith("/")?r.slice(1):r}`:s}class or{static initialize(r,s,c){this.fetchImpl=r,s&&(this.headersImpl=s),c&&(this.responseImpl=c)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void xe("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void xe("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void xe("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Wr={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Ri=new gt(3e4,6e4);function fe(a,r){return a.tenantId&&!r.tenantId?Object.assign(Object.assign({},r),{tenantId:a.tenantId}):r}function he(a,r,s,c){return hn.apply(this,arguments)}function hn(){return(hn=(0,m.A)(function*(a,r,s,c,d={}){return Rn(a,d,(0,m.A)(function*(){let f={},y={};c&&("GET"===r?y=c:f={body:JSON.stringify(c)});const A=(0,N.Am)(Object.assign({key:a.config.apiKey},y)).slice(1),k=yield a._getAdditionalHeaders();k["Content-Type"]="application/json",a.languageCode&&(k["X-Firebase-Locale"]=a.languageCode);const M=Object.assign({method:r,headers:k},f);return(0,N.c1)()||(M.referrerPolicy="no-referrer"),or.fetch()(Xt(a,a.config.apiHost,s,A),M)}))})).apply(this,arguments)}function Rn(a,r,s){return ar.apply(this,arguments)}function ar(){return(ar=(0,m.A)(function*(a,r,s){a._canInitEmulator=!1;const c=Object.assign(Object.assign({},Wr),r);try{const d=new js(a),f=yield Promise.race([s(),d.promise]);d.clearNetworkTimeout();const y=yield f.json();if("needConfirmation"in y)throw Mt(a,"account-exists-with-different-credential",y);if(f.ok&&!("errorMessage"in y))return y;{const A=f.ok?y.errorMessage:y.error.message,[k,M]=A.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===k)throw Mt(a,"credential-already-in-use",y);if("EMAIL_EXISTS"===k)throw Mt(a,"email-already-in-use",y);if("USER_DISABLED"===k)throw Mt(a,"user-disabled",y);const W=c[k]||k.toLowerCase().replace(/[_\s]+/g,"-");if(M)throw un(a,W,M);me(a,W)}}catch(d){if(d instanceof N.g)throw d;me(a,"network-request-failed",{message:String(d)})}})).apply(this,arguments)}function We(a,r,s,c){return fn.apply(this,arguments)}function fn(){return(fn=(0,m.A)(function*(a,r,s,c,d={}){const f=yield he(a,r,s,c,d);return"mfaPendingCredential"in f&&me(a,"multi-factor-auth-required",{_serverResponse:f}),f})).apply(this,arguments)}function Xt(a,r,s,c){const d=`${r}${s}?${c}`;return a.config.emulator?dn(a.config,d):`${a.config.apiScheme}://${d}`}function Bs(a){switch(a){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class js{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(r){this.auth=r,this.timer=null,this.promise=new Promise((s,c)=>{this.timer=setTimeout(()=>c(Ae(this.auth,"network-request-failed")),Ri.get())})}}function Mt(a,r,s){const c={appName:a.name};s.email&&(c.email=s.email),s.phoneNumber&&(c.phoneNumber=s.phoneNumber);const d=Ae(a,r,c);return d.customData._tokenResponse=s,d}function Hr(a){return void 0!==a&&void 0!==a.getResponse}function cr(a){return void 0!==a&&void 0!==a.enterprise}class lr{constructor(r){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===r.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=r.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=r.recaptchaEnforcementState}getProviderEnforcementState(r){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const s of this.recaptchaEnforcementState)if(s.provider&&s.provider===r)return Bs(s.enforcementState);return null}isProviderEnabled(r){return"ENFORCE"===this.getProviderEnforcementState(r)||"AUDIT"===this.getProviderEnforcementState(r)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}function kn(){return(kn=(0,m.A)(function*(a){return(yield he(a,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Ft(a,r){return pn.apply(this,arguments)}function pn(){return(pn=(0,m.A)(function*(a,r){return he(a,"GET","/v2/recaptchaConfig",fe(a,r))})).apply(this,arguments)}function Pn(){return(Pn=(0,m.A)(function*(a,r){return he(a,"POST","/v1/accounts:delete",r)})).apply(this,arguments)}function Nn(){return(Nn=(0,m.A)(function*(a,r){return he(a,"POST","/v1/accounts:update",r)})).apply(this,arguments)}function ct(a,r){return vt.apply(this,arguments)}function vt(){return(vt=(0,m.A)(function*(a,r){return he(a,"POST","/v1/accounts:lookup",r)})).apply(this,arguments)}function lt(a){if(a)try{const r=new Date(Number(a));if(!isNaN(r.getTime()))return r.toUTCString()}catch{}}function bt(){return(bt=(0,m.A)(function*(a,r=!1){const s=(0,N.Ku)(a),c=yield s.getIdToken(r),d=Ut(c);O(d&&d.exp&&d.auth_time&&d.iat,s.auth,"internal-error");const f="object"==typeof d.firebase?d.firebase:void 0,y=f?.sign_in_provider;return{claims:d,token:c,authTime:lt(On(d.auth_time)),issuedAtTime:lt(On(d.iat)),expirationTime:lt(On(d.exp)),signInProvider:y||null,signInSecondFactor:f?.sign_in_second_factor||null}})).apply(this,arguments)}function On(a){return 1e3*Number(a)}function Ut(a){const[r,s,c]=a.split(".");if(void 0===r||void 0===s||void 0===c)return Fe("JWT malformed, contained fewer than 3 sections"),null;try{const d=(0,N.u)(s);return d?JSON.parse(d):(Fe("Failed to decode base64 JWT payload"),null)}catch(d){return Fe("Caught error parsing JWT payload as JSON",d?.toString()),null}}function Br(a){const r=Ut(a);return O(r,"internal-error"),O(typeof r.exp<"u","internal-error"),O(typeof r.iat<"u","internal-error"),Number(r.exp)-Number(r.iat)}function yt(a,r){return ur.apply(this,arguments)}function ur(){return(ur=(0,m.A)(function*(a,r,s=!1){if(s)return r;try{return yield r}catch(c){throw c instanceof N.g&&function Ni({code:a}){return"auth/user-disabled"===a||"auth/user-token-expired"===a}(c)&&a.auth.currentUser===a&&(yield a.auth.signOut()),c}})).apply(this,arguments)}class be{constructor(r){this.user=r,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(r){var s;if(r){const c=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),c}{this.errorBackoff=3e4;const d=(null!==(s=this.user.stsTokenManager.expirationTime)&&void 0!==s?s:0)-Date.now()-3e5;return Math.max(0,d)}}schedule(r=!1){var s=this;if(!this.isRunning)return;const c=this.getInterval(r);this.timerId=setTimeout((0,m.A)(function*(){yield s.iteration()}),c)}iteration(){var r=this;return(0,m.A)(function*(){try{yield r.user.getIdToken(!0)}catch(s){return void("auth/network-request-failed"===s?.code&&r.schedule(!0))}r.schedule()})()}}class Ge{constructor(r,s){this.createdAt=r,this.lastLoginAt=s,this._initializeTime()}_initializeTime(){this.lastSignInTime=lt(this.lastLoginAt),this.creationTime=lt(this.createdAt)}_copy(r){this.createdAt=r.createdAt,this.lastLoginAt=r.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function g(a){return Vt.apply(this,arguments)}function Vt(){return(Vt=(0,m.A)(function*(a){var r;const s=a.auth,c=yield a.getIdToken(),d=yield yt(a,ct(s,{idToken:c}));O(d?.users.length,s,"internal-error");const f=d.users[0];a._notifyReloadListener(f);const y=null!==(r=f.providerUserInfo)&&void 0!==r&&r.length?ve(f.providerUserInfo):[],A=function Oi(a,r){return[...a.filter(c=>!r.some(d=>d.providerId===c.providerId)),...r]}(a.providerData,y),W=!!a.isAnonymous&&!(a.email&&f.passwordHash||A?.length),F={uid:f.localId,displayName:f.displayName||null,photoURL:f.photoUrl||null,email:f.email||null,emailVerified:f.emailVerified||!1,phoneNumber:f.phoneNumber||null,tenantId:f.tenantId||null,providerData:A,metadata:new Ge(f.createdAt,f.lastLoginAt),isAnonymous:W};Object.assign(a,F)})).apply(this,arguments)}function _n(){return(_n=(0,m.A)(function*(a){const r=(0,N.Ku)(a);yield g(r),yield r.auth._persistUserIfCurrent(r),r.auth._notifyListenersIfCurrent(r)})).apply(this,arguments)}function ve(a){return a.map(r=>{var{providerId:s}=r,c=(0,$e.Tt)(r,["providerId"]);return{providerId:s,uid:c.rawId||"",displayName:c.displayName||null,email:c.email||null,phoneNumber:c.phoneNumber||null,photoURL:c.photoUrl||null}})}function E(){return(E=(0,m.A)(function*(a,r){const s=yield Rn(a,{},(0,m.A)(function*(){const c=(0,N.Am)({grant_type:"refresh_token",refresh_token:r}).slice(1),{tokenApiHost:d,apiKey:f}=a.config,y=Xt(a,d,"/v1/token",`key=${f}`),A=yield a._getAdditionalHeaders();return A["Content-Type"]="application/x-www-form-urlencoded",or.fetch()(y,{method:"POST",headers:A,body:c})}));return{accessToken:s.access_token,expiresIn:s.expires_in,refreshToken:s.refresh_token}})).apply(this,arguments)}function T(){return(T=(0,m.A)(function*(a,r){return he(a,"POST","/v2/accounts:revokeToken",fe(a,r))})).apply(this,arguments)}class D{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(r){O(r.idToken,"internal-error"),O(typeof r.idToken<"u","internal-error"),O(typeof r.refreshToken<"u","internal-error");const s="expiresIn"in r&&typeof r.expiresIn<"u"?Number(r.expiresIn):Br(r.idToken);this.updateTokensAndExpiration(r.idToken,r.refreshToken,s)}updateFromIdToken(r){O(0!==r.length,"internal-error");const s=Br(r);this.updateTokensAndExpiration(r,null,s)}getToken(r,s=!1){var c=this;return(0,m.A)(function*(){return s||!c.accessToken||c.isExpired?(O(c.refreshToken,r,"user-token-expired"),c.refreshToken?(yield c.refresh(r,c.refreshToken),c.accessToken):null):c.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(r,s){var c=this;return(0,m.A)(function*(){const{accessToken:d,refreshToken:f,expiresIn:y}=yield function jr(a,r){return E.apply(this,arguments)}(r,s);c.updateTokensAndExpiration(d,f,Number(y))})()}updateTokensAndExpiration(r,s,c){this.refreshToken=s||null,this.accessToken=r||null,this.expirationTime=Date.now()+1e3*c}static fromJSON(r,s){const{refreshToken:c,accessToken:d,expirationTime:f}=s,y=new D;return c&&(O("string"==typeof c,"internal-error",{appName:r}),y.refreshToken=c),d&&(O("string"==typeof d,"internal-error",{appName:r}),y.accessToken=d),f&&(O("number"==typeof f,"internal-error",{appName:r}),y.expirationTime=f),y}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(r){this.accessToken=r.accessToken,this.refreshToken=r.refreshToken,this.expirationTime=r.expirationTime}_clone(){return Object.assign(new D,this.toJSON())}_performRefresh(){return xe("not implemented")}}function C(a,r){O("string"==typeof a||typeof a>"u","internal-error",{appName:r})}class B{constructor(r){var{uid:s,auth:c,stsTokenManager:d}=r,f=(0,$e.Tt)(r,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new be(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=s,this.auth=c,this.stsTokenManager=d,this.accessToken=d.accessToken,this.displayName=f.displayName||null,this.email=f.email||null,this.emailVerified=f.emailVerified||!1,this.phoneNumber=f.phoneNumber||null,this.photoURL=f.photoURL||null,this.isAnonymous=f.isAnonymous||!1,this.tenantId=f.tenantId||null,this.providerData=f.providerData?[...f.providerData]:[],this.metadata=new Ge(f.createdAt||void 0,f.lastLoginAt||void 0)}getIdToken(r){var s=this;return(0,m.A)(function*(){const c=yield yt(s,s.stsTokenManager.getToken(s.auth,r));return O(c,s.auth,"internal-error"),s.accessToken!==c&&(s.accessToken=c,yield s.auth._persistUserIfCurrent(s),s.auth._notifyListenersIfCurrent(s)),c})()}getIdTokenResult(r){return function Pi(a){return bt.apply(this,arguments)}(this,r)}reload(){return function Dn(a){return _n.apply(this,arguments)}(this)}_assign(r){this!==r&&(O(this.uid===r.uid,this.auth,"internal-error"),this.displayName=r.displayName,this.photoURL=r.photoURL,this.email=r.email,this.emailVerified=r.emailVerified,this.phoneNumber=r.phoneNumber,this.isAnonymous=r.isAnonymous,this.tenantId=r.tenantId,this.providerData=r.providerData.map(s=>Object.assign({},s)),this.metadata._copy(r.metadata),this.stsTokenManager._assign(r.stsTokenManager))}_clone(r){const s=new B(Object.assign(Object.assign({},this),{auth:r,stsTokenManager:this.stsTokenManager._clone()}));return s.metadata._copy(this.metadata),s}_onReload(r){O(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=r,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(r){this.reloadListener?this.reloadListener(r):this.reloadUserInfo=r}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(r,s=!1){var c=this;return(0,m.A)(function*(){let d=!1;r.idToken&&r.idToken!==c.stsTokenManager.accessToken&&(c.stsTokenManager.updateFromServerResponse(r),d=!0),s&&(yield g(c)),yield c.auth._persistUserIfCurrent(c),d&&c.auth._notifyListenersIfCurrent(c)})()}delete(){var r=this;return(0,m.A)(function*(){if((0,$._isFirebaseServerApp)(r.auth.app))return Promise.reject(z(r.auth));const s=yield r.getIdToken();return yield yt(r,function $s(a,r){return Pn.apply(this,arguments)}(r.auth,{idToken:s})),r.stsTokenManager.clearRefreshToken(),r.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(r=>Object.assign({},r)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(r,s){var c,d,f,y,A,k,M,W;const F=null!==(c=s.displayName)&&void 0!==c?c:void 0,ce=null!==(d=s.email)&&void 0!==d?d:void 0,Ve=null!==(f=s.phoneNumber)&&void 0!==f?f:void 0,rr=null!==(y=s.photoURL)&&void 0!==y?y:void 0,Us=null!==(A=s.tenantId)&&void 0!==A?A:void 0,Ai=null!==(k=s._redirectEventId)&&void 0!==k?k:void 0,qc=null!==(M=s.createdAt)&&void 0!==M?M:void 0,pa=null!==(W=s.lastLoginAt)&&void 0!==W?W:void 0,{uid:_a,emailVerified:Yc,isAnonymous:ga,providerData:Ti,stsTokenManager:Vs}=s;O(_a&&Vs,r,"internal-error");const ma=D.fromJSON(this.name,Vs);O("string"==typeof _a,r,"internal-error"),C(F,r.name),C(ce,r.name),O("boolean"==typeof Yc,r,"internal-error"),O("boolean"==typeof ga,r,"internal-error"),C(Ve,r.name),C(rr,r.name),C(Us,r.name),C(Ai,r.name),C(qc,r.name),C(pa,r.name);const Lr=new B({uid:_a,auth:r,email:ce,emailVerified:Yc,displayName:F,isAnonymous:ga,photoURL:rr,phoneNumber:Ve,tenantId:Us,stsTokenManager:ma,createdAt:qc,lastLoginAt:pa});return Ti&&Array.isArray(Ti)&&(Lr.providerData=Ti.map(ir=>Object.assign({},ir))),Ai&&(Lr._redirectEventId=Ai),Lr}static _fromIdTokenResponse(r,s,c=!1){return(0,m.A)(function*(){const d=new D;d.updateFromServerResponse(s);const f=new B({uid:s.localId,auth:r,stsTokenManager:d,isAnonymous:c});return yield g(f),f})()}static _fromGetAccountInfoResponse(r,s,c){return(0,m.A)(function*(){const d=s.users[0];O(void 0!==d.localId,"internal-error");const f=void 0!==d.providerUserInfo?ve(d.providerUserInfo):[],y=!(d.email&&d.passwordHash||f?.length),A=new D;A.updateFromIdToken(c);const k=new B({uid:d.localId,auth:r,stsTokenManager:A,isAnonymous:y}),M={uid:d.localId,displayName:d.displayName||null,photoURL:d.photoUrl||null,email:d.email||null,emailVerified:d.emailVerified||!1,phoneNumber:d.phoneNumber||null,tenantId:d.tenantId||null,providerData:f,metadata:new Ge(d.createdAt,d.lastLoginAt),isAnonymous:!(d.email&&d.passwordHash||f?.length)};return Object.assign(k,M),k})()}}const Z=new Map;function re(a){Ke(a instanceof Function,"Expected a class definition");let r=Z.get(a);return r?(Ke(r instanceof a,"Instance stored in cache mismatched with class"),r):(r=new a,Z.set(a,r),r)}const Se=(()=>{class a{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,m.A)(function*(){return!0})()}_set(s,c){var d=this;return(0,m.A)(function*(){d.storage[s]=c})()}_get(s){var c=this;return(0,m.A)(function*(){const d=c.storage[s];return void 0===d?null:d})()}_remove(s){var c=this;return(0,m.A)(function*(){delete c.storage[s]})()}_addListener(s,c){}_removeListener(s,c){}}return a.type="NONE",a})();function ue(a,r,s){return`firebase:${a}:${r}:${s}`}class te{constructor(r,s,c){this.persistence=r,this.auth=s,this.userKey=c;const{config:d,name:f}=this.auth;this.fullUserKey=ue(this.userKey,d.apiKey,f),this.fullPersistenceKey=ue("persistence",d.apiKey,f),this.boundEventHandler=s._onStorageEvent.bind(s),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(r){return this.persistence._set(this.fullUserKey,r.toJSON())}getCurrentUser(){var r=this;return(0,m.A)(function*(){const s=yield r.persistence._get(r.fullUserKey);return s?B._fromJSON(r.auth,s):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(r){var s=this;return(0,m.A)(function*(){if(s.persistence===r)return;const c=yield s.getCurrentUser();return yield s.removeCurrentUser(),s.persistence=r,c?s.setCurrentUser(c):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(r,s,c="authUser"){return(0,m.A)(function*(){if(!s.length)return new te(re(Se),r,c);const d=(yield Promise.all(s.map(function(){var M=(0,m.A)(function*(W){if(yield W._isAvailable())return W});return function(W){return M.apply(this,arguments)}}()))).filter(M=>M);let f=d[0]||re(Se);const y=ue(c,r.config.apiKey,r.name);let A=null;for(const M of s)try{const W=yield M._get(y);if(W){const F=B._fromJSON(r,W);M!==f&&(A=F),f=M;break}}catch{}const k=d.filter(M=>M._shouldAllowMigration);return f._shouldAllowMigration&&k.length?(f=k[0],A&&(yield f._set(y,A.toJSON())),yield Promise.all(s.map(function(){var M=(0,m.A)(function*(W){if(W!==f)try{yield W._remove(y)}catch{}});return function(W){return M.apply(this,arguments)}}())),new te(f,r,c)):new te(f,r,c)})()}}function je(a){const r=a.toLowerCase();if(r.includes("opera/")||r.includes("opr/")||r.includes("opios/"))return"Opera";if(dr(r))return"IEMobile";if(r.includes("msie")||r.includes("trident/"))return"IE";if(r.includes("edge/"))return"Edge";if(ut(r))return"Firefox";if(r.includes("silk/"))return"Silk";if($r(r))return"Blackberry";if(Kr(r))return"Webos";if(Wt(r))return"Safari";if((r.includes("chrome/")||xn(r))&&!r.includes("edge/"))return"Chrome";if(Ln(r))return"Android";{const c=a.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===c?.length)return c[1]}return"Other"}function ut(a=(0,N.ZQ)()){return/firefox\//i.test(a)}function Wt(a=(0,N.ZQ)()){const r=a.toLowerCase();return r.includes("safari/")&&!r.includes("chrome/")&&!r.includes("crios/")&&!r.includes("android")}function xn(a=(0,N.ZQ)()){return/crios\//i.test(a)}function dr(a=(0,N.ZQ)()){return/iemobile/i.test(a)}function Ln(a=(0,N.ZQ)()){return/android/i.test(a)}function $r(a=(0,N.ZQ)()){return/blackberry/i.test(a)}function Kr(a=(0,N.ZQ)()){return/webos/i.test(a)}function Mn(a=(0,N.ZQ)()){return/iphone|ipad|ipod/i.test(a)||/macintosh/i.test(a)&&/mobile/i.test(a)}function b(a=(0,N.ZQ)()){return Mn(a)||Ln(a)||Kr(a)||$r(a)||/windows phone/i.test(a)||dr(a)}function w(a,r=[]){let s;switch(a){case"Browser":s=je((0,N.ZQ)());break;case"Worker":s=`${je((0,N.ZQ)())}-${a}`;break;default:s=a}const c=r.length?r.join(","):"FirebaseCore-web";return`${s}/JsCore/${$.SDK_VERSION}/${c}`}class P{constructor(r){this.auth=r,this.queue=[]}pushCallback(r,s){const c=f=>new Promise((y,A)=>{try{y(r(f))}catch(k){A(k)}});c.onAbort=s,this.queue.push(c);const d=this.queue.length-1;return()=>{this.queue[d]=()=>Promise.resolve()}}runMiddleware(r){var s=this;return(0,m.A)(function*(){if(s.auth.currentUser===r)return;const c=[];try{for(const d of s.queue)yield d(r),d.onAbort&&c.push(d.onAbort)}catch(d){c.reverse();for(const f of c)try{f()}catch{}throw s.auth._errorFactory.create("login-blocked",{originalMessage:d?.message})}})()}}function q(){return(q=(0,m.A)(function*(a,r={}){return he(a,"GET","/v2/passwordPolicy",fe(a,r))})).apply(this,arguments)}class ne{constructor(r){var s,c,d,f;const y=r.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(s=y.minPasswordLength)&&void 0!==s?s:6,y.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=y.maxPasswordLength),void 0!==y.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=y.containsLowercaseCharacter),void 0!==y.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=y.containsUppercaseCharacter),void 0!==y.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=y.containsNumericCharacter),void 0!==y.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=y.containsNonAlphanumericCharacter),this.enforcementState=r.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(d=null===(c=r.allowedNonAlphanumericCharacters)||void 0===c?void 0:c.join(""))&&void 0!==d?d:"",this.forceUpgradeOnSignin=null!==(f=r.forceUpgradeOnSignin)&&void 0!==f&&f,this.schemaVersion=r.schemaVersion}validatePassword(r){var s,c,d,f,y,A;const k={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(r,k),this.validatePasswordCharacterOptions(r,k),k.isValid&&(k.isValid=null===(s=k.meetsMinPasswordLength)||void 0===s||s),k.isValid&&(k.isValid=null===(c=k.meetsMaxPasswordLength)||void 0===c||c),k.isValid&&(k.isValid=null===(d=k.containsLowercaseLetter)||void 0===d||d),k.isValid&&(k.isValid=null===(f=k.containsUppercaseLetter)||void 0===f||f),k.isValid&&(k.isValid=null===(y=k.containsNumericCharacter)||void 0===y||y),k.isValid&&(k.isValid=null===(A=k.containsNonAlphanumericCharacter)||void 0===A||A),k}validatePasswordLengthOptions(r,s){const c=this.customStrengthOptions.minPasswordLength,d=this.customStrengthOptions.maxPasswordLength;c&&(s.meetsMinPasswordLength=r.length>=c),d&&(s.meetsMaxPasswordLength=r.length<=d)}validatePasswordCharacterOptions(r,s){let c;this.updatePasswordCharacterOptionsStatuses(s,!1,!1,!1,!1);for(let d=0;d<r.length;d++)c=r.charAt(d),this.updatePasswordCharacterOptionsStatuses(s,c>="a"&&c<="z",c>="A"&&c<="Z",c>="0"&&c<="9",this.allowedNonAlphanumericCharacters.includes(c))}updatePasswordCharacterOptionsStatuses(r,s,c,d,f){this.customStrengthOptions.containsLowercaseLetter&&(r.containsLowercaseLetter||(r.containsLowercaseLetter=s)),this.customStrengthOptions.containsUppercaseLetter&&(r.containsUppercaseLetter||(r.containsUppercaseLetter=c)),this.customStrengthOptions.containsNumericCharacter&&(r.containsNumericCharacter||(r.containsNumericCharacter=d)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(r.containsNonAlphanumericCharacter||(r.containsNonAlphanumericCharacter=f))}}class Te{constructor(r,s,c,d){this.app=r,this.heartbeatServiceProvider=s,this.appCheckServiceProvider=c,this.config=d,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ze(this),this.idTokenSubscription=new Ze(this),this.beforeStateQueue=new P(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=J,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=r.name,this.clientVersion=d.sdkClientVersion}_initializeWithPersistence(r,s){var c=this;return s&&(this._popupRedirectResolver=re(s)),this._initializationPromise=this.queue((0,m.A)(function*(){var d,f;if(!c._deleted&&(c.persistenceManager=yield te.create(c,r),!c._deleted)){if(null!==(d=c._popupRedirectResolver)&&void 0!==d&&d._shouldInitProactively)try{yield c._popupRedirectResolver._initialize(c)}catch{}yield c.initializeCurrentUser(s),c.lastNotifiedUid=(null===(f=c.currentUser)||void 0===f?void 0:f.uid)||null,!c._deleted&&(c._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var r=this;return(0,m.A)(function*(){if(r._deleted)return;const s=yield r.assertedPersistence.getCurrentUser();if(r.currentUser||s){if(r.currentUser&&s&&r.currentUser.uid===s.uid)return r._currentUser._assign(s),void(yield r.currentUser.getIdToken());yield r._updateCurrentUser(s,!0)}})()}initializeCurrentUserFromIdToken(r){var s=this;return(0,m.A)(function*(){try{const c=yield ct(s,{idToken:r}),d=yield B._fromGetAccountInfoResponse(s,c,r);yield s.directlySetCurrentUser(d)}catch(c){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",c),yield s.directlySetCurrentUser(null)}})()}initializeCurrentUser(r){var s=this;return(0,m.A)(function*(){var c;if((0,$._isFirebaseServerApp)(s.app)){const A=s.app.settings.authIdToken;return A?new Promise(k=>{setTimeout(()=>s.initializeCurrentUserFromIdToken(A).then(k,k))}):s.directlySetCurrentUser(null)}const d=yield s.assertedPersistence.getCurrentUser();let f=d,y=!1;if(r&&s.config.authDomain){yield s.getOrInitRedirectPersistenceManager();const A=null===(c=s.redirectUser)||void 0===c?void 0:c._redirectEventId,k=f?._redirectEventId,M=yield s.tryRedirectSignIn(r);(!A||A===k)&&M?.user&&(f=M.user,y=!0)}if(!f)return s.directlySetCurrentUser(null);if(!f._redirectEventId){if(y)try{yield s.beforeStateQueue.runMiddleware(f)}catch(A){f=d,s._popupRedirectResolver._overrideRedirectResult(s,()=>Promise.reject(A))}return f?s.reloadAndSetCurrentUserOrClear(f):s.directlySetCurrentUser(null)}return O(s._popupRedirectResolver,s,"argument-error"),yield s.getOrInitRedirectPersistenceManager(),s.redirectUser&&s.redirectUser._redirectEventId===f._redirectEventId?s.directlySetCurrentUser(f):s.reloadAndSetCurrentUserOrClear(f)})()}tryRedirectSignIn(r){var s=this;return(0,m.A)(function*(){let c=null;try{c=yield s._popupRedirectResolver._completeRedirectFn(s,r,!0)}catch{yield s._setRedirectUser(null)}return c})()}reloadAndSetCurrentUserOrClear(r){var s=this;return(0,m.A)(function*(){try{yield g(r)}catch(c){if("auth/network-request-failed"!==c?.code)return s.directlySetCurrentUser(null)}return s.directlySetCurrentUser(r)})()}useDeviceLanguage(){this.languageCode=function Sn(){if(typeof navigator>"u")return null;const a=navigator;return a.languages&&a.languages[0]||a.language||null}()}_delete(){var r=this;return(0,m.A)(function*(){r._deleted=!0})()}updateCurrentUser(r){var s=this;return(0,m.A)(function*(){if((0,$._isFirebaseServerApp)(s.app))return Promise.reject(z(s));const c=r?(0,N.Ku)(r):null;return c&&O(c.auth.config.apiKey===s.config.apiKey,s,"invalid-user-token"),s._updateCurrentUser(c&&c._clone(s))})()}_updateCurrentUser(r,s=!1){var c=this;return(0,m.A)(function*(){if(!c._deleted)return r&&O(c.tenantId===r.tenantId,c,"tenant-id-mismatch"),s||(yield c.beforeStateQueue.runMiddleware(r)),c.queue((0,m.A)(function*(){yield c.directlySetCurrentUser(r),c.notifyAuthListeners()}))})()}signOut(){var r=this;return(0,m.A)(function*(){return(0,$._isFirebaseServerApp)(r.app)?Promise.reject(z(r)):(yield r.beforeStateQueue.runMiddleware(null),(r.redirectPersistenceManager||r._popupRedirectResolver)&&(yield r._setRedirectUser(null)),r._updateCurrentUser(null,!0))})()}setPersistence(r){var s=this;return(0,$._isFirebaseServerApp)(this.app)?Promise.reject(z(this)):this.queue((0,m.A)(function*(){yield s.assertedPersistence.setPersistence(re(r))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(r){var s=this;return(0,m.A)(function*(){s._getPasswordPolicyInternal()||(yield s._updatePasswordPolicy());const c=s._getPasswordPolicyInternal();return c.schemaVersion!==s.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(s._errorFactory.create("unsupported-password-policy-schema-version",{})):c.validatePassword(r)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var r=this;return(0,m.A)(function*(){const s=yield function V(a){return q.apply(this,arguments)}(r),c=new ne(s);null===r.tenantId?r._projectPasswordPolicy=c:r._tenantPasswordPolicies[r.tenantId]=c})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(r){this._errorFactory=new N.FA("auth","Firebase",r())}onAuthStateChanged(r,s,c){return this.registerStateListener(this.authStateSubscription,r,s,c)}beforeAuthStateChanged(r,s){return this.beforeStateQueue.pushCallback(r,s)}onIdTokenChanged(r,s,c){return this.registerStateListener(this.idTokenSubscription,r,s,c)}authStateReady(){return new Promise((r,s)=>{if(this.currentUser)r();else{const c=this.onAuthStateChanged(()=>{c(),r()},s)}})}revokeAccessToken(r){var s=this;return(0,m.A)(function*(){if(s.currentUser){const c=yield s.currentUser.getIdToken(),d={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:r,idToken:c};null!=s.tenantId&&(d.tenantId=s.tenantId),yield function I(a,r){return T.apply(this,arguments)}(s,d)}})()}toJSON(){var r;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(r=this._currentUser)||void 0===r?void 0:r.toJSON()}}_setRedirectUser(r,s){var c=this;return(0,m.A)(function*(){const d=yield c.getOrInitRedirectPersistenceManager(s);return null===r?d.removeCurrentUser():d.setCurrentUser(r)})()}getOrInitRedirectPersistenceManager(r){var s=this;return(0,m.A)(function*(){if(!s.redirectPersistenceManager){const c=r&&re(r)||s._popupRedirectResolver;O(c,s,"argument-error"),s.redirectPersistenceManager=yield te.create(s,[re(c._redirectPersistence)],"redirectUser"),s.redirectUser=yield s.redirectPersistenceManager.getCurrentUser()}return s.redirectPersistenceManager})()}_redirectUserForId(r){var s=this;return(0,m.A)(function*(){var c,d;return s._isInitialized&&(yield s.queue((0,m.A)(function*(){}))),(null===(c=s._currentUser)||void 0===c?void 0:c._redirectEventId)===r?s._currentUser:(null===(d=s.redirectUser)||void 0===d?void 0:d._redirectEventId)===r?s.redirectUser:null})()}_persistUserIfCurrent(r){var s=this;return(0,m.A)(function*(){if(r===s.currentUser)return s.queue((0,m.A)(function*(){return s.directlySetCurrentUser(r)}))})()}_notifyListenersIfCurrent(r){r===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r,s;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const c=null!==(s=null===(r=this.currentUser)||void 0===r?void 0:r.uid)&&void 0!==s?s:null;this.lastNotifiedUid!==c&&(this.lastNotifiedUid=c,this.authStateSubscription.next(this.currentUser))}registerStateListener(r,s,c,d){if(this._deleted)return()=>{};const f="function"==typeof s?s:s.next.bind(s);let y=!1;const A=this._isInitialized?Promise.resolve():this._initializationPromise;if(O(A,this,"internal-error"),A.then(()=>{y||f(this.currentUser)}),"function"==typeof s){const k=r.addObserver(s,c,d);return()=>{y=!0,k()}}{const k=r.addObserver(s);return()=>{y=!0,k()}}}directlySetCurrentUser(r){var s=this;return(0,m.A)(function*(){s.currentUser&&s.currentUser!==r&&s._currentUser._stopProactiveRefresh(),r&&s.isProactiveRefreshEnabled&&r._startProactiveRefresh(),s.currentUser=r,r?yield s.assertedPersistence.setCurrentUser(r):yield s.assertedPersistence.removeCurrentUser()})()}queue(r){return this.operations=this.operations.then(r,r),this.operations}get assertedPersistence(){return O(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(r){!r||this.frameworks.includes(r)||(this.frameworks.push(r),this.frameworks.sort(),this.clientVersion=w(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var r=this;return(0,m.A)(function*(){var s;const c={"X-Client-Version":r.clientVersion};r.app.options.appId&&(c["X-Firebase-gmpid"]=r.app.options.appId);const d=yield null===(s=r.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===s?void 0:s.getHeartbeatsHeader();d&&(c["X-Firebase-Client"]=d);const f=yield r._getAppCheckToken();return f&&(c["X-Firebase-AppCheck"]=f),c})()}_getAppCheckToken(){var r=this;return(0,m.A)(function*(){var s;if((0,$._isFirebaseServerApp)(r.app)&&r.app.settings.appCheckToken)return r.app.settings.appCheckToken;const c=yield null===(s=r.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===s?void 0:s.getToken();return c?.error&&function rt(a,...r){nt.logLevel<=tt.$b.WARN&&nt.warn(`Auth (${$.SDK_VERSION}): ${a}`,...r)}(`Error while retrieving App Check token: ${c.error}`),c?.token})()}}function Y(a){return(0,N.Ku)(a)}class Ze{constructor(r){this.auth=r,this.observer=null,this.addObserver=(0,N.tD)(s=>this.observer=s)}get next(){return O(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let It={loadJS:()=>(0,m.A)(function*(){throw new Error("Unable to load external scripts")})(),recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ks(a){return It.loadJS(a)}function Li(a){return`__${a}${Math.floor(1e6*Math.random())}`}const hr=1e12;class al{constructor(r){this.auth=r,this.counter=hr,this._widgets=new Map}render(r,s){const c=this.counter;return this._widgets.set(c,new Mi(r,this.auth.name,s||{})),this.counter++,c}reset(r){var s;const c=r||hr;null===(s=this._widgets.get(c))||void 0===s||s.delete(),this._widgets.delete(c)}getResponse(r){var s;return(null===(s=this._widgets.get(r||hr))||void 0===s?void 0:s.getResponse())||""}execute(r){var s=this;return(0,m.A)(function*(){var c;return null===(c=s._widgets.get(r||hr))||void 0===c||c.execute(),""})()}}class cl{constructor(){this.enterprise=new ll}ready(r){r()}execute(r,s){return Promise.resolve("token")}render(r,s){return""}}class ll{ready(r){r()}execute(r,s){return Promise.resolve("token")}render(r,s){return""}}class Mi{constructor(r,s,c){this.params=c,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const d="string"==typeof r?document.getElementById(r):r;O(d,"argument-error",{appName:s}),this.container=d,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Qs(a){const r=[],s="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let c=0;c<a;c++)r.push(s.charAt(Math.floor(62*Math.random())));return r.join("")}(50);const{callback:r,"expired-callback":s}=this.params;if(r)try{r(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,s)try{s()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Vn="NO_RECAPTCHA";class Fi{constructor(r){this.type="recaptcha-enterprise",this.auth=Y(r)}verify(r="verify",s=!1){var c=this;return(0,m.A)(function*(){function f(){return f=(0,m.A)(function*(A){if(!s){if(null==A.tenantId&&null!=A._agentRecaptchaConfig)return A._agentRecaptchaConfig.siteKey;if(null!=A.tenantId&&void 0!==A._tenantRecaptchaConfigs[A.tenantId])return A._tenantRecaptchaConfigs[A.tenantId].siteKey}return new Promise(function(){var k=(0,m.A)(function*(M,W){Ft(A,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(F=>{if(void 0!==F.recaptchaKey){const ce=new lr(F);return null==A.tenantId?A._agentRecaptchaConfig=ce:A._tenantRecaptchaConfigs[A.tenantId]=ce,M(ce.siteKey)}W(new Error("recaptcha Enterprise site key undefined"))}).catch(F=>{W(F)})});return function(M,W){return k.apply(this,arguments)}}())}),f.apply(this,arguments)}function y(A,k,M){const W=window.grecaptcha;cr(W)?W.enterprise.ready(()=>{W.enterprise.execute(A,{action:r}).then(F=>{k(F)}).catch(()=>{k(Vn)})}):M(Error("No reCAPTCHA enterprise script loaded."))}return c.auth.settings.appVerificationDisabledForTesting?(new cl).execute("siteKey",{action:"verify"}):new Promise((A,k)=>{(function d(A){return f.apply(this,arguments)})(c.auth).then(M=>{if(!s&&cr(window.grecaptcha))y(M,A,k);else{if(typeof window>"u")return void k(new Error("RecaptchaVerifier is only supported in browser"));let W=function zs(){return It.recaptchaEnterpriseScript}();0!==W.length&&(W+=M),Ks(W).then(()=>{y(M,A,k)}).catch(F=>{k(F)})}}).catch(M=>{k(M)})})})()}}function Wn(a,r,s){return Ui.apply(this,arguments)}function Ui(){return(Ui=(0,m.A)(function*(a,r,s,c=!1,d=!1){const f=new Fi(a);let y;if(d)y=Vn;else try{y=yield f.verify(s)}catch{y=yield f.verify(s,!0)}const A=Object.assign({},r);return"mfaSmsEnrollment"===s||"mfaSmsSignIn"===s?("phoneEnrollmentInfo"in A?Object.assign(A,{phoneEnrollmentInfo:{phoneNumber:A.phoneEnrollmentInfo.phoneNumber,recaptchaToken:A.phoneEnrollmentInfo.recaptchaToken,captchaResponse:y,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}}):"phoneSignInInfo"in A&&Object.assign(A,{phoneSignInInfo:{recaptchaToken:A.phoneSignInInfo.recaptchaToken,captchaResponse:y,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}}),A):(Object.assign(A,c?{captchaResp:y}:{captchaResponse:y}),Object.assign(A,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(A,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),A)})).apply(this,arguments)}function gn(a,r,s,c,d){return Vi.apply(this,arguments)}function Vi(){return Vi=(0,m.A)(function*(a,r,s,c,d){var f,y;if("EMAIL_PASSWORD_PROVIDER"===d){if(null!==(f=a._getRecaptchaConfig())&&void 0!==f&&f.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const A=yield Wn(a,r,s,"getOobCode"===s);return c(a,A)}return c(a,r).catch(function(){var A=(0,m.A)(function*(k){if("auth/missing-recaptcha-token"===k.code){console.log(`${s} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const M=yield Wn(a,r,s,"getOobCode"===s);return c(a,M)}return Promise.reject(k)});return function(k){return A.apply(this,arguments)}}())}if("PHONE_PROVIDER"===d){if(null!==(y=a._getRecaptchaConfig())&&void 0!==y&&y.isProviderEnabled("PHONE_PROVIDER")){const A=yield Wn(a,r,s);return c(a,A).catch(function(){var k=(0,m.A)(function*(M){var W;if("AUDIT"===(null===(W=a._getRecaptchaConfig())||void 0===W?void 0:W.getProviderEnforcementState("PHONE_PROVIDER"))&&("auth/missing-recaptcha-token"===M.code||"auth/invalid-app-credential"===M.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${s} flow.`);const F=yield Wn(a,r,s,!1,!0);return c(a,F)}return Promise.reject(M)});return function(M){return k.apply(this,arguments)}}())}{const A=yield Wn(a,r,s,!1,!0);return c(a,A)}}return Promise.reject(d+" provider is not supported.")}),Vi.apply(this,arguments)}function Wi(){return(Wi=(0,m.A)(function*(a){const r=Y(a),s=yield Ft(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),c=new lr(s);null==r.tenantId?r._agentRecaptchaConfig=c:r._tenantRecaptchaConfigs[r.tenantId]=c,c.isAnyProviderEnabled()&&new Fi(r).verify()})).apply(this,arguments)}function Oa(a){const r=a.indexOf(":");return r<0?"":a.substr(0,r+1)}function Da(a){if(!a)return null;const r=Number(a);return isNaN(r)?null:r}class fr{constructor(r,s){this.providerId=r,this.signInMethod=s}toJSON(){return xe("not implemented")}_getIdTokenResponse(r){return xe("not implemented")}_linkToIdToken(r,s){return xe("not implemented")}_getReauthenticationResolver(r){return xe("not implemented")}}function xa(a,r){return pr.apply(this,arguments)}function pr(){return(pr=(0,m.A)(function*(a,r){return he(a,"POST","/v1/accounts:resetPassword",fe(a,r))})).apply(this,arguments)}function Hi(){return(Hi=(0,m.A)(function*(a,r){return he(a,"POST","/v1/accounts:update",r)})).apply(this,arguments)}function Js(a,r){return Xs.apply(this,arguments)}function Xs(){return(Xs=(0,m.A)(function*(a,r){return he(a,"POST","/v1/accounts:signUp",r)})).apply(this,arguments)}function Zs(){return(Zs=(0,m.A)(function*(a,r){return he(a,"POST","/v1/accounts:update",fe(a,r))})).apply(this,arguments)}function Ma(a,r){return Bi.apply(this,arguments)}function Bi(){return(Bi=(0,m.A)(function*(a,r){return We(a,"POST","/v1/accounts:signInWithPassword",fe(a,r))})).apply(this,arguments)}function Gr(a,r){return ji.apply(this,arguments)}function ji(){return(ji=(0,m.A)(function*(a,r){return he(a,"POST","/v1/accounts:sendOobCode",fe(a,r))})).apply(this,arguments)}function Ua(){return(Ua=(0,m.A)(function*(a,r){return Gr(a,r)})).apply(this,arguments)}function _l(a,r){return Va.apply(this,arguments)}function Va(){return(Va=(0,m.A)(function*(a,r){return Gr(a,r)})).apply(this,arguments)}function Zu(a,r){return zr.apply(this,arguments)}function zr(){return(zr=(0,m.A)(function*(a,r){return Gr(a,r)})).apply(this,arguments)}function Wa(){return(Wa=(0,m.A)(function*(a,r){return Gr(a,r)})).apply(this,arguments)}function $i(){return($i=(0,m.A)(function*(a,r){return We(a,"POST","/v1/accounts:signInWithEmailLink",fe(a,r))})).apply(this,arguments)}function Ki(){return(Ki=(0,m.A)(function*(a,r){return We(a,"POST","/v1/accounts:signInWithEmailLink",fe(a,r))})).apply(this,arguments)}class Bn extends fr{constructor(r,s,c,d=null){super("password",c),this._email=r,this._password=s,this._tenantId=d}static _fromEmailAndPassword(r,s){return new Bn(r,s,"password")}static _fromEmailAndCode(r,s,c=null){return new Bn(r,s,"emailLink",c)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(r){const s="string"==typeof r?JSON.parse(r):r;if(s?.email&&s?.password){if("password"===s.signInMethod)return this._fromEmailAndPassword(s.email,s.password);if("emailLink"===s.signInMethod)return this._fromEmailAndCode(s.email,s.password,s.tenantId)}return null}_getIdTokenResponse(r){var s=this;return(0,m.A)(function*(){switch(s.signInMethod){case"password":return gn(r,{returnSecureToken:!0,email:s._email,password:s._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Ma,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return function gl(a,r){return $i.apply(this,arguments)}(r,{email:s._email,oobCode:s._password});default:me(r,"internal-error")}})()}_linkToIdToken(r,s){var c=this;return(0,m.A)(function*(){switch(c.signInMethod){case"password":return gn(r,{idToken:s,returnSecureToken:!0,email:c._email,password:c._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Js,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return function ml(a,r){return Ki.apply(this,arguments)}(r,{idToken:s,email:c._email,oobCode:c._password});default:me(r,"internal-error")}})()}_getReauthenticationResolver(r){return this._getIdTokenResponse(r)}}function St(a,r){return Ha.apply(this,arguments)}function Ha(){return(Ha=(0,m.A)(function*(a,r){return We(a,"POST","/v1/accounts:signInWithIdp",fe(a,r))})).apply(this,arguments)}class Ht extends fr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(r){const s=new Ht(r.providerId,r.signInMethod);return r.idToken||r.accessToken?(r.idToken&&(s.idToken=r.idToken),r.accessToken&&(s.accessToken=r.accessToken),r.nonce&&!r.pendingToken&&(s.nonce=r.nonce),r.pendingToken&&(s.pendingToken=r.pendingToken)):r.oauthToken&&r.oauthTokenSecret?(s.accessToken=r.oauthToken,s.secret=r.oauthTokenSecret):me("argument-error"),s}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(r){const s="string"==typeof r?JSON.parse(r):r,{providerId:c,signInMethod:d}=s,f=(0,$e.Tt)(s,["providerId","signInMethod"]);if(!c||!d)return null;const y=new Ht(c,d);return y.idToken=f.idToken||void 0,y.accessToken=f.accessToken||void 0,y.secret=f.secret,y.nonce=f.nonce,y.pendingToken=f.pendingToken||null,y}_getIdTokenResponse(r){return St(r,this.buildRequest())}_linkToIdToken(r,s){const c=this.buildRequest();return c.idToken=s,St(r,c)}_getReauthenticationResolver(r){const s=this.buildRequest();return s.autoCreate=!1,St(r,s)}buildRequest(){const r={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)r.pendingToken=this.pendingToken;else{const s={};this.idToken&&(s.id_token=this.idToken),this.accessToken&&(s.access_token=this.accessToken),this.secret&&(s.oauth_token_secret=this.secret),s.providerId=this.providerId,this.nonce&&!this.pendingToken&&(s.nonce=this.nonce),r.postBody=(0,N.Am)(s)}return r}}function vl(a,r){return to.apply(this,arguments)}function to(){return(to=(0,m.A)(function*(a,r){return he(a,"POST","/v1/accounts:sendVerificationCode",fe(a,r))})).apply(this,arguments)}function no(){return(no=(0,m.A)(function*(a,r){return We(a,"POST","/v1/accounts:signInWithPhoneNumber",fe(a,r))})).apply(this,arguments)}function Ba(){return(Ba=(0,m.A)(function*(a,r){const s=yield We(a,"POST","/v1/accounts:signInWithPhoneNumber",fe(a,r));if(s.temporaryProof)throw Mt(a,"account-exists-with-different-credential",s);return s})).apply(this,arguments)}const td={USER_NOT_FOUND:"user-not-found"};function ja(){return(ja=(0,m.A)(function*(a,r){return We(a,"POST","/v1/accounts:signInWithPhoneNumber",fe(a,Object.assign(Object.assign({},r),{operation:"REAUTH"})),td)})).apply(this,arguments)}class _r extends fr{constructor(r){super("phone","phone"),this.params=r}static _fromVerification(r,s){return new _r({verificationId:r,verificationCode:s})}static _fromTokenResponse(r,s){return new _r({phoneNumber:r,temporaryProof:s})}_getIdTokenResponse(r){return function yl(a,r){return no.apply(this,arguments)}(r,this._makeVerificationRequest())}_linkToIdToken(r,s){return function Il(a,r){return Ba.apply(this,arguments)}(r,Object.assign({idToken:s},this._makeVerificationRequest()))}_getReauthenticationResolver(r){return function nd(a,r){return ja.apply(this,arguments)}(r,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:r,phoneNumber:s,verificationId:c,verificationCode:d}=this.params;return r&&s?{temporaryProof:r,phoneNumber:s}:{sessionInfo:c,code:d}}toJSON(){const r={providerId:this.providerId};return this.params.phoneNumber&&(r.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(r.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(r.verificationCode=this.params.verificationCode),this.params.verificationId&&(r.verificationId=this.params.verificationId),r}static fromJSON(r){"string"==typeof r&&(r=JSON.parse(r));const{verificationId:s,verificationCode:c,phoneNumber:d,temporaryProof:f}=r;return c||s||d||f?new _r({verificationId:s,verificationCode:c,phoneNumber:d,temporaryProof:f}):null}}class qr{constructor(r){var s,c,d,f,y,A;const k=(0,N.I9)((0,N.hp)(r)),M=null!==(s=k.apiKey)&&void 0!==s?s:null,W=null!==(c=k.oobCode)&&void 0!==c?c:null,F=function rd(a){switch(a){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(d=k.mode)&&void 0!==d?d:null);O(M&&W&&F,"argument-error"),this.apiKey=M,this.operation=F,this.code=W,this.continueUrl=null!==(f=k.continueUrl)&&void 0!==f?f:null,this.languageCode=null!==(y=k.languageCode)&&void 0!==y?y:null,this.tenantId=null!==(A=k.tenantId)&&void 0!==A?A:null}static parseLink(r){const s=function id(a){const r=(0,N.I9)((0,N.hp)(a)).link,s=r?(0,N.I9)((0,N.hp)(r)).deep_link_id:null,c=(0,N.I9)((0,N.hp)(a)).deep_link_id;return(c?(0,N.I9)((0,N.hp)(c)).link:null)||c||s||r||a}(r);try{return new qr(s)}catch{return null}}}let it=(()=>{class a{constructor(){this.providerId=a.PROVIDER_ID}static credential(s,c){return Bn._fromEmailAndPassword(s,c)}static credentialWithLink(s,c){const d=qr.parseLink(c);return O(d,"argument-error"),Bn._fromEmailAndCode(s,d.code,d.tenantId)}}return a.PROVIDER_ID="password",a.EMAIL_PASSWORD_SIGN_IN_METHOD="password",a.EMAIL_LINK_SIGN_IN_METHOD="emailLink",a})();class Rt{constructor(r){this.providerId=r,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(r){this.defaultLanguageCode=r}setCustomParameters(r){return this.customParameters=r,this}getCustomParameters(){return this.customParameters}}class Zt extends Rt{constructor(){super(...arguments),this.scopes=[]}addScope(r){return this.scopes.includes(r)||this.scopes.push(r),this}getScopes(){return[...this.scopes]}}class Le extends Zt{static credentialFromJSON(r){const s="string"==typeof r?JSON.parse(r):r;return O("providerId"in s&&"signInMethod"in s,"argument-error"),Ht._fromParams(s)}credential(r){return this._credential(Object.assign(Object.assign({},r),{nonce:r.rawNonce}))}_credential(r){return O(r.idToken||r.accessToken,"argument-error"),Ht._fromParams(Object.assign(Object.assign({},r),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(r){return Le.oauthCredentialFromTaggedObject(r)}static credentialFromError(r){return Le.oauthCredentialFromTaggedObject(r.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:r}){if(!r)return null;const{oauthIdToken:s,oauthAccessToken:c,oauthTokenSecret:d,pendingToken:f,nonce:y,providerId:A}=r;if(!c&&!d&&!s&&!f||!A)return null;try{return new Le(A)._credential({idToken:s,accessToken:c,nonce:y,pendingToken:f})}catch{return null}}}let qe=(()=>{class a extends Zt{constructor(){super("facebook.com")}static credential(s){return Ht._fromParams({providerId:a.PROVIDER_ID,signInMethod:a.FACEBOOK_SIGN_IN_METHOD,accessToken:s})}static credentialFromResult(s){return a.credentialFromTaggedObject(s)}static credentialFromError(s){return a.credentialFromTaggedObject(s.customData||{})}static credentialFromTaggedObject({_tokenResponse:s}){if(!s||!("oauthAccessToken"in s)||!s.oauthAccessToken)return null;try{return a.credential(s.oauthAccessToken)}catch{return null}}}return a.FACEBOOK_SIGN_IN_METHOD="facebook.com",a.PROVIDER_ID="facebook.com",a})(),ro=(()=>{class a extends Zt{constructor(){super("google.com"),this.addScope("profile")}static credential(s,c){return Ht._fromParams({providerId:a.PROVIDER_ID,signInMethod:a.GOOGLE_SIGN_IN_METHOD,idToken:s,accessToken:c})}static credentialFromResult(s){return a.credentialFromTaggedObject(s)}static credentialFromError(s){return a.credentialFromTaggedObject(s.customData||{})}static credentialFromTaggedObject({_tokenResponse:s}){if(!s)return null;const{oauthIdToken:c,oauthAccessToken:d}=s;if(!c&&!d)return null;try{return a.credential(c,d)}catch{return null}}}return a.GOOGLE_SIGN_IN_METHOD="google.com",a.PROVIDER_ID="google.com",a})(),$a=(()=>{class a extends Zt{constructor(){super("github.com")}static credential(s){return Ht._fromParams({providerId:a.PROVIDER_ID,signInMethod:a.GITHUB_SIGN_IN_METHOD,accessToken:s})}static credentialFromResult(s){return a.credentialFromTaggedObject(s)}static credentialFromError(s){return a.credentialFromTaggedObject(s.customData||{})}static credentialFromTaggedObject({_tokenResponse:s}){if(!s||!("oauthAccessToken"in s)||!s.oauthAccessToken)return null;try{return a.credential(s.oauthAccessToken)}catch{return null}}}return a.GITHUB_SIGN_IN_METHOD="github.com",a.PROVIDER_ID="github.com",a})();class jn extends fr{constructor(r,s){super(r,r),this.pendingToken=s}_getIdTokenResponse(r){return St(r,this.buildRequest())}_linkToIdToken(r,s){const c=this.buildRequest();return c.idToken=s,St(r,c)}_getReauthenticationResolver(r){const s=this.buildRequest();return s.autoCreate=!1,St(r,s)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(r){const s="string"==typeof r?JSON.parse(r):r,{providerId:c,signInMethod:d,pendingToken:f}=s;return c&&d&&f&&c===d?new jn(c,f):null}static _create(r,s){return new jn(r,s)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Gi extends Rt{constructor(r){O(r.startsWith("saml."),"argument-error"),super(r)}static credentialFromResult(r){return Gi.samlCredentialFromTaggedObject(r)}static credentialFromError(r){return Gi.samlCredentialFromTaggedObject(r.customData||{})}static credentialFromJSON(r){const s=jn.fromJSON(r);return O(s,"argument-error"),s}static samlCredentialFromTaggedObject({_tokenResponse:r}){if(!r)return null;const{pendingToken:s,providerId:c}=r;if(!s||!c)return null;try{return jn._create(c,s)}catch{return null}}}let Ka=(()=>{class a extends Zt{constructor(){super("twitter.com")}static credential(s,c){return Ht._fromParams({providerId:a.PROVIDER_ID,signInMethod:a.TWITTER_SIGN_IN_METHOD,oauthToken:s,oauthTokenSecret:c})}static credentialFromResult(s){return a.credentialFromTaggedObject(s)}static credentialFromError(s){return a.credentialFromTaggedObject(s.customData||{})}static credentialFromTaggedObject({_tokenResponse:s}){if(!s)return null;const{oauthAccessToken:c,oauthTokenSecret:d}=s;if(!c||!d)return null;try{return a.credential(c,d)}catch{return null}}}return a.TWITTER_SIGN_IN_METHOD="twitter.com",a.PROVIDER_ID="twitter.com",a})();function so(a,r){return zi.apply(this,arguments)}function zi(){return(zi=(0,m.A)(function*(a,r){return We(a,"POST","/v1/accounts:signUp",fe(a,r))})).apply(this,arguments)}class dt{constructor(r){this.user=r.user,this.providerId=r.providerId,this._tokenResponse=r._tokenResponse,this.operationType=r.operationType}static _fromIdTokenResponse(r,s,c,d=!1){return(0,m.A)(function*(){const f=yield B._fromIdTokenResponse(r,c,d),y=oo(c);return new dt({user:f,providerId:y,_tokenResponse:c,operationType:s})})()}static _forOperation(r,s,c){return(0,m.A)(function*(){yield r._updateTokensIfNecessary(c,!0);const d=oo(c);return new dt({user:r,providerId:d,_tokenResponse:c,operationType:s})})()}}function oo(a){return a.providerId?a.providerId:"phoneNumber"in a?"phone":null}function qi(){return(qi=(0,m.A)(function*(a){var r;if((0,$._isFirebaseServerApp)(a.app))return Promise.reject(z(a));const s=Y(a);if(yield s._initializationPromise,null!==(r=s.currentUser)&&void 0!==r&&r.isAnonymous)return new dt({user:s.currentUser,providerId:null,operationType:"signIn"});const c=yield so(s,{returnSecureToken:!0}),d=yield dt._fromIdTokenResponse(s,"signIn",c,!0);return yield s._updateCurrentUser(d.user),d})).apply(this,arguments)}class Yr extends N.g{constructor(r,s,c,d){var f;super(s.code,s.message),this.operationType=c,this.user=d,Object.setPrototypeOf(this,Yr.prototype),this.customData={appName:r.name,tenantId:null!==(f=r.tenantId)&&void 0!==f?f:void 0,_serverResponse:s.customData._serverResponse,operationType:c}}static _fromErrorAndOperation(r,s,c,d){return new Yr(r,s,c,d)}}function Qr(a,r,s,c){return("reauthenticate"===r?s._getReauthenticationResolver(a):s._getIdTokenResponse(a)).catch(f=>{throw"auth/multi-factor-auth-required"===f.code?Yr._fromErrorAndOperation(a,f,r,c):f})}function za(a){return new Set(a.map(({providerId:r})=>r).filter(r=>!!r))}function Yi(){return Yi=(0,m.A)(function*(a,r){const s=(0,N.Ku)(a);yield Qi(!0,s,r);const{providerUserInfo:c}=yield function Ct(a,r){return Nn.apply(this,arguments)}(s.auth,{idToken:yield s.getIdToken(),deleteProvider:[r]}),d=za(c||[]);return s.providerData=s.providerData.filter(f=>d.has(f.providerId)),d.has("phone")||(s.phoneNumber=null),yield s.auth._persistUserIfCurrent(s),s}),Yi.apply(this,arguments)}function co(a,r){return lo.apply(this,arguments)}function lo(){return(lo=(0,m.A)(function*(a,r,s=!1){const c=yield yt(a,r._linkToIdToken(a.auth,yield a.getIdToken()),s);return dt._forOperation(a,"link",c)})).apply(this,arguments)}function Qi(a,r,s){return uo.apply(this,arguments)}function uo(){return(uo=(0,m.A)(function*(a,r,s){yield g(r);const d=!1===a?"provider-already-linked":"no-such-provider";O(za(r.providerData).has(s)===a,r.auth,d)})).apply(this,arguments)}function qa(a,r){return Ji.apply(this,arguments)}function Ji(){return(Ji=(0,m.A)(function*(a,r,s=!1){const{auth:c}=a;if((0,$._isFirebaseServerApp)(c.app))return Promise.reject(z(c));const d="reauthenticate";try{const f=yield yt(a,Qr(c,d,r,a),s);O(f.idToken,c,"internal-error");const y=Ut(f.idToken);O(y,c,"internal-error");const{sub:A}=y;return O(a.uid===A,c,"user-mismatch"),dt._forOperation(a,d,f)}catch(f){throw"auth/user-not-found"===f?.code&&me(c,"user-mismatch"),f}})).apply(this,arguments)}function ho(a,r){return Jr.apply(this,arguments)}function Jr(){return(Jr=(0,m.A)(function*(a,r,s=!1){if((0,$._isFirebaseServerApp)(a.app))return Promise.reject(z(a));const c="signIn",d=yield Qr(a,c,r),f=yield dt._fromIdTokenResponse(a,c,d);return s||(yield a._updateCurrentUser(f.user)),f})).apply(this,arguments)}function gr(a,r){return fo.apply(this,arguments)}function fo(){return(fo=(0,m.A)(function*(a,r){return ho(Y(a),r)})).apply(this,arguments)}function Ya(a,r){return Xi.apply(this,arguments)}function Xi(){return(Xi=(0,m.A)(function*(a,r){const s=(0,N.Ku)(a);return yield Qi(!1,s,r.providerId),co(s,r)})).apply(this,arguments)}function vn(a,r){return Xr.apply(this,arguments)}function Xr(){return(Xr=(0,m.A)(function*(a,r){return qa((0,N.Ku)(a),r)})).apply(this,arguments)}function Zi(){return(Zi=(0,m.A)(function*(a,r){return We(a,"POST","/v1/accounts:signInWithCustomToken",fe(a,r))})).apply(this,arguments)}function $n(){return $n=(0,m.A)(function*(a,r){if((0,$._isFirebaseServerApp)(a.app))return Promise.reject(z(a));const s=Y(a),c=yield function mr(a,r){return Zi.apply(this,arguments)}(s,{token:r,returnSecureToken:!0}),d=yield dt._fromIdTokenResponse(s,"signIn",c);return yield s._updateCurrentUser(d.user),d}),$n.apply(this,arguments)}class kt{constructor(r,s){this.factorId=r,this.uid=s.mfaEnrollmentId,this.enrollmentTime=new Date(s.enrolledAt).toUTCString(),this.displayName=s.displayName}static _fromServerResponse(r,s){return"phoneInfo"in s?es._fromServerResponse(r,s):"totpInfo"in s?ts._fromServerResponse(r,s):me(r,"internal-error")}}class es extends kt{constructor(r){super("phone",r),this.phoneNumber=r.phoneInfo}static _fromServerResponse(r,s){return new es(s)}}class ts extends kt{constructor(r){super("totp",r)}static _fromServerResponse(r,s){return new ts(s)}}function Oe(a,r,s){var c;O((null===(c=s.url)||void 0===c?void 0:c.length)>0,a,"invalid-continue-uri"),O(typeof s.dynamicLinkDomain>"u"||s.dynamicLinkDomain.length>0,a,"invalid-dynamic-link-domain"),O(typeof s.linkDomain>"u"||s.linkDomain.length>0,a,"invalid-hosting-link-domain"),r.continueUrl=s.url,r.dynamicLinkDomain=s.dynamicLinkDomain,r.linkDomain=s.linkDomain,r.canHandleCodeInApp=s.handleCodeInApp,s.iOS&&(O(s.iOS.bundleId.length>0,a,"missing-ios-bundle-id"),r.iOSBundleId=s.iOS.bundleId),s.android&&(O(s.android.packageName.length>0,a,"missing-android-pkg-name"),r.androidInstallApp=s.android.installApp,r.androidMinimumVersionCode=s.android.minimumVersion,r.androidPackageName=s.android.packageName)}function Kn(a){return Zr.apply(this,arguments)}function Zr(){return(Zr=(0,m.A)(function*(a){const r=Y(a);r._getPasswordPolicyInternal()&&(yield r._updatePasswordPolicy())})).apply(this,arguments)}function He(){return(He=(0,m.A)(function*(a,r,s){const c=Y(a),d={requestType:"PASSWORD_RESET",email:r,clientType:"CLIENT_TYPE_WEB"};s&&Oe(c,d,s),yield gn(c,d,"getOobCode",_l,"EMAIL_PASSWORD_PROVIDER")})).apply(this,arguments)}function vr(){return vr=(0,m.A)(function*(a,r,s){yield xa((0,N.Ku)(a),{oobCode:r,newPassword:s}).catch(function(){var c=(0,m.A)(function*(d){throw"auth/password-does-not-meet-requirements"===d.code&&Kn(a),d});return function(d){return c.apply(this,arguments)}}())}),vr.apply(this,arguments)}function jt(){return jt=(0,m.A)(function*(a,r){yield function pl(a,r){return Zs.apply(this,arguments)}((0,N.Ku)(a),{oobCode:r})}),jt.apply(this,arguments)}function $t(a,r){return en.apply(this,arguments)}function en(){return(en=(0,m.A)(function*(a,r){const s=(0,N.Ku)(a),c=yield xa(s,{oobCode:r}),d=c.requestType;switch(O(d,s,"internal-error"),d){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":O(c.newEmail,s,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":O(c.mfaInfo,s,"internal-error");default:O(c.email,s,"internal-error")}let f=null;return c.mfaInfo&&(f=kt._fromServerResponse(Y(s),c.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===c.requestType?c.newEmail:c.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===c.requestType?c.email:c.newEmail)||null,multiFactorInfo:f},operation:d}})).apply(this,arguments)}function Gn(){return(Gn=(0,m.A)(function*(a,r){const{data:s}=yield $t((0,N.Ku)(a),r);return s.email})).apply(this,arguments)}function ns(){return(ns=(0,m.A)(function*(a,r,s){if((0,$._isFirebaseServerApp)(a.app))return Promise.reject(z(a));const c=Y(a),y=yield gn(c,{returnSecureToken:!0,email:r,password:s,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",so,"EMAIL_PASSWORD_PROVIDER").catch(k=>{throw"auth/password-does-not-meet-requirements"===k.code&&Kn(a),k}),A=yield dt._fromIdTokenResponse(c,"signIn",y);return yield c._updateCurrentUser(A.user),A})).apply(this,arguments)}function _o(){return(_o=(0,m.A)(function*(a,r,s){const c=Y(a),d={requestType:"EMAIL_SIGNIN",email:r,clientType:"CLIENT_TYPE_WEB"};(function f(y,A){O(A.handleCodeInApp,c,"argument-error"),A&&Oe(c,y,A)})(d,s),yield gn(c,d,"getOobCode",Zu,"EMAIL_PASSWORD_PROVIDER")})).apply(this,arguments)}function go(){return(go=(0,m.A)(function*(a,r,s){if((0,$._isFirebaseServerApp)(a.app))return Promise.reject(z(a));const c=(0,N.Ku)(a),d=it.credentialWithLink(r,s||_t());return O(d._tenantId===(c.tenantId||null),c,"tenant-id-mismatch"),gr(c,d)})).apply(this,arguments)}function mo(){return(mo=(0,m.A)(function*(a,r){return he(a,"POST","/v1/accounts:createAuthUri",fe(a,r))})).apply(this,arguments)}function yn(){return yn=(0,m.A)(function*(a,r){const c={identifier:r,continueUri:Jt()?_t():"http://localhost"},{signinMethods:d}=yield function Sl(a,r){return mo.apply(this,arguments)}((0,N.Ku)(a),c);return d||[]}),yn.apply(this,arguments)}function zn(){return zn=(0,m.A)(function*(a,r){const s=(0,N.Ku)(a),d={requestType:"VERIFY_EMAIL",idToken:yield a.getIdToken()};r&&Oe(s.auth,d,r);const{email:f}=yield function Fa(a,r){return Ua.apply(this,arguments)}(s.auth,d);f!==a.email&&(yield a.reload())}),zn.apply(this,arguments)}function vo(){return vo=(0,m.A)(function*(a,r,s){const c=(0,N.Ku)(a),f={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield a.getIdToken(),newEmail:r};s&&Oe(c.auth,f,s);const{email:y}=yield function ed(a,r){return Wa.apply(this,arguments)}(c.auth,f);y!==a.email&&(yield a.reload())}),vo.apply(this,arguments)}function yr(){return(yr=(0,m.A)(function*(a,r){return he(a,"POST","/v1/accounts:update",r)})).apply(this,arguments)}function rs(){return rs=(0,m.A)(function*(a,{displayName:r,photoURL:s}){if(void 0===r&&void 0===s)return;const c=(0,N.Ku)(a),f={idToken:yield c.getIdToken(),displayName:r,photoUrl:s,returnSecureToken:!0},y=yield yt(c,function ei(a,r){return yr.apply(this,arguments)}(c.auth,f));c.displayName=y.displayName||null,c.photoURL=y.photoUrl||null;const A=c.providerData.find(({providerId:k})=>"password"===k);A&&(A.displayName=c.displayName,A.photoURL=c.photoURL),yield c._updateTokensIfNecessary(y)}),rs.apply(this,arguments)}function yo(a,r,s){return is.apply(this,arguments)}function is(){return is=(0,m.A)(function*(a,r,s){const{auth:c}=a,f={idToken:yield a.getIdToken(),returnSecureToken:!0};r&&(f.email=r),s&&(f.password=s);const y=yield yt(a,function La(a,r){return Hi.apply(this,arguments)}(c,f));yield a._updateTokensIfNecessary(y,!0)}),is.apply(this,arguments)}class In{constructor(r,s,c={}){this.isNewUser=r,this.providerId=s,this.profile=c}}class Io extends In{constructor(r,s,c,d){super(r,s,c),this.username=d}}class rc extends In{constructor(r,s){super(r,"facebook.com",s)}}class Eo extends Io{constructor(r,s){super(r,"github.com",s,"string"==typeof s?.login?s?.login:null)}}class Pl extends In{constructor(r,s){super(r,"google.com",s)}}class ic extends Io{constructor(r,s,c){super(r,"twitter.com",s,c)}}function Nl(a){const{user:r,_tokenResponse:s}=a;return r.isAnonymous&&!s?{providerId:null,isNewUser:!1,profile:null}:function nc(a){var r,s;if(!a)return null;const{providerId:c}=a,d=a.rawUserInfo?JSON.parse(a.rawUserInfo):{},f=a.isNewUser||"identitytoolkit#SignupNewUserResponse"===a.kind;if(!c&&a?.idToken){const y=null===(s=null===(r=Ut(a.idToken))||void 0===r?void 0:r.firebase)||void 0===s?void 0:s.sign_in_provider;if(y)return new In(f,"anonymous"!==y&&"custom"!==y?y:null)}if(!c)return null;switch(c){case"facebook.com":return new rc(f,d);case"github.com":return new Eo(f,d);case"google.com":return new Pl(f,d);case"twitter.com":return new ic(f,d,a.screenName||null);case"custom":case"anonymous":return new In(f,null);default:return new In(f,c,d)}}(s)}class qn{constructor(r,s,c){this.type=r,this.credential=s,this.user=c}static _fromIdtoken(r,s){return new qn("enroll",r,s)}static _fromMfaPendingCredential(r){return new qn("signin",r)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(r){var s,c;if(r?.multiFactorSession){if(null!==(s=r.multiFactorSession)&&void 0!==s&&s.pendingCredential)return qn._fromMfaPendingCredential(r.multiFactorSession.pendingCredential);if(null!==(c=r.multiFactorSession)&&void 0!==c&&c.idToken)return qn._fromIdtoken(r.multiFactorSession.idToken)}return null}}class wo{constructor(r,s,c){this.session=r,this.hints=s,this.signInResolver=c}static _fromError(r,s){const c=Y(r),d=s.customData._serverResponse,f=(d.mfaInfo||[]).map(A=>kt._fromServerResponse(c,A));O(d.mfaPendingCredential,c,"internal-error");const y=qn._fromMfaPendingCredential(d.mfaPendingCredential);return new wo(y,f,function(){var A=(0,m.A)(function*(k){const M=yield k._process(c,y);delete d.mfaInfo,delete d.mfaPendingCredential;const W=Object.assign(Object.assign({},d),{idToken:M.idToken,refreshToken:M.refreshToken});switch(s.operationType){case"signIn":const F=yield dt._fromIdTokenResponse(c,s.operationType,W);return yield c._updateCurrentUser(F.user),F;case"reauthenticate":return O(s.user,c,"internal-error"),dt._forOperation(s.user,s.operationType,W);default:me(c,"internal-error")}});return function(k){return A.apply(this,arguments)}}())}resolveSignIn(r){var s=this;return(0,m.A)(function*(){return s.signInResolver(r)})()}}function lc(a,r){return he(a,"POST","/v2/accounts/mfaEnrollment:start",fe(a,r))}class Co{constructor(r){this.user=r,this.enrolledFactors=[],r._onReload(s=>{s.mfaInfo&&(this.enrolledFactors=s.mfaInfo.map(c=>kt._fromServerResponse(r.auth,c)))})}static _fromUser(r){return new Co(r)}getSession(){var r=this;return(0,m.A)(function*(){return qn._fromIdtoken(yield r.user.getIdToken(),r.user)})()}enroll(r,s){var c=this;return(0,m.A)(function*(){const d=r,f=yield c.getSession(),y=yield yt(c.user,d._process(c.user.auth,f,s));return yield c.user._updateTokensIfNecessary(y),c.user.reload()})()}unenroll(r){var s=this;return(0,m.A)(function*(){const c="string"==typeof r?r:r.uid,d=yield s.user.getIdToken();try{const f=yield yt(s.user,function Vl(a,r){return he(a,"POST","/v2/accounts/mfaEnrollment:withdraw",fe(a,r))}(s.user.auth,{idToken:d,mfaEnrollmentId:c}));s.enrolledFactors=s.enrolledFactors.filter(({uid:y})=>y!==c),yield s.user._updateTokensIfNecessary(f),yield s.user.reload()}catch(f){throw f}})()}}const Kt=new WeakMap,ss="__sak";class dc{constructor(r,s){this.storageRetriever=r,this.type=s}_isAvailable(){try{return this.storage?(this.storage.setItem(ss,"1"),this.storage.removeItem(ss),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(r,s){return this.storage.setItem(r,JSON.stringify(s)),Promise.resolve()}_get(r){const s=this.storage.getItem(r);return Promise.resolve(s?JSON.parse(s):null)}_remove(r){return this.storage.removeItem(r),Promise.resolve()}get storage(){return this.storageRetriever()}}const as=(()=>{class a extends dc{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(s,c)=>this.onStorageEvent(s,c),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=b(),this._shouldAllowMigration=!0}forAllChangedKeys(s){for(const c of Object.keys(this.listeners)){const d=this.storage.getItem(c),f=this.localCache[c];d!==f&&s(c,f,d)}}onStorageEvent(s,c=!1){if(!s.key)return void this.forAllChangedKeys((A,k,M)=>{this.notifyListeners(A,M)});const d=s.key;c?this.detachListener():this.stopPolling();const f=()=>{const A=this.storage.getItem(d);!c&&this.localCache[d]===A||this.notifyListeners(d,A)},y=this.storage.getItem(d);!function xi(){return(0,N.lT)()&&10===document.documentMode}()||y===s.newValue||s.newValue===s.oldValue?f():setTimeout(f,10)}notifyListeners(s,c){this.localCache[s]=c;const d=this.listeners[s];if(d)for(const f of Array.from(d))f(c&&JSON.parse(c))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((s,c,d)=>{this.onStorageEvent(new StorageEvent("storage",{key:s,oldValue:c,newValue:d}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(s,c){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[s]||(this.listeners[s]=new Set,this.localCache[s]=this.storage.getItem(s)),this.listeners[s].add(c)}_removeListener(s,c){this.listeners[s]&&(this.listeners[s].delete(c),0===this.listeners[s].size&&delete this.listeners[s]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(s,c){var d=()=>super._set,f=this;return(0,m.A)(function*(){yield d().call(f,s,c),f.localCache[s]=JSON.stringify(c)})()}_get(s){var c=()=>super._get,d=this;return(0,m.A)(function*(){const f=yield c().call(d,s);return d.localCache[s]=JSON.stringify(f),f})()}_remove(s){var c=()=>super._remove,d=this;return(0,m.A)(function*(){yield c().call(d,s),delete d.localCache[s]})()}}return a.type="LOCAL",a})(),En=(()=>{class a extends dc{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(s,c){}_removeListener(s,c){}}return a.type="SESSION",a})();let So=(()=>{class a{constructor(s){this.eventTarget=s,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(s){const c=this.receivers.find(f=>f.isListeningto(s));if(c)return c;const d=new a(s);return this.receivers.push(d),d}isListeningto(s){return this.eventTarget===s}handleEvent(s){var c=this;return(0,m.A)(function*(){const d=s,{eventId:f,eventType:y,data:A}=d.data,k=c.handlersMap[y];if(!k?.size)return;d.ports[0].postMessage({status:"ack",eventId:f,eventType:y});const M=Array.from(k).map(function(){var F=(0,m.A)(function*(ce){return ce(d.origin,A)});return function(ce){return F.apply(this,arguments)}}()),W=yield function Hl(a){return Promise.all(a.map(function(){var r=(0,m.A)(function*(s){try{return{fulfilled:!0,value:yield s}}catch(c){return{fulfilled:!1,reason:c}}});return function(s){return r.apply(this,arguments)}}()))}(M);d.ports[0].postMessage({status:"done",eventId:f,eventType:y,response:W})})()}_subscribe(s,c){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[s]||(this.handlersMap[s]=new Set),this.handlersMap[s].add(c)}_unsubscribe(s,c){this.handlersMap[s]&&c&&this.handlersMap[s].delete(c),(!c||0===this.handlersMap[s].size)&&delete this.handlersMap[s],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return a.receivers=[],a})();function Er(a="",r=10){let s="";for(let c=0;c<r;c++)s+=Math.floor(10*Math.random());return a+s}class Bl{constructor(r){this.target=r,this.handlers=new Set}removeMessageHandler(r){r.messageChannel&&(r.messageChannel.port1.removeEventListener("message",r.onMessage),r.messageChannel.port1.close()),this.handlers.delete(r)}_send(r,s,c=50){var d=this;return(0,m.A)(function*(){const f=typeof MessageChannel<"u"?new MessageChannel:null;if(!f)throw new Error("connection_unavailable");let y,A;return new Promise((k,M)=>{const W=Er("",20);f.port1.start();const F=setTimeout(()=>{M(new Error("unsupported_event"))},c);A={messageChannel:f,onMessage(ce){const Ve=ce;if(Ve.data.eventId===W)switch(Ve.data.status){case"ack":clearTimeout(F),y=setTimeout(()=>{M(new Error("timeout"))},3e3);break;case"done":clearTimeout(y),k(Ve.data.response);break;default:clearTimeout(F),clearTimeout(y),M(new Error("invalid_response"))}}},d.handlers.add(A),f.port1.addEventListener("message",A.onMessage),d.target.postMessage({eventType:r,eventId:W,data:s},[f.port2])}).finally(()=>{A&&d.removeMessageHandler(A)})})()}}function De(){return window}function cs(){return typeof De().WorkerGlobalScope<"u"&&"function"==typeof De().importScripts}function ls(){return(ls=(0,m.A)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Ro="firebaseLocalStorageDb",ti="firebaseLocalStorage",ni="fbase_key";class Ar{constructor(r){this.request=r}toPromise(){return new Promise((r,s)=>{this.request.addEventListener("success",()=>{r(this.request.result)}),this.request.addEventListener("error",()=>{s(this.request.error)})})}}function ri(a,r){return a.transaction([ti],r?"readwrite":"readonly").objectStore(ti)}function de(){const a=indexedDB.open(Ro,1);return new Promise((r,s)=>{a.addEventListener("error",()=>{s(a.error)}),a.addEventListener("upgradeneeded",()=>{const c=a.result;try{c.createObjectStore(ti,{keyPath:ni})}catch(d){s(d)}}),a.addEventListener("success",(0,m.A)(function*(){const c=a.result;c.objectStoreNames.contains(ti)?r(c):(c.close(),yield function pe(){const a=indexedDB.deleteDatabase(Ro);return new Ar(a).toPromise()}(),r(yield de()))}))})}function ie(a,r,s){return Gt.apply(this,arguments)}function Gt(){return(Gt=(0,m.A)(function*(a,r,s){const c=ri(a,!0).put({[ni]:r,value:s});return new Ar(c).toPromise()})).apply(this,arguments)}function ii(){return(ii=(0,m.A)(function*(a,r){const s=ri(a,!1).get(r),c=yield new Ar(s).toPromise();return void 0===c?null:c.value})).apply(this,arguments)}function _c(a,r){const s=ri(a,!0).delete(r);return new Ar(s).toPromise()}const X=(()=>{class a{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var s=this;return(0,m.A)(function*(){return s.db||(s.db=yield de()),s.db})()}_withRetries(s){var c=this;return(0,m.A)(function*(){let d=0;for(;;)try{const f=yield c._openDb();return yield s(f)}catch(f){if(d++>3)throw f;c.db&&(c.db.close(),c.db=void 0)}})()}initializeServiceWorkerMessaging(){var s=this;return(0,m.A)(function*(){return cs()?s.initializeReceiver():s.initializeSender()})()}initializeReceiver(){var s=this;return(0,m.A)(function*(){s.receiver=So._getInstance(function $l(){return cs()?self:null}()),s.receiver._subscribe("keyChanged",function(){var c=(0,m.A)(function*(d,f){return{keyProcessed:(yield s._poll()).includes(f.key)}});return function(d,f){return c.apply(this,arguments)}}()),s.receiver._subscribe("ping",function(){var c=(0,m.A)(function*(d,f){return["keyChanged"]});return function(d,f){return c.apply(this,arguments)}}())})()}initializeSender(){var s=this;return(0,m.A)(function*(){var c,d;if(s.activeServiceWorker=yield function hc(){return ls.apply(this,arguments)}(),!s.activeServiceWorker)return;s.sender=new Bl(s.activeServiceWorker);const f=yield s.sender._send("ping",{},800);f&&null!==(c=f[0])&&void 0!==c&&c.fulfilled&&null!==(d=f[0])&&void 0!==d&&d.value.includes("keyChanged")&&(s.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(s){var c=this;return(0,m.A)(function*(){if(c.sender&&c.activeServiceWorker&&function fc(){var a;return(null===(a=navigator?.serviceWorker)||void 0===a?void 0:a.controller)||null}()===c.activeServiceWorker)try{yield c.sender._send("keyChanged",{key:s},c.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,m.A)(function*(){try{if(!indexedDB)return!1;const s=yield de();return yield ie(s,ss,"1"),yield _c(s,ss),!0}catch{}return!1})()}_withPendingWrite(s){var c=this;return(0,m.A)(function*(){c.pendingWrites++;try{yield s()}finally{c.pendingWrites--}})()}_set(s,c){var d=this;return(0,m.A)(function*(){return d._withPendingWrite((0,m.A)(function*(){return yield d._withRetries(f=>ie(f,s,c)),d.localCache[s]=c,d.notifyServiceWorker(s)}))})()}_get(s){var c=this;return(0,m.A)(function*(){const d=yield c._withRetries(f=>function ye(a,r){return ii.apply(this,arguments)}(f,s));return c.localCache[s]=d,d})()}_remove(s){var c=this;return(0,m.A)(function*(){return c._withPendingWrite((0,m.A)(function*(){return yield c._withRetries(d=>_c(d,s)),delete c.localCache[s],c.notifyServiceWorker(s)}))})()}_poll(){var s=this;return(0,m.A)(function*(){const c=yield s._withRetries(y=>{const A=ri(y,!1).getAll();return new Ar(A).toPromise()});if(!c)return[];if(0!==s.pendingWrites)return[];const d=[],f=new Set;if(0!==c.length)for(const{fbase_key:y,value:A}of c)f.add(y),JSON.stringify(s.localCache[y])!==JSON.stringify(A)&&(s.notifyListeners(y,A),d.push(y));for(const y of Object.keys(s.localCache))s.localCache[y]&&!f.has(y)&&(s.notifyListeners(y,null),d.push(y));return d})()}notifyListeners(s,c){this.localCache[s]=c;const d=this.listeners[s];if(d)for(const f of Array.from(d))f(c)}startPolling(){var s=this;this.stopPolling(),this.pollTimer=setInterval((0,m.A)(function*(){return s._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(s,c){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[s]||(this.listeners[s]=new Set,this._get(s)),this.listeners[s].add(c)}_removeListener(s,c){this.listeners[s]&&(this.listeners[s].delete(c),0===this.listeners[s].size&&delete this.listeners[s]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return a.type="LOCAL",a})();function Ye(a,r){return he(a,"POST","/v2/accounts/mfaSignIn:start",fe(a,r))}const st=Li("rcb"),Gl=new gt(3e4,6e4);class zl{constructor(){var r;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(r=De().grecaptcha)||void 0===r||!r.render)}load(r,s=""){return O(function ql(a){return a.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(a)}(s),r,"argument-error"),this.shouldResolveImmediately(s)&&Hr(De().grecaptcha)?Promise.resolve(De().grecaptcha):new Promise((c,d)=>{const f=De().setTimeout(()=>{d(Ae(r,"network-request-failed"))},Gl.get());De()[st]=()=>{De().clearTimeout(f),delete De()[st];const A=De().grecaptcha;if(!A||!Hr(A))return void d(Ae(r,"internal-error"));const k=A.render;A.render=(M,W)=>{const F=k(M,W);return this.counter++,F},this.hostLanguage=s,c(A)},Ks(`${function Gs(){return It.recaptchaV2Script}()}?${(0,N.Am)({onload:st,render:"explicit",hl:s})}`).catch(()=>{clearTimeout(f),d(Ae(r,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(r){var s;return!(null===(s=De().grecaptcha)||void 0===s||!s.render)&&(r===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class mc{load(r){return(0,m.A)(function*(){return new al(r)})()}clearedOneInstance(){}}const Pt="recaptcha",Po={theme:"light",type:"image"};class oi{constructor(r,s,c=Object.assign({},Po)){this.parameters=c,this.type=Pt,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Y(r),this.isInvisible="invisible"===this.parameters.size,O(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const d="string"==typeof s?document.getElementById(s):s;O(d,this.auth,"argument-error"),this.container=d,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new mc:new zl,this.validateStartingState()}verify(){var r=this;return(0,m.A)(function*(){r.assertNotDestroyed();const s=yield r.render(),c=r.getAssertedRecaptcha();return c.getResponse(s)||new Promise(f=>{const y=A=>{A&&(r.tokenChangeListeners.delete(y),f(A))};r.tokenChangeListeners.add(y),r.isInvisible&&c.execute(s)})})()}render(){try{this.assertNotDestroyed()}catch(r){return Promise.reject(r)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(r=>{throw this.renderPromise=null,r})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(r=>{this.container.removeChild(r)})}validateStartingState(){O(!this.parameters.sitekey,this.auth,"argument-error"),O(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),O(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(r){return s=>{if(this.tokenChangeListeners.forEach(c=>c(s)),"function"==typeof r)r(s);else if("string"==typeof r){const c=De()[r];"function"==typeof c&&c(s)}}}assertNotDestroyed(){O(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var r=this;return(0,m.A)(function*(){if(yield r.init(),!r.widgetId){let s=r.container;if(!r.isInvisible){const c=document.createElement("div");s.appendChild(c),s=c}r.widgetId=r.getAssertedRecaptcha().render(s,r.parameters)}return r.widgetId})()}init(){var r=this;return(0,m.A)(function*(){O(Jt()&&!cs(),r.auth,"internal-error"),yield function Yl(){let a=null;return new Promise(r=>{"complete"!==document.readyState?(a=()=>r(),window.addEventListener("load",a)):r()}).catch(r=>{throw a&&window.removeEventListener("load",a),r})}(),r.recaptcha=yield r._recaptchaLoader.load(r.auth,r.auth.languageCode||void 0);const s=yield function mt(a){return kn.apply(this,arguments)}(r.auth);O(s,r.auth,"internal-error"),r.parameters.sitekey=s})()}getAssertedRecaptcha(){return O(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class us{constructor(r,s){this.verificationId=r,this.onConfirmation=s}confirm(r){const s=_r._fromVerification(this.verificationId,r);return this.onConfirmation(s)}}function No(){return(No=(0,m.A)(function*(a,r,s){if((0,$._isFirebaseServerApp)(a.app))return Promise.reject(z(a));const c=Y(a),d=yield Qn(c,r,(0,N.Ku)(s));return new us(d,f=>gr(c,f))})).apply(this,arguments)}function ds(){return(ds=(0,m.A)(function*(a,r,s){const c=(0,N.Ku)(a);yield Qi(!1,c,"phone");const d=yield Qn(c.auth,r,(0,N.Ku)(s));return new us(d,f=>Ya(c,f))})).apply(this,arguments)}function se(){return(se=(0,m.A)(function*(a,r,s){const c=(0,N.Ku)(a);if((0,$._isFirebaseServerApp)(c.auth.app))return Promise.reject(z(c.auth));const d=yield Qn(c.auth,r,(0,N.Ku)(s));return new us(d,f=>vn(c,f))})).apply(this,arguments)}function Qn(a,r,s){return Tr.apply(this,arguments)}function Tr(){return Tr=(0,m.A)(function*(a,r,s){var c;if(!a._getRecaptchaConfig())try{yield function Hn(a){return Wi.apply(this,arguments)}(a)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let d;if(d="string"==typeof r?{phoneNumber:r}:r,"session"in d){const f=d.session;if("phoneNumber"in d){O("enroll"===f.type,a,"internal-error");const y={idToken:f.credential,phoneEnrollmentInfo:{phoneNumber:d.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(yield gn(a,y,"mfaSmsEnrollment",function(){var W=(0,m.A)(function*(F,ce){return ce.phoneEnrollmentInfo.captchaResponse===Vn?(O(s?.type===Pt,F,"argument-error"),lc(F,yield wr(F,ce,s))):lc(F,ce)});return function(ce,Ve){return W.apply(this,arguments)}}(),"PHONE_PROVIDER").catch(W=>Promise.reject(W))).phoneSessionInfo.sessionInfo}{O("signin"===f.type,a,"internal-error");const y=(null===(c=d.multiFactorHint)||void 0===c?void 0:c.uid)||d.multiFactorUid;O(y,a,"missing-multi-factor-info");const A={mfaPendingCredential:f.credential,mfaEnrollmentId:y,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(yield gn(a,A,"mfaSmsSignIn",function(){var F=(0,m.A)(function*(ce,Ve){return Ve.phoneSignInInfo.captchaResponse===Vn?(O(s?.type===Pt,ce,"argument-error"),Ye(ce,yield wr(ce,Ve,s))):Ye(ce,Ve)});return function(Ve,rr){return F.apply(this,arguments)}}(),"PHONE_PROVIDER").catch(F=>Promise.reject(F))).phoneResponseInfo.sessionInfo}}{const f={phoneNumber:d.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(yield gn(a,f,"sendVerificationCode",function(){var M=(0,m.A)(function*(W,F){return F.captchaResponse===Vn?(O(s?.type===Pt,W,"argument-error"),vl(W,yield wr(W,F,s))):vl(W,F)});return function(F,ce){return M.apply(this,arguments)}}(),"PHONE_PROVIDER").catch(M=>Promise.reject(M))).sessionInfo}}finally{s?._reset()}}),Tr.apply(this,arguments)}function Et(){return(Et=(0,m.A)(function*(a,r){const s=(0,N.Ku)(a);if((0,$._isFirebaseServerApp)(s.auth.app))return Promise.reject(z(s.auth));yield co(s,r)})).apply(this,arguments)}function wr(a,r,s){return ht.apply(this,arguments)}function ht(){return(ht=(0,m.A)(function*(a,r,s){O(s.type===Pt,a,"argument-error");const c=yield s.verify();O("string"==typeof c,a,"argument-error");const d=Object.assign({},r);return"phoneEnrollmentInfo"in d?(Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:d.phoneEnrollmentInfo.phoneNumber,recaptchaToken:c,captchaResponse:d.phoneEnrollmentInfo.captchaResponse,clientType:d.phoneEnrollmentInfo.clientType,recaptchaVersion:d.phoneEnrollmentInfo.recaptchaVersion}}),d):"phoneSignInInfo"in d?(Object.assign(d,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:d.phoneSignInInfo.captchaResponse,clientType:d.phoneSignInInfo.clientType,recaptchaVersion:d.phoneSignInInfo.recaptchaVersion}}),d):(Object.assign(d,{recaptchaToken:c}),d)})).apply(this,arguments)}let ai=(()=>{class a{constructor(s){this.providerId=a.PROVIDER_ID,this.auth=Y(s)}verifyPhoneNumber(s,c){return Qn(this.auth,s,(0,N.Ku)(c))}static credential(s,c){return _r._fromVerification(s,c)}static credentialFromResult(s){return a.credentialFromTaggedObject(s)}static credentialFromError(s){return a.credentialFromTaggedObject(s.customData||{})}static credentialFromTaggedObject({_tokenResponse:s}){if(!s)return null;const{phoneNumber:c,temporaryProof:d}=s;return c&&d?_r._fromTokenResponse(c,d):null}}return a.PROVIDER_ID="phone",a.PHONE_SIGN_IN_METHOD="phone",a})();function Me(a,r){return r?re(r):(O(a._popupRedirectResolver,a,"argument-error"),a._popupRedirectResolver)}class Oo extends fr{constructor(r){super("custom","custom"),this.params=r}_getIdTokenResponse(r){return St(r,this._buildIdpRequest())}_linkToIdToken(r,s){return St(r,this._buildIdpRequest(s))}_getReauthenticationResolver(r){return St(r,this._buildIdpRequest())}_buildIdpRequest(r){const s={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return r&&(s.idToken=r),s}}function Do(a){return ho(a.auth,new Oo(a),a.bypassAuthState)}function xo(a){const{auth:r,user:s}=a;return O(s,r,"internal-error"),qa(s,new Oo(a),a.bypassAuthState)}function Xl(a){return hs.apply(this,arguments)}function hs(){return(hs=(0,m.A)(function*(a){const{auth:r,user:s}=a;return O(s,r,"internal-error"),co(s,new Oo(a),a.bypassAuthState)})).apply(this,arguments)}class Lo{constructor(r,s,c,d,f=!1){this.auth=r,this.resolver=c,this.user=d,this.bypassAuthState=f,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(s)?s:[s]}execute(){var r=this;return new Promise(function(){var s=(0,m.A)(function*(c,d){r.pendingPromise={resolve:c,reject:d};try{r.eventManager=yield r.resolver._initialize(r.auth),yield r.onExecution(),r.eventManager.registerConsumer(r)}catch(f){r.reject(f)}});return function(c,d){return s.apply(this,arguments)}}())}onAuthEvent(r){var s=this;return(0,m.A)(function*(){const{urlResponse:c,sessionId:d,postBody:f,tenantId:y,error:A,type:k}=r;if(A)return void s.reject(A);const M={auth:s.auth,requestUri:c,sessionId:d,tenantId:y||void 0,postBody:f||void 0,user:s.user,bypassAuthState:s.bypassAuthState};try{s.resolve(yield s.getIdpTask(k)(M))}catch(W){s.reject(W)}})()}onError(r){this.reject(r)}getIdpTask(r){switch(r){case"signInViaPopup":case"signInViaRedirect":return Do;case"linkViaPopup":case"linkViaRedirect":return Xl;case"reauthViaPopup":case"reauthViaRedirect":return xo;default:me(this.auth,"internal-error")}}resolve(r){Ke(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(r),this.unregisterAndCleanUp()}reject(r){Ke(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(r),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const yc=new gt(2e3,1e4);function fs(){return(fs=(0,m.A)(function*(a,r,s){if((0,$._isFirebaseServerApp)(a.app))return Promise.reject(Ae(a,"operation-not-supported-in-this-environment"));const c=Y(a);Ue(a,r,Rt);const d=Me(c,s);return new ge(c,"signInViaPopup",r,d).executeNotNull()})).apply(this,arguments)}function Mo(){return(Mo=(0,m.A)(function*(a,r,s){const c=(0,N.Ku)(a);if((0,$._isFirebaseServerApp)(c.auth.app))return Promise.reject(Ae(c.auth,"operation-not-supported-in-this-environment"));Ue(c.auth,r,Rt);const d=Me(c.auth,s);return new ge(c.auth,"reauthViaPopup",r,d,c).executeNotNull()})).apply(this,arguments)}function Fo(){return(Fo=(0,m.A)(function*(a,r,s){const c=(0,N.Ku)(a);Ue(c.auth,r,Rt);const d=Me(c.auth,s);return new ge(c.auth,"linkViaPopup",r,d,c).executeNotNull()})).apply(this,arguments)}let ge=(()=>{class a extends Lo{constructor(s,c,d,f,y){super(s,c,f,y),this.provider=d,this.authWindow=null,this.pollId=null,a.currentPopupAction&&a.currentPopupAction.cancel(),a.currentPopupAction=this}executeNotNull(){var s=this;return(0,m.A)(function*(){const c=yield s.execute();return O(c,s.auth,"internal-error"),c})()}onExecution(){var s=this;return(0,m.A)(function*(){Ke(1===s.filter.length,"Popup operations only handle one event");const c=Er();s.authWindow=yield s.resolver._openPopup(s.auth,s.provider,s.filter[0],c),s.authWindow.associatedEvent=c,s.resolver._originValidation(s.auth).catch(d=>{s.reject(d)}),s.resolver._isIframeWebStorageSupported(s.auth,d=>{d||s.reject(Ae(s.auth,"web-storage-unsupported"))}),s.pollUserCancellation()})()}get eventId(){var s;return(null===(s=this.authWindow)||void 0===s?void 0:s.associatedEvent)||null}cancel(){this.reject(Ae(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,a.currentPopupAction=null}pollUserCancellation(){const s=()=>{var c,d;this.pollId=null!==(d=null===(c=this.authWindow)||void 0===c?void 0:c.window)&&void 0!==d&&d.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Ae(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(s,yc.get())};s()}}return a.currentPopupAction=null,a})();const ci=new Map;class ps extends Lo{constructor(r,s,c=!1){super(r,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],s,void 0,c),this.eventId=null}execute(){var r=()=>super.execute,s=this;return(0,m.A)(function*(){let c=ci.get(s.auth._key());if(!c){try{const f=(yield function Uo(a,r){return An.apply(this,arguments)}(s.resolver,s.auth))?yield r().call(s):null;c=()=>Promise.resolve(f)}catch(d){c=()=>Promise.reject(d)}ci.set(s.auth._key(),c)}return s.bypassAuthState||ci.set(s.auth._key(),()=>Promise.resolve(null)),c()})()}onAuthEvent(r){var s=()=>super.onAuthEvent,c=this;return(0,m.A)(function*(){if("signInViaRedirect"===r.type)return s().call(c,r);if("unknown"!==r.type){if(r.eventId){const d=yield c.auth._redirectUserForId(r.eventId);if(d)return c.user=d,s().call(c,r);c.resolve(null)}}else c.resolve(null)})()}onExecution(){return(0,m.A)(function*(){})()}cleanUp(){}}function An(){return(An=(0,m.A)(function*(a,r){const s=Ec(r),c=br(a);if(!(yield c._isAvailable()))return!1;const d="true"===(yield c._get(s));return yield c._remove(s),d})).apply(this,arguments)}function Nt(a,r){return Jn.apply(this,arguments)}function Jn(){return(Jn=(0,m.A)(function*(a,r){return br(a)._set(Ec(r),"true")})).apply(this,arguments)}function Vo(a,r){ci.set(a._key(),r)}function br(a){return re(a._redirectPersistence)}function Ec(a){return ue("pendingRedirect",a.config.apiKey,a.name)}function Ho(){return(Ho=(0,m.A)(function*(a,r,s){if((0,$._isFirebaseServerApp)(a.app))return Promise.reject(z(a));const c=Y(a);Ue(a,r,Rt),yield c._initializationPromise;const d=Me(c,s);return yield Nt(d,c),d._openRedirect(c,r,"signInViaRedirect")})).apply(this,arguments)}function Tn(){return(Tn=(0,m.A)(function*(a,r,s){const c=(0,N.Ku)(a);if(Ue(c.auth,r,Rt),(0,$._isFirebaseServerApp)(c.auth.app))return Promise.reject(z(c.auth));yield c.auth._initializationPromise;const d=Me(c.auth,s);yield Nt(d,c.auth);const f=yield Tc(c);return d._openRedirect(c.auth,r,"reauthViaRedirect",f)})).apply(this,arguments)}function jo(){return(jo=(0,m.A)(function*(a,r,s){const c=(0,N.Ku)(a);Ue(c.auth,r,Rt),yield c.auth._initializationPromise;const d=Me(c.auth,s);yield Qi(!1,c,r.providerId),yield Nt(d,c.auth);const f=yield Tc(c);return d._openRedirect(c.auth,r,"linkViaRedirect",f)})).apply(this,arguments)}function Xn(){return(Xn=(0,m.A)(function*(a,r){return yield Y(a)._initializationPromise,_s(a,r,!1)})).apply(this,arguments)}function _s(a,r){return Sr.apply(this,arguments)}function Sr(){return(Sr=(0,m.A)(function*(a,r,s=!1){if((0,$._isFirebaseServerApp)(a.app))return Promise.reject(z(a));const c=Y(a),d=Me(c,r),y=yield new ps(c,d,s).execute();return y&&!s&&(delete y.user._redirectEventId,yield c._persistUserIfCurrent(y.user),yield c._setRedirectUser(null,r)),y})).apply(this,arguments)}function Tc(a){return Ko.apply(this,arguments)}function Ko(){return(Ko=(0,m.A)(function*(a){const r=Er(`${a.uid}:::`);return a._redirectEventId=r,yield a.auth._setRedirectUser(a),yield a.auth._persistUserIfCurrent(a),r})).apply(this,arguments)}class gs{constructor(r){this.auth=r,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(r){this.consumers.add(r),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,r)&&(this.sendToConsumer(this.queuedRedirectEvent,r),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(r){this.consumers.delete(r)}onEvent(r){if(this.hasEventBeenHandled(r))return!1;let s=!1;return this.consumers.forEach(c=>{this.isEventForConsumer(r,c)&&(s=!0,this.sendToConsumer(r,c),this.saveEventToCache(r))}),this.hasHandledPotentialRedirect||!function nu(a){switch(a.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ms(a);default:return!1}}(r)||(this.hasHandledPotentialRedirect=!0,s||(this.queuedRedirectEvent=r,s=!0)),s}sendToConsumer(r,s){var c;if(r.error&&!ms(r)){const d=(null===(c=r.error.code)||void 0===c?void 0:c.split("auth/")[1])||"internal-error";s.onError(Ae(this.auth,d))}else s.onAuthEvent(r)}isEventForConsumer(r,s){const c=null===s.eventId||!!r.eventId&&r.eventId===s.eventId;return s.filter.includes(r.type)&&c}hasEventBeenHandled(r){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(wc(r))}saveEventToCache(r){this.cachedEventUids.add(wc(r)),this.lastProcessedEventTime=Date.now()}}function wc(a){return[a.type,a.eventId,a.sessionId,a.tenantId].filter(r=>r).join("-")}function ms({type:a,error:r}){return"unknown"===a&&"auth/no-auth-event"===r?.code}function di(a){return vs.apply(this,arguments)}function vs(){return(vs=(0,m.A)(function*(a,r={}){return he(a,"GET","/v1/projects",r)})).apply(this,arguments)}const Cc=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ys=/^https?/;function Rr(){return(Rr=(0,m.A)(function*(a){if(a.config.emulator)return;const{authorizedDomains:r}=yield di(a);for(const s of r)try{if(kr(s))return}catch{}me(a,"unauthorized-domain")})).apply(this,arguments)}function kr(a){const r=_t(),{protocol:s,hostname:c}=new URL(r);if(a.startsWith("chrome-extension://")){const y=new URL(a);return""===y.hostname&&""===c?"chrome-extension:"===s&&a.replace("chrome-extension://","")===r.replace("chrome-extension://",""):"chrome-extension:"===s&&y.hostname===c}if(!ys.test(s))return!1;if(Cc.test(a))return c===a;const d=a.replace(/\./g,"\\.");return new RegExp("^(.+\\."+d+"|"+d+")$","i").test(c)}const Go=new gt(3e4,6e4);function Is(){const a=De().___jsl;if(a?.H)for(const r of Object.keys(a.H))if(a.H[r].r=a.H[r].r||[],a.H[r].L=a.H[r].L||[],a.H[r].r=[...a.H[r].L],a.CP)for(let s=0;s<a.CP.length;s++)a.CP[s]=null}let Es=null;const su=new gt(5e3,15e3),zt={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},zo=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function qo(a){const r=a.config;O(r.authDomain,a,"auth-domain-config-required");const s=r.emulator?dn(r,"emulator/auth/iframe"):`https://${a.config.authDomain}/__/auth/iframe`,c={apiKey:r.apiKey,appName:a.name,v:$.SDK_VERSION},d=zo.get(a.config.apiHost);d&&(c.eid=d);const f=a._getFrameworks();return f.length&&(c.fw=f.join(",")),`${s}?${(0,N.Am)(c).slice(1)}`}function Pr(){return Pr=(0,m.A)(function*(a){const r=yield function bc(a){return Es=Es||function iu(a){return new Promise((r,s)=>{var c,d,f;function y(){Is(),gapi.load("gapi.iframes",{callback:()=>{r(gapi.iframes.getContext())},ontimeout:()=>{Is(),s(Ae(a,"network-request-failed"))},timeout:Go.get()})}if(null!==(d=null===(c=De().gapi)||void 0===c?void 0:c.iframes)&&void 0!==d&&d.Iframe)r(gapi.iframes.getContext());else{if(null===(f=De().gapi)||void 0===f||!f.load){const A=Li("iframefcb");return De()[A]=()=>{gapi.load?y():s(Ae(a,"network-request-failed"))},Ks(`${function ol(){return It.gapiScript}()}?onload=${A}`).catch(k=>s(k))}y()}}).catch(r=>{throw Es=null,r})}(a),Es}(a),s=De().gapi;return O(s,a,"internal-error"),r.open({where:document.body,url:qo(a),messageHandlersFilter:s.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:zt,dontclear:!0},c=>new Promise(function(){var d=(0,m.A)(function*(f,y){yield c.restyle({setHideOnLeave:!1});const A=Ae(a,"network-request-failed"),k=De().setTimeout(()=>{y(A)},su.get());function M(){De().clearTimeout(k),f(c)}c.ping(M).then(M,()=>{y(A)})});return function(f,y){return d.apply(this,arguments)}}()))}),Pr.apply(this,arguments)}const hi={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Sc{constructor(r){this.window=r,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const pi=encodeURIComponent("fac");function Ts(a,r,s,c,d,f){return Or.apply(this,arguments)}function Or(){return(Or=(0,m.A)(function*(a,r,s,c,d,f){O(a.config.authDomain,a,"auth-domain-config-required"),O(a.config.apiKey,a,"invalid-api-key");const y={apiKey:a.config.apiKey,appName:a.name,authType:s,redirectUrl:c,v:$.SDK_VERSION,eventId:d};if(r instanceof Rt){r.setDefaultLanguage(a.languageCode),y.providerId=r.providerId||"",(0,N.Im)(r.getCustomParameters())||(y.customParameters=JSON.stringify(r.getCustomParameters()));for(const[W,F]of Object.entries(f||{}))y[W]=F}if(r instanceof Zt){const W=r.getScopes().filter(F=>""!==F);W.length>0&&(y.scopes=W.join(","))}a.tenantId&&(y.tid=a.tenantId);const A=y;for(const W of Object.keys(A))void 0===A[W]&&delete A[W];const k=yield a._getAppCheckToken(),M=k?`#${pi}=${encodeURIComponent(k)}`:"";return`${function er({config:a}){return a.emulator?dn(a,"emulator/auth/handler"):`https://${a.authDomain}/__/auth/handler`}(a)}?${(0,N.Am)(A).slice(1)}${M}`})).apply(this,arguments)}const _i="webStorageSupport",Ie=class du{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=En,this._completeRedirectFn=_s,this._overrideRedirectResult=Vo}_openPopup(r,s,c,d){var f=this;return(0,m.A)(function*(){var y;Ke(null===(y=f.eventManagers[r._key()])||void 0===y?void 0:y.manager,"_initialize() not called before _openPopup()");const A=yield Ts(r,s,c,_t(),d);return function fi(a,r,s,c=500,d=600){const f=Math.max((window.screen.availHeight-d)/2,0).toString(),y=Math.max((window.screen.availWidth-c)/2,0).toString();let A="";const k=Object.assign(Object.assign({},hi),{width:c.toString(),height:d.toString(),top:f,left:y}),M=(0,N.ZQ)().toLowerCase();s&&(A=xn(M)?"_blank":s),ut(M)&&(r=r||"http://localhost",k.scrollbars="yes");const W=Object.entries(k).reduce((ce,[Ve,rr])=>`${ce}${Ve}=${rr},`,"");if(function Fn(a=(0,N.ZQ)()){var r;return Mn(a)&&!(null===(r=window.navigator)||void 0===r||!r.standalone)}(M)&&"_self"!==A)return function lu(a,r){const s=document.createElement("a");s.href=a,s.target=r;const c=document.createEvent("MouseEvent");c.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),s.dispatchEvent(c)}(r||"",A),new Sc(null);const F=window.open(r||"",A,W);O(F,a,"popup-blocked");try{F.focus()}catch{}return new Sc(F)}(r,A,Er())})()}_openRedirect(r,s,c,d){var f=this;return(0,m.A)(function*(){return yield f._originValidation(r),function jl(a){De().location.href=a}(yield Ts(r,s,c,_t(),d)),new Promise(()=>{})})()}_initialize(r){const s=r._key();if(this.eventManagers[s]){const{manager:d,promise:f}=this.eventManagers[s];return d?Promise.resolve(d):(Ke(f,"If manager is not set, promise should be"),f)}const c=this.initAndGetManager(r);return this.eventManagers[s]={promise:c},c.catch(()=>{delete this.eventManagers[s]}),c}initAndGetManager(r){var s=this;return(0,m.A)(function*(){const c=yield function Yo(a){return Pr.apply(this,arguments)}(r),d=new gs(r);return c.register("authEvent",f=>(O(f?.authEvent,r,"invalid-auth-event"),{status:d.onEvent(f.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),s.eventManagers[r._key()]={manager:d},s.iframes[r._key()]=c,d})()}_isIframeWebStorageSupported(r,s){this.iframes[r._key()].send(_i,{type:_i},d=>{var f;const y=null===(f=d?.[0])||void 0===f?void 0:f[_i];void 0!==y&&s(!!y),me(r,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(r){const s=r._key();return this.originValidationPromises[s]||(this.originValidationPromises[s]=function ru(a){return Rr.apply(this,arguments)}(r)),this.originValidationPromises[s]}get _shouldInitProactively(){return b()||Wt()||Mn()}};class At{constructor(r){this.factorId=r}_process(r,s,c){switch(s.type){case"enroll":return this._finalizeEnroll(r,s.credential,c);case"signin":return this._finalizeSignIn(r,s.credential);default:return xe("unexpected MultiFactorSessionType")}}}class tr extends At{constructor(r){super("phone"),this.credential=r}static _fromCredential(r){return new tr(r)}_finalizeEnroll(r,s,c){return function uc(a,r){return he(a,"POST","/v2/accounts/mfaEnrollment:finalize",fe(a,r))}(r,{idToken:s,displayName:c,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(r,s){return function Kl(a,r){return he(a,"POST","/v2/accounts/mfaSignIn:finalize",fe(a,r))}(r,{mfaPendingCredential:s,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Qo=(()=>{class a{constructor(){}static assertion(s){return tr._fromCredential(s)}}return a.FACTOR_ID="phone",a})();var tn="@firebase/auth";class Dr{constructor(r){this.auth=r,this.internalListeners=new Map}getUid(){var r;return this.assertAuthConfigured(),(null===(r=this.auth.currentUser)||void 0===r?void 0:r.uid)||null}getToken(r){var s=this;return(0,m.A)(function*(){return s.assertAuthConfigured(),yield s.auth._initializationPromise,s.auth.currentUser?{accessToken:yield s.auth.currentUser.getIdToken(r)}:null})()}addAuthTokenListener(r){if(this.assertAuthConfigured(),this.internalListeners.has(r))return;const s=this.auth.onIdTokenChanged(c=>{r(c?.stsTokenManager.accessToken||null)});this.internalListeners.set(r,s),this.updateProactiveRefresh()}removeAuthTokenListener(r){this.assertAuthConfigured();const s=this.internalListeners.get(r);s&&(this.internalListeners.delete(r),s(),this.updateProactiveRefresh())}assertAuthConfigured(){O(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function nr(){return window}function Jo(){return Jo=(0,m.A)(function*(a,r,s){var c;const{BuildInfo:d}=nr();Ke(r.sessionId,"AuthEvent did not contain a session ID");const f=yield function ea(a){return Ss.apply(this,arguments)}(r.sessionId),y={};return Mn()?y.ibi=d.packageName:Ln()?y.apn=d.packageName:me(a,"operation-not-supported-in-this-environment"),d.displayName&&(y.appDisplayName=d.displayName),y.sessionId=f,Ts(a,s,r.type,void 0,null!==(c=r.eventId)&&void 0!==c?c:void 0,y)}),Jo.apply(this,arguments)}function Xo(){return(Xo=(0,m.A)(function*(a){const{BuildInfo:r}=nr(),s={};Mn()?s.iosBundleId=r.packageName:Ln()?s.androidPackageName=r.packageName:me(a,"operation-not-supported-in-this-environment"),yield di(a,s)})).apply(this,arguments)}function Zo(){return(Zo=(0,m.A)(function*(a,r,s){const{cordova:c}=nr();let d=()=>{};try{yield new Promise((f,y)=>{let A=null;function k(){var F;f();const ce=null===(F=c.plugins.browsertab)||void 0===F?void 0:F.close;"function"==typeof ce&&ce(),"function"==typeof s?.close&&s.close()}function M(){A||(A=window.setTimeout(()=>{y(Ae(a,"redirect-cancelled-by-user"))},2e3))}function W(){"visible"===document?.visibilityState&&M()}r.addPassiveListener(k),document.addEventListener("resume",M,!1),Ln()&&document.addEventListener("visibilitychange",W,!1),d=()=>{r.removePassiveListener(k),document.removeEventListener("resume",M,!1),document.removeEventListener("visibilitychange",W,!1),A&&window.clearTimeout(A)}})}finally{d()}})).apply(this,arguments)}function Ss(){return(Ss=(0,m.A)(function*(a){const r=function Rs(a){if(Ke(/[0-9a-zA-Z]+/.test(a),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(a);const r=new ArrayBuffer(a.length),s=new Uint8Array(r);for(let c=0;c<a.length;c++)s[c]=a.charCodeAt(c);return s}(a),s=yield crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(s)).map(d=>d.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}(0,N.XA)("authIdTokenMaxAge"),function Un(a){It=a}({loadJS:a=>new Promise((r,s)=>{const c=document.createElement("script");c.setAttribute("src",a),c.onload=r,c.onerror=d=>{const f=Ae("internal-error");f.customData=d,s(f)},c.type="text/javascript",c.charset="UTF-8",function gu(){var a,r;return null!==(r=null===(a=document.getElementsByTagName("head"))||void 0===a?void 0:a[0])&&void 0!==r?r:document}().appendChild(c)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),function Cs(a){(0,$._registerComponent)(new Je.uA("auth",(r,{options:s})=>{const c=r.getProvider("app").getImmediate(),d=r.getProvider("heartbeat"),f=r.getProvider("app-check-internal"),{apiKey:y,authDomain:A}=c.options;O(y&&!y.includes(":"),"invalid-api-key",{appName:c.name});const k={apiKey:y,authDomain:A,clientPlatform:a,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:w(a)},M=new Te(c,d,f,k);return function dl(a,r){const s=r?.persistence||[],c=(Array.isArray(s)?s:[s]).map(re);r?.errorMap&&a._updateErrorMap(r.errorMap),a._initializeWithPersistence(c,r?.popupRedirectResolver)}(M,s),M},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((r,s,c)=>{r.getProvider("auth-internal").initialize()})),(0,$._registerComponent)(new Je.uA("auth-internal",r=>{const s=Y(r.getProvider("auth").getImmediate());return new Dr(s)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,$.registerVersion)(tn,"1.9.0",function Rc(a){switch(a){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(a)),(0,$.registerVersion)(tn,"1.9.0","esm2017")}("Browser");class ta extends gs{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(r=>{this.resolveInitialized=r})}addPassiveListener(r){this.passiveListeners.add(r)}removePassiveListener(r){this.passiveListeners.delete(r)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(r){return this.resolveInitialized(),this.passiveListeners.forEach(s=>s(r)),super.onEvent(r)}initialized(){var r=this;return(0,m.A)(function*(){yield r.initPromise})()}}function xc(a){return na.apply(this,arguments)}function na(){return(na=(0,m.A)(function*(a){const r=yield ia()._get(sa(a));return r&&(yield ia()._remove(sa(a))),r})).apply(this,arguments)}function ra(){const a=[];for(let s=0;s<20;s++){const c=Math.floor(62*Math.random());a.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(c))}return a.join("")}function ia(){return re(as)}function sa(a){return ue("authEvent",a.config.apiKey,a.name)}function vi(a){if(!a?.includes("?"))return{};const[r,...s]=a.split("?");return(0,N.I9)(s.join("?"))}const Mc=class oa{constructor(){this._redirectPersistence=En,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=_s,this._overrideRedirectResult=Vo}_initialize(r){var s=this;return(0,m.A)(function*(){const c=r._key();let d=s.eventManagers.get(c);return d||(d=new ta(r),s.eventManagers.set(c,d),s.attachCallbackListeners(r,d)),d})()}_openPopup(r){me(r,"operation-not-supported-in-this-environment")}_openRedirect(r,s,c,d){var f=this;return(0,m.A)(function*(){!function bs(a){var r,s,c,d,f,y,A,k,M,W;const F=nr();O("function"==typeof(null===(r=F?.universalLinks)||void 0===r?void 0:r.subscribe),a,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),O(typeof(null===(s=F?.BuildInfo)||void 0===s?void 0:s.packageName)<"u",a,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),O("function"==typeof(null===(f=null===(d=null===(c=F?.cordova)||void 0===c?void 0:c.plugins)||void 0===d?void 0:d.browsertab)||void 0===f?void 0:f.openUrl),a,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),O("function"==typeof(null===(k=null===(A=null===(y=F?.cordova)||void 0===y?void 0:y.plugins)||void 0===A?void 0:A.browsertab)||void 0===k?void 0:k.isAvailable),a,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),O("function"==typeof(null===(W=null===(M=F?.cordova)||void 0===M?void 0:M.InAppBrowser)||void 0===W?void 0:W.open),a,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(r);const y=yield f._initialize(r);yield y.initialized(),y.resetRedirect(),function ee(){ci.clear()}(),yield f._originValidation(r);const A=function Oc(a,r,s=null){return{type:r,eventId:s,urlResponse:null,sessionId:ra(),postBody:null,tenantId:a.tenantId,error:Ae(a,"no-auth-event")}}(r,c,d);yield function Dc(a,r){return ia()._set(sa(a),r)}(r,A);const k=yield function Nc(a,r,s){return Jo.apply(this,arguments)}(r,A,s),M=yield function vu(a){const{cordova:r}=nr();return new Promise(s=>{r.plugins.browsertab.isAvailable(c=>{let d=null;c?r.plugins.browsertab.openUrl(a):d=r.InAppBrowser.open(a,function Di(a=(0,N.ZQ)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(a)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(a)}()?"_blank":"_system","location=yes"),s(d)})})}(k);return function yu(a,r,s){return Zo.apply(this,arguments)}(r,y,M)})()}_isIframeWebStorageSupported(r,s){throw new Error("Method not implemented.")}_originValidation(r){const s=r._key();return this.originValidationPromises[s]||(this.originValidationPromises[s]=function mu(a){return Xo.apply(this,arguments)}(r)),this.originValidationPromises[s]}attachCallbackListeners(r,s){const{universalLinks:c,handleOpenURL:d,BuildInfo:f}=nr(),y=setTimeout((0,m.A)(function*(){yield xc(r),s.onEvent(Fc())}),500),A=function(){var W=(0,m.A)(function*(F){clearTimeout(y);const ce=yield xc(r);let Ve=null;ce&&F?.url&&(Ve=function Lc(a,r){var s,c;const d=function Au(a){const r=vi(a),s=r.link?decodeURIComponent(r.link):void 0,c=vi(s).link,d=r.deep_link_id?decodeURIComponent(r.deep_link_id):void 0;return vi(d).link||d||c||s||a}(r);if(d.includes("/__/auth/callback")){const f=vi(d),y=f.firebaseError?function Eu(a){try{return JSON.parse(a)}catch{return null}}(decodeURIComponent(f.firebaseError)):null,A=null===(c=null===(s=y?.code)||void 0===s?void 0:s.split("auth/"))||void 0===c?void 0:c[1],k=A?Ae(A):null;return k?{type:a.type,eventId:a.eventId,tenantId:a.tenantId,error:k,urlResponse:null,sessionId:null,postBody:null}:{type:a.type,eventId:a.eventId,tenantId:a.tenantId,sessionId:a.sessionId,urlResponse:d,postBody:null}}return null}(ce,F.url)),s.onEvent(Ve||Fc())});return function(ce){return W.apply(this,arguments)}}();typeof c<"u"&&"function"==typeof c.subscribe&&c.subscribe(null,A);const k=d,M=`${f.packageName.toLowerCase()}://`;nr().handleOpenURL=function(){var W=(0,m.A)(function*(F){if(F.toLowerCase().startsWith(M)&&A({url:F}),"function"==typeof k)try{k(F)}catch(ce){console.error(ce)}});return function(F){return W.apply(this,arguments)}}()}};function Fc(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Ae("no-auth-event")}}function yi(){var a;return(null===(a=self?.location)||void 0===a?void 0:a.protocol)||null}function Vc(a=(0,N.ZQ)()){return!("file:"!==yi()&&"ionic:"!==yi()&&"capacitor:"!==yi()||!a.toLowerCase().match(/iphone|ipad|ipod|android/))}function ca(){try{const a=self.localStorage,r=Er();if(a)return a.setItem(r,"1"),a.removeItem(r),!function Ru(a=(0,N.ZQ)()){return function Su(){return(0,N.lT)()&&11===document?.documentMode}()||function Wc(a=(0,N.ZQ)()){return/Edge\/\d+/.test(a)}(a)}()||(0,N.zW)()}catch{return Ps()&&(0,N.zW)()}return!1}function Ps(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function la(){return(function Cu(){return"http:"===yi()||"https:"===yi()}()||(0,N.sr)()||Vc())&&!function bu(){return(0,N.lV)()||(0,N.Ll)()}()&&ca()&&!Ps()}function ua(){return Vc()&&typeof document<"u"}function Os(){return(Os=(0,m.A)(function*(){return!!ua()&&new Promise(a=>{const r=setTimeout(()=>{a(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(r),a(!0)})})})).apply(this,arguments)}const ft={LOCAL:"local",NONE:"none",SESSION:"session"},Ii=O,Ds="persistence";function da(a){return ha.apply(this,arguments)}function ha(){return(ha=(0,m.A)(function*(a){yield a._initializationPromise;const r=nn(),s=ue(Ds,a.config.apiKey,a.name);r&&r.setItem(s,a._getPersistence())})).apply(this,arguments)}function nn(){var a;try{return(null===(a=function ku(){return typeof window<"u"?window:null}())||void 0===a?void 0:a.sessionStorage)||null}catch{return null}}const jc=O;class rn{constructor(){this.browserResolver=re(Ie),this.cordovaResolver=re(Mc),this.underlyingResolver=null,this._redirectPersistence=En,this._completeRedirectFn=_s,this._overrideRedirectResult=Vo}_initialize(r){var s=this;return(0,m.A)(function*(){return yield s.selectUnderlyingResolver(),s.assertedUnderlyingResolver._initialize(r)})()}_openPopup(r,s,c,d){var f=this;return(0,m.A)(function*(){return yield f.selectUnderlyingResolver(),f.assertedUnderlyingResolver._openPopup(r,s,c,d)})()}_openRedirect(r,s,c,d){var f=this;return(0,m.A)(function*(){return yield f.selectUnderlyingResolver(),f.assertedUnderlyingResolver._openRedirect(r,s,c,d)})()}_isIframeWebStorageSupported(r,s){this.assertedUnderlyingResolver._isIframeWebStorageSupported(r,s)}_originValidation(r){return this.assertedUnderlyingResolver._originValidation(r)}get _shouldInitProactively(){return ua()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return jc(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var r=this;return(0,m.A)(function*(){if(r.underlyingResolver)return;const s=yield function Ns(){return Os.apply(this,arguments)}();r.underlyingResolver=s?r.cordovaResolver:r.browserResolver})()}}function sn(a){return a.unwrap()}function Ls(a){return $c(a)}function $c(a){const{_tokenResponse:r}=a instanceof N.g?a.customData:a;if(!r)return null;if(!(a instanceof N.g)&&"temporaryProof"in r&&"phoneNumber"in r)return ai.credentialFromResult(a);const s=r.providerId;if(!s||"password"===s)return null;let c;switch(s){case"google.com":c=ro;break;case"facebook.com":c=qe;break;case"github.com":c=$a;break;case"twitter.com":c=Ka;break;default:const{oauthIdToken:d,oauthAccessToken:f,oauthTokenSecret:y,pendingToken:A,nonce:k}=r;return f||y||d||A?A?s.startsWith("saml.")?jn._create(s,A):Ht._fromParams({providerId:s,signInMethod:s,pendingToken:A,idToken:d,accessToken:f}):new Le(s).credential({idToken:d,accessToken:f,rawNonce:k}):null}return a instanceof N.g?c.credentialFromError(a):c.credentialFromResult(a)}function ot(a,r){return r.catch(s=>{throw s instanceof N.g&&function Pu(a,r){var s;const c=null===(s=r.customData)||void 0===s?void 0:s._tokenResponse;if("auth/multi-factor-auth-required"===r?.code)r.resolver=new Nu(a,function Ml(a,r){var s;const c=(0,N.Ku)(a),d=r;return O(r.customData.operationType,c,"argument-error"),O(null===(s=d.customData._serverResponse)||void 0===s?void 0:s.mfaPendingCredential,c,"argument-error"),wo._fromError(c,d)}(a,r));else if(c){const d=$c(r),f=r;d&&(f.credential=d,f.tenantId=c.tenantId||void 0,f.email=c.email||void 0,f.phoneNumber=c.phoneNumber||void 0)}}(a,s),s}).then(s=>{const d=s.user;return{operationType:s.operationType,credential:Ls(s),additionalUserInfo:Nl(s),user:Qe.getOrCreate(d)}})}function Ms(a,r){return Ei.apply(this,arguments)}function Ei(){return(Ei=(0,m.A)(function*(a,r){const s=yield r;return{verificationId:s.verificationId,confirm:c=>ot(a,s.confirm(c))}})).apply(this,arguments)}class Nu{constructor(r,s){this.resolver=s,this.auth=function xs(a){return a.wrapped()}(r)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(r){return ot(sn(this.auth),this.resolver.resolveSignIn(r))}}class Qe{constructor(r){this._delegate=r,this.multiFactor=function bo(a){const r=(0,N.Ku)(a);return Kt.has(r)||Kt.set(r,Co._fromUser(r)),Kt.get(r)}(r)}static getOrCreate(r){return Qe.USER_MAP.has(r)||Qe.USER_MAP.set(r,new Qe(r)),Qe.USER_MAP.get(r)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(r){return this._delegate.getIdTokenResult(r)}getIdToken(r){return this._delegate.getIdToken(r)}linkAndRetrieveDataWithCredential(r){return this.linkWithCredential(r)}linkWithCredential(r){var s=this;return(0,m.A)(function*(){return ot(s.auth,Ya(s._delegate,r))})()}linkWithPhoneNumber(r,s){var c=this;return(0,m.A)(function*(){return Ms(c.auth,function Jl(a,r,s){return ds.apply(this,arguments)}(c._delegate,r,s))})()}linkWithPopup(r){var s=this;return(0,m.A)(function*(){return ot(s.auth,function Zl(a,r,s){return Fo.apply(this,arguments)}(s._delegate,r,rn))})()}linkWithRedirect(r){var s=this;return(0,m.A)(function*(){return yield da(Y(s.auth)),function li(a,r,s){return function ui(a,r,s){return jo.apply(this,arguments)}(a,r,s)}(s._delegate,r,rn)})()}reauthenticateAndRetrieveDataWithCredential(r){return this.reauthenticateWithCredential(r)}reauthenticateWithCredential(r){var s=this;return(0,m.A)(function*(){return ot(s.auth,vn(s._delegate,r))})()}reauthenticateWithPhoneNumber(r,s){return Ms(this.auth,function Yn(a,r,s){return se.apply(this,arguments)}(this._delegate,r,s))}reauthenticateWithPopup(r){return ot(this.auth,function Ic(a,r,s){return Mo.apply(this,arguments)}(this._delegate,r,rn))}reauthenticateWithRedirect(r){var s=this;return(0,m.A)(function*(){return yield da(Y(s.auth)),function Bo(a,r,s){return function Ac(a,r,s){return Tn.apply(this,arguments)}(a,r,s)}(s._delegate,r,rn)})()}sendEmailVerification(r){return function Rl(a,r){return zn.apply(this,arguments)}(this._delegate,r)}unlink(r){var s=this;return(0,m.A)(function*(){return yield function ao(a,r){return Yi.apply(this,arguments)}(s._delegate,r),s})()}updateEmail(r){return function ec(a,r){const s=(0,N.Ku)(a);return(0,$._isFirebaseServerApp)(s.auth.app)?Promise.reject(z(s.auth)):yo(s,r,null)}(this._delegate,r)}updatePassword(r){return function tc(a,r){return yo((0,N.Ku)(a),null,r)}(this._delegate,r)}updatePhoneNumber(r){return function vc(a,r){return Et.apply(this,arguments)}(this._delegate,r)}updateProfile(r){return function Za(a,r){return rs.apply(this,arguments)}(this._delegate,r)}verifyBeforeUpdateEmail(r,s){return function kl(a,r,s){return vo.apply(this,arguments)}(this._delegate,r,s)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Qe.USER_MAP=new WeakMap;const on=O;let Kc=(()=>{class a{constructor(s,c){if(this.app=s,c.isInitialized())return this._delegate=c.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:d}=s.options;on(d,"invalid-api-key",{appName:s.name}),on(d,"invalid-api-key",{appName:s.name});const f=typeof window<"u"?rn:void 0;this._delegate=c.initialize({options:{persistence:Ou(d,s.name),popupRedirectResolver:f}}),this._delegate._updateErrorMap(Xe),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Qe.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(s){this._delegate.languageCode=s}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(s){this._delegate.tenantId=s}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(s,c){!function Na(a,r,s){const c=Y(a);O(c._canInitEmulator,c,"emulator-config-failed"),O(/^https?:\/\//.test(r),c,"invalid-emulator-scheme");const d=!!s?.disableWarnings,f=Oa(r),{host:y,port:A}=function hl(a){const r=Oa(a),s=/(\/\/)?([^?#/]+)/.exec(a.substr(r.length));if(!s)return{host:"",port:null};const c=s[2].split("@").pop()||"",d=/^(\[[^\]]+\])(:|$)/.exec(c);if(d){const f=d[1];return{host:f,port:Da(c.substr(f.length+1))}}{const[f,y]=c.split(":");return{host:f,port:Da(y)}}}(r);c.config.emulator={url:`${f}//${y}${null===A?"":`:${A}`}/`},c.settings.appVerificationDisabledForTesting=!0,c.emulatorConfig=Object.freeze({host:y,port:A,protocol:f.replace(":",""),options:Object.freeze({disableWarnings:d})}),d||function fl(){function a(){const r=document.createElement("p"),s=r.style;r.innerText="Running in emulator mode. Do not use with production credentials.",s.position="fixed",s.width="100%",s.backgroundColor="#ffffff",s.border=".1em solid #000000",s.color="#b50000",s.bottom="0px",s.left="0px",s.margin="0px",s.zIndex="10000",s.textAlign="center",r.classList.add("firebase-emulator-warning"),document.body.appendChild(r)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",a):a())}()}(this._delegate,s,c)}applyActionCode(s){return function Tl(a,r){return jt.apply(this,arguments)}(this._delegate,s)}checkActionCode(s){return $t(this._delegate,s)}confirmPasswordReset(s,c){return function Al(a,r,s){return vr.apply(this,arguments)}(this._delegate,s,c)}createUserWithEmailAndPassword(s,c){var d=this;return(0,m.A)(function*(){return ot(d._delegate,function po(a,r,s){return ns.apply(this,arguments)}(d._delegate,s,c))})()}fetchProvidersForEmail(s){return this.fetchSignInMethodsForEmail(s)}fetchSignInMethodsForEmail(s){return function Xa(a,r){return yn.apply(this,arguments)}(this._delegate,s)}isSignInWithEmailLink(s){return function Cl(a,r){const s=qr.parseLink(r);return"EMAIL_SIGNIN"===s?.operation}(0,s)}getRedirectResult(){var s=this;return(0,m.A)(function*(){on(la(),s._delegate,"operation-not-supported-in-this-environment");const c=yield function $o(a,r){return Xn.apply(this,arguments)}(s._delegate,rn);return c?ot(s._delegate,Promise.resolve(c)):{credential:null,user:null}})()}addFrameworkForLogging(s){!function Uc(a,r){Y(a)._logFramework(r)}(this._delegate,s)}onAuthStateChanged(s,c,d){const{next:f,error:y,complete:A}=Gc(s,c,d);return this._delegate.onAuthStateChanged(f,y,A)}onIdTokenChanged(s,c,d){const{next:f,error:y,complete:A}=Gc(s,c,d);return this._delegate.onIdTokenChanged(f,y,A)}sendSignInLinkToEmail(s,c){return function Ja(a,r,s){return _o.apply(this,arguments)}(this._delegate,s,c)}sendPasswordResetEmail(s,c){return function Bt(a,r,s){return He.apply(this,arguments)}(this._delegate,s,c||void 0)}setPersistence(s){var c=this;return(0,m.A)(function*(){let d;switch(function Hc(a,r){Ii(Object.values(ft).includes(r),a,"invalid-persistence-type"),(0,N.lV)()?Ii(r!==ft.SESSION,a,"unsupported-persistence-type"):(0,N.Ll)()?Ii(r===ft.NONE,a,"unsupported-persistence-type"):Ps()?Ii(r===ft.NONE||r===ft.LOCAL&&(0,N.zW)(),a,"unsupported-persistence-type"):Ii(r===ft.NONE||ca(),a,"unsupported-persistence-type")}(c._delegate,s),s){case ft.SESSION:d=En;break;case ft.LOCAL:d=(yield re(X)._isAvailable())?X:as;break;case ft.NONE:d=Se;break;default:return me("argument-error",{appName:c._delegate.name})}return c._delegate.setPersistence(d)})()}signInAndRetrieveDataWithCredential(s){return this.signInWithCredential(s)}signInAnonymously(){return ot(this._delegate,function Ga(a){return qi.apply(this,arguments)}(this._delegate))}signInWithCredential(s){return ot(this._delegate,gr(this._delegate,s))}signInWithCustomToken(s){return ot(this._delegate,function Qa(a,r){return $n.apply(this,arguments)}(this._delegate,s))}signInWithEmailAndPassword(s,c){return ot(this._delegate,function Be(a,r,s){return(0,$._isFirebaseServerApp)(a.app)?Promise.reject(z(a)):gr((0,N.Ku)(a),it.credential(r,s)).catch(function(){var c=(0,m.A)(function*(d){throw"auth/password-does-not-meet-requirements"===d.code&&Kn(a),d});return function(d){return c.apply(this,arguments)}}())}(this._delegate,s,c))}signInWithEmailLink(s,c){return ot(this._delegate,function bl(a,r,s){return go.apply(this,arguments)}(this._delegate,s,c))}signInWithPhoneNumber(s,c){return Ms(this._delegate,function Ql(a,r,s){return No.apply(this,arguments)}(this._delegate,s,c))}signInWithPopup(s){var c=this;return(0,m.A)(function*(){return on(la(),c._delegate,"operation-not-supported-in-this-environment"),ot(c._delegate,function Cr(a,r,s){return fs.apply(this,arguments)}(c._delegate,s,rn))})()}signInWithRedirect(s){var c=this;return(0,m.A)(function*(){return on(la(),c._delegate,"operation-not-supported-in-this-environment"),yield da(c._delegate),function ke(a,r,s){return function Wo(a,r,s){return Ho.apply(this,arguments)}(a,r,s)}(c._delegate,s,rn)})()}updateCurrentUser(s){return this._delegate.updateCurrentUser(s)}verifyPasswordResetCode(s){return function wl(a,r){return Gn.apply(this,arguments)}(this._delegate,s)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return a.Persistence=ft,a})();function Gc(a,r,s){let c=a;"function"!=typeof a&&({next:c,error:r,complete:s}=a);const d=c;return{next:y=>d(y&&Qe.getOrCreate(y)),error:r,complete:s}}function Ou(a,r){const s=function Bc(a,r){const s=nn();if(!s)return[];const c=ue(Ds,a,r);switch(s.getItem(c)){case ft.NONE:return[Se];case ft.LOCAL:return[X,En];case ft.SESSION:return[En];default:return[]}}(a,r);if(typeof self<"u"&&!s.includes(X)&&s.push(X),typeof window<"u")for(const c of[as,En])s.includes(c)||s.push(c);return s.includes(Se)||s.push(Se),s}class xr{static credential(r,s){return ai.credential(r,s)}constructor(){this.providerId="phone",this._delegate=new ai(sn(_.A.auth()))}verifyPhoneNumber(r,s){return this._delegate.verifyPhoneNumber(r,s)}unwrap(){return this._delegate}}xr.PHONE_SIGN_IN_METHOD=ai.PHONE_SIGN_IN_METHOD,xr.PROVIDER_ID=ai.PROVIDER_ID;const zc=O;class Du{constructor(r,s,c=_.A.app()){var d;zc(null===(d=c.options)||void 0===d?void 0:d.apiKey,"invalid-api-key",{appName:c.name}),this._delegate=new oi(c.auth(),r,s),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function Fs(a){a.INTERNAL.registerComponent(new Je.uA("auth-compat",r=>{const s=r.getProvider("app-compat").getImmediate(),c=r.getProvider("auth");return new Kc(s,c)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:it,FacebookAuthProvider:qe,GithubAuthProvider:$a,GoogleAuthProvider:ro,OAuthProvider:Le,SAMLAuthProvider:Gi,PhoneAuthProvider:xr,PhoneMultiFactorGenerator:Qo,RecaptchaVerifier:Du,TwitterAuthProvider:Ka,Auth:Kc,AuthCredential:fr,Error:N.g}).setInstantiationMode("LAZY").setMultipleInstances(!1)),a.registerVersion("@firebase/auth-compat","0.5.18")}(_.A)}}]);